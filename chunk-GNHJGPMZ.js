import{a as ue}from"./chunk-BJ4AZ67L.js";import{c as _e,d as fe,f as be,g as he}from"./chunk-PJO3DCF6.js";import{a as ct}from"./chunk-YJ32XG2B.js";import{b as de}from"./chunk-XKSLUKGI.js";import{f as U,g as me,h as Me}from"./chunk-OZCEPD4V.js";import{e as se,f as pe,h as ce,i as W,j as R,m as Be}from"./chunk-JX3YAFU2.js";import{B as ae,a as lt,n as q,o as Se,q as C,w as st,x as pt,y as z,z as j}from"./chunk-LYIDVOBE.js";import{$ as b,$a as S,Aa as He,Ab as V,Ac as F,Ba as _,Da as O,Dd as mt,Ea as s,Fb as Ze,Gb as Ie,Gc as re,Hd as le,Ia as w,Ib as J,Ic as X,Ja as k,Ka as Ne,Kb as Te,Ma as ie,Na as ne,O as Fe,Oa as c,P as De,Pa as u,Pb as Ge,Qa as h,Qb as Je,Ra as xe,Rb as Xe,S as $,Sa as Ce,T as D,Ta as Qe,U as Oe,Ua as y,Ub as Ye,V as Y,Va as d,Vb as et,W as Le,Wa as l,Yb as tt,Z as Pe,Za as qe,Zb as we,_ as f,_a as L,ab as M,ba as ee,db as B,ea as H,eb as E,ec as it,fb as G,fc as nt,gb as oe,ha as $e,hc as ot,ia as N,ic as rt,jc as at,ka as Re,ma as ye,mb as Q,na as Ae,nb as ze,ob as je,pb as We,pc as ke,qa as p,qb as Ue,ra as Z,uc as P,v as Ve,wb as g,wc as I,xa as T,xb as x,za as te,zb as Ke}from"./chunk-LVJHIGHJ.js";import{a as K,b as Ee}from"./chunk-TWZW5B45.js";var ft=["content"],bt=["navbar"],ht=["inkbar"],vt=["prevBtn"],gt=["nextBtn"],yt=["tabLink"],xt=["tab"],Ct=n=>({"p-tabmenu p-component":!0,"p-tabmenu-scrollable":n}),It=(n,r,t)=>({"p-tabmenuitem":!0,"p-disabled":n,"p-highlight":r,"p-hidden":t}),Tt=(n,r)=>({$implicit:n,index:r}),wt=()=>({exact:!1});function kt(n,r){n&1&&h(0,"ChevronLeftIcon"),n&2&&O("aria-hidden",!0)}function St(n,r){}function Mt(n,r){n&1&&_(0,St,0,0,"ng-template")}function Bt(n,r){if(n&1){let t=y();c(0,"button",17,3),d("click",function(){f(t);let i=l();return b(i.navBackward())}),_(2,kt,1,1,"ChevronLeftIcon",18)(3,Mt,1,0,null,19),u()}if(n&2){let t=l();p(2),s("ngIf",!t.previousIconTemplate),p(),s("ngTemplateOutlet",t.previousIconTemplate)}}function Et(n,r){if(n&1&&h(0,"span",28),n&2){let t=l(2).$implicit;s("ngClass",t.icon)("ngStyle",t.iconStyle)}}function Vt(n,r){if(n&1&&(c(0,"span",29),E(1),u()),n&2){let t=l(2).$implicit,e=l();p(),G(e.getItemProp(t,"label"))}}function Ft(n,r){if(n&1&&h(0,"span",30),n&2){let t=l(2).$implicit,e=l();s("innerHTML",e.getItemProp(t,"label"),ye)}}function Dt(n,r){if(n&1&&(c(0,"span",31),E(1),u()),n&2){let t=l(2).$implicit,e=l();s("ngClass",t.badgeStyleClass),p(),G(e.getItemProp(t,"badge"))}}function Ot(n,r){if(n&1&&(c(0,"a",24,5),xe(2),_(3,Et,1,2,"span",25)(4,Vt,2,1,"span",26)(5,Ft,1,1,"ng-template",null,6,V)(7,Dt,2,2,"span",27),Ce(),u()),n&2){let t=B(6),e=l().$implicit,i=l();s("target",i.getItemProp(e,"target")),O("href",i.getItemProp(e,"url"),Ae)("id",i.getItemProp(e,"id"))("aria-disabled",i.disabled(e))("aria-label",i.getItemProp(e,"label"))("tabindex",i.disabled(e)?-1:0),p(3),s("ngIf",e.icon),p(),s("ngIf",e.escape!==!1)("ngIfElse",t),p(3),s("ngIf",e.badge)}}function Lt(n,r){if(n&1&&h(0,"span",28),n&2){let t=l(2).$implicit;s("ngClass",t.icon)("ngStyle",t.iconStyle),O("aria-hidden",!0)}}function Pt(n,r){if(n&1&&(c(0,"span",29),E(1),u()),n&2){let t=l(2).$implicit,e=l();p(),G(e.getItemProp(t,"label"))}}function $t(n,r){if(n&1&&h(0,"span",30),n&2){let t=l(2).$implicit,e=l();s("innerHTML",e.getItemProp(t,"label"),ye)}}function Rt(n,r){if(n&1&&(c(0,"span",31),E(1),u()),n&2){let t=l(2).$implicit,e=l();s("ngClass",t.badgeStyleClass),p(),G(e.getItemProp(t,"badge"))}}function At(n,r){if(n&1&&(c(0,"a",32,5),xe(2),_(3,Lt,1,3,"span",25)(4,Pt,2,1,"span",26)(5,$t,1,1,"ng-template",null,7,V)(7,Rt,2,2,"span",27),Ce(),u()),n&2){let t=B(6),e=l().$implicit,i=l();s("routerLink",e.routerLink)("queryParams",e.queryParams)("routerLinkActive","p-menuitem-link-active")("routerLinkActiveOptions",e.routerLinkActiveOptions||ze(19,wt))("target",e.target)("fragment",e.fragment)("queryParamsHandling",e.queryParamsHandling)("preserveFragment",e.preserveFragment)("skipLocationChange",e.skipLocationChange)("replaceUrl",e.replaceUrl)("state",e.state),O("id",i.getItemProp(e,"id"))("aria-disabled",i.disabled(e))("aria-label",i.getItemProp(e,"label"))("tabindex",i.disabled(e)?-1:0),p(3),s("ngIf",e.icon),p(),s("ngIf",e.escape!==!1)("ngIfElse",t),p(3),s("ngIf",e.badge)}}function Ht(n,r){n&1&&Qe(0)}function Nt(n,r){if(n&1){let t=y();c(0,"li",20,4),d("click",function(i){let o=f(t).$implicit,a=l();return b(a.itemClick(i,o))})("keydown",function(i){let o=f(t),a=o.$implicit,m=o.index,v=l();return b(v.onKeydownItem(i,m,a))})("focus",function(){let i=f(t).$implicit,o=l();return b(o.onMenuItemFocus(i))}),_(2,Ot,8,10,"a",21)(3,At,8,20,"a",22)(4,Ht,1,0,"ng-container",23),u()}if(n&2){let t=r.$implicit,e=r.index,i=l();w(t.styleClass),s("ngStyle",t.style)("ngClass",Ue(11,It,i.getItemProp(t,"disabled"),i.isActive(t),t.visible===!1))("tooltipOptions",t.tooltipOptions),O("data-p-disabled",i.disabled(t))("data-p-highlight",i.focusedItemInfo()===t),p(2),s("ngIf",!t.routerLink&&!i.itemTemplate),p(),s("ngIf",t.routerLink&&!i.itemTemplate),p(),s("ngTemplateOutlet",i.itemTemplate)("ngTemplateOutletContext",We(15,Tt,t,e))}}function Qt(n,r){n&1&&h(0,"ChevronRightIcon"),n&2&&O("aria-hidden",!0)}function qt(n,r){}function zt(n,r){n&1&&_(0,qt,0,0,"ng-template")}function jt(n,r){if(n&1){let t=y();c(0,"button",33,8),d("click",function(){f(t);let i=l();return b(i.navForward())}),_(2,Qt,1,1,"ChevronRightIcon",18)(3,zt,1,0,null,19),u()}if(n&2){let t=l();p(2),s("ngIf",!t.previousIconTemplate),p(),s("ngTemplateOutlet",t.nextIconTemplate)}}var $i=(()=>{class n{platformId;router;route;cd;set model(t){this._model=t,this._focusableItems=(this._model||[]).reduce((e,i)=>(e.push(i),e),[])}get model(){return this._model}set activeItem(t){this._activeItem=t,this.activeItemChange.emit(t),this.tabChanged=!0}get activeItem(){return this._activeItem}scrollable;popup;style;styleClass;ariaLabel;ariaLabelledBy;activeItemChange=new H;content;navbar;inkbar;prevBtn;nextBtn;tabLink;tab;templates;itemTemplate;previousIconTemplate;nextIconTemplate;tabChanged;backwardIsDisabled=!0;forwardIsDisabled=!1;timerIdForAutoScroll=null;_focusableItems;_model;_activeItem;focusedItemInfo=T(null);get focusableItems(){return(!this._focusableItems||!this._focusableItems.length)&&(this._focusableItems=(this.model||[]).reduce((t,e)=>(t.push(e),t),[])),this._focusableItems}constructor(t,e,i,o){this.platformId=t,this.router=e,this.route=i,this.cd=o,this.router.events.pipe(Ve(a=>a instanceof it)).subscribe(a=>{this.cd.markForCheck()})}ngOnChanges(t){t.activeItem&&this.autoScrollForActiveItem()}ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"item":this.itemTemplate=t.template;break;case"nexticon":this.nextIconTemplate=t.template;break;case"previousicon":this.previousIconTemplate=t.template;break;default:this.itemTemplate=t.template;break}})}ngAfterViewInit(){we(this.platformId)&&(this.updateInkBar(),this.autoScrollForActiveItem(),this.initButtonState())}ngAfterViewChecked(){we(this.platformId)&&(this.updateInkBar(),this.tabChanged=!1)}ngOnDestroy(){this.clearAutoScrollHandler()}isActive(t){if(t.routerLink){let e=Array.isArray(t.routerLink)?t.routerLink:[t.routerLink];return this.router.isActive(this.router.createUrlTree(e,{relativeTo:this.route}).toString(),t.routerLinkActiveOptions?.exact??t.routerLinkActiveOptions??!1)}return t===this.activeItem}getItemProp(t,e){return t?lt.getItemValue(t[e]):void 0}visible(t){return typeof t.visible=="function"?t.visible():t.visible!==!1}disabled(t){return typeof t.disabled=="function"?t.disabled():t.disabled}onMenuItemFocus(t){this.focusedItemInfo.set(t)}itemClick(t,e){if(e.disabled){t.preventDefault();return}!e.url&&!e.routerLink&&t.preventDefault(),e.command&&e.command({originalEvent:t,item:e}),this.activeItem=e,this.tabChanged=!0,this.cd.markForCheck()}onKeydownItem(t,e,i){let o=e,a={},m=this.tabLink.toArray(),v=this.tab.toArray();switch(t.code){case"ArrowRight":a=this.findNextItem(v,o),o=a.i;break;case"ArrowLeft":a=this.findPrevItem(v,o),o=a.i;break;case"End":a=this.findPrevItem(v,this.model.length),o=a.i,t.preventDefault();break;case"Home":a=this.findNextItem(v,-1),o=a.i,t.preventDefault();break;case"Space":case"Enter":this.itemClick(t,i);break;case"Tab":this.onTabKeyDown(m);break;default:break}m[o]&&m[e]&&(m[e].nativeElement.tabIndex="-1",m[o].nativeElement.tabIndex="0",m[o].nativeElement.focus()),this.cd.markForCheck()}onTabKeyDown(t){t.forEach(e=>{e.nativeElement.tabIndex=C.getAttribute(e.nativeElement.parentElement,"data-p-highlight")?"0":"-1"})}findNextItem(t,e){let i=e+1;if(i>=t.length)return{nextItem:t[t.length],i:t.length};let o=t[i];return o?C.getAttribute(o.nativeElement,"data-p-disabled")?this.findNextItem(t,i):{nextItem:o.nativeElement,i}:null}findPrevItem(t,e){let i=e-1;if(i<0)return{prevItem:t[0],i:0};let o=t[i];return o?C.getAttribute(o.nativeElement,"data-p-disabled")?this.findPrevItem(t,i):{prevItem:o.nativeElement,i}:null}updateInkBar(){let t=C.findSingle(this.navbar?.nativeElement,"li.p-highlight");t&&(this.inkbar.nativeElement.style.width=C.getWidth(t)+"px",this.inkbar.nativeElement.style.left=C.getOffset(t).left-C.getOffset(this.navbar?.nativeElement).left+"px")}getVisibleButtonWidths(){return[this.prevBtn?.nativeElement,this.nextBtn?.nativeElement].reduce((t,e)=>e?t+C.getWidth(e):t,0)}updateButtonState(){let t=this.content?.nativeElement,{scrollLeft:e,scrollWidth:i}=t,o=C.getWidth(t);this.backwardIsDisabled=e===0,this.forwardIsDisabled=parseInt(e)===i-o}updateScrollBar(t){let e=this.navbar?.nativeElement.children[t];e&&e&&typeof e.scrollIntoView=="function"&&e.scrollIntoView({block:"nearest",inline:"center"})}onScroll(t){this.scrollable&&this.updateButtonState(),t.preventDefault()}navBackward(){let t=this.content?.nativeElement,e=C.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft-e;t.scrollLeft=i<=0?0:i}navForward(){let t=this.content?.nativeElement,e=C.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft+e,o=t.scrollWidth-e;t.scrollLeft=i>=o?o:i}autoScrollForActiveItem(){this.scrollable&&(this.clearAutoScrollHandler(),this.timerIdForAutoScroll=setTimeout(()=>{let t=this.model.findIndex(e=>this.isActive(e));t!==-1&&this.updateScrollBar(t)}))}clearAutoScrollHandler(){this.timerIdForAutoScroll&&(clearTimeout(this.timerIdForAutoScroll),this.timerIdForAutoScroll=null)}initButtonState(){this.scrollable&&Promise.resolve().then(()=>{this.updateButtonState(),this.cd.markForCheck()})}static \u0275fac=function(e){return new(e||n)(Z(Re),Z(ot),Z(nt),Z(Ze))};static \u0275cmp=D({type:n,selectors:[["p-tabMenu"]],contentQueries:function(e,i,o){if(e&1&&qe(o,q,4),e&2){let a;S(a=M())&&(i.templates=a)}},viewQuery:function(e,i){if(e&1&&(L(ft,5),L(bt,5),L(ht,5),L(vt,5),L(gt,5),L(yt,5),L(xt,5)),e&2){let o;S(o=M())&&(i.content=o.first),S(o=M())&&(i.navbar=o.first),S(o=M())&&(i.inkbar=o.first),S(o=M())&&(i.prevBtn=o.first),S(o=M())&&(i.nextBtn=o.first),S(o=M())&&(i.tabLink=o),S(o=M())&&(i.tab=o)}},hostAttrs:[1,"p-element"],inputs:{model:"model",activeItem:"activeItem",scrollable:[2,"scrollable","scrollable",Ie],popup:[2,"popup","popup",Ie],style:"style",styleClass:"styleClass",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{activeItemChange:"activeItemChange"},features:[He,Pe],decls:11,vars:11,consts:[["content",""],["navbar",""],["inkbar",""],["prevBtn",""],["tab",""],["tabLink",""],["htmlLabel",""],["htmlRouteLabel",""],["nextBtn",""],[3,"ngClass","ngStyle"],[1,"p-tabmenu-nav-container"],["class","p-tabmenu-nav-prev p-tabmenu-nav-btn p-link","type","button","role","navigation","pRipple","",3,"click",4,"ngIf"],[1,"p-tabmenu-nav-content",3,"scroll"],["role","menubar",1,"p-tabmenu-nav","p-reset"],["role","presentation","pTooltip","",3,"ngStyle","class","ngClass","tooltipOptions","click","keydown","focus",4,"ngFor","ngForOf"],["role","none",1,"p-tabmenu-ink-bar"],["class","p-tabmenu-nav-next p-tabmenu-nav-btn p-link","type","button","role","navigation","pRipple","",3,"click",4,"ngIf"],["type","button","role","navigation","pRipple","",1,"p-tabmenu-nav-prev","p-tabmenu-nav-btn","p-link",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet"],["role","presentation","pTooltip","",3,"click","keydown","focus","ngStyle","ngClass","tooltipOptions"],["class","p-menuitem-link","role","menuitem","pRipple","",3,"target",4,"ngIf"],["role","menuitem","class","p-menuitem-link","pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["role","menuitem","pRipple","",1,"p-menuitem-link",3,"target"],["class","p-menuitem-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-menuitem-text",4,"ngIf","ngIfElse"],["class","p-menuitem-badge",3,"ngClass",4,"ngIf"],[1,"p-menuitem-icon",3,"ngClass","ngStyle"],[1,"p-menuitem-text"],[1,"p-menuitem-text",3,"innerHTML"],[1,"p-menuitem-badge",3,"ngClass"],["role","menuitem","pRipple","",1,"p-menuitem-link",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],["type","button","role","navigation","pRipple","",1,"p-tabmenu-nav-next","p-tabmenu-nav-btn","p-link",3,"click"]],template:function(e,i){if(e&1){let o=y();c(0,"div",9)(1,"div",10),_(2,Bt,4,2,"button",11),c(3,"div",12,0),d("scroll",function(m){return f(o),b(i.onScroll(m))}),c(5,"ul",13,1),_(7,Nt,5,18,"li",14),h(8,"li",15,2),u()(),_(10,jt,4,2,"button",16),u()()}e&2&&(w(i.styleClass),s("ngClass",je(9,Ct,i.scrollable))("ngStyle",i.style),p(2),s("ngIf",i.scrollable&&!i.backwardIsDisabled),p(3),O("aria-labelledby",i.ariaLabelledBy)("aria-label",i.ariaLabel),p(2),s("ngForOf",i.focusableItems),p(3),s("ngIf",i.scrollable&&!i.forwardIsDisabled))},dependencies:()=>[Ge,Je,Xe,et,Ye,rt,at,st,W,Me,Be],styles:[`@layer primeng{.p-tabmenu-nav-container{position:relative}.p-tabmenu-scrollable .p-tabmenu-nav-container{overflow:hidden}.p-tabmenu-nav-content{overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scrollbar-width:none;overscroll-behavior:contain auto}.p-tabmenu-nav-btn{position:absolute;top:0;z-index:2;height:100%;display:flex;align-items:center;justify-content:center}.p-tabmenu-nav-prev{left:0}.p-tabmenu-nav-next{right:0}.p-tabview-nav-content::-webkit-scrollbar{display:none}.p-tabmenu-nav{display:flex;margin:0;padding:0;list-style-type:none;flex-wrap:nowrap}.p-tabmenu-nav a{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;position:relative;text-decoration:none;overflow:hidden}.p-tabmenu-nav a:focus{z-index:1}.p-tabmenu-nav .p-menuitem-text{line-height:1;white-space:nowrap}.p-tabmenu-ink-bar{display:none;z-index:1}.p-tabmenu-nav-content::-webkit-scrollbar{display:none}.p-tabmenuitem:not(.p-hidden){display:flex}}
`],encapsulation:2,changeDetection:0})}return n})(),Ri=(()=>{class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=Oe({type:n});static \u0275inj=De({imports:[tt,ke,Se,pt,R,Me,Be,ke,Se,R]})}return n})();var Hi=(()=>{let r=class r{onMousedown(e){e.stopPropagation()}onTouchStart(e){e.stopPropagation()}};r.\u0275fac=function(i){return new(i||r)},r.\u0275dir=Y({type:r,selectors:[["","labNoDrag",""]],hostBindings:function(i,o){i&1&&d("mousedown",function(m){return o.onMousedown(m)})("touchstart",function(m){return o.onTouchStart(m)})},standalone:!0});let n=r;return n})();var qi=(()=>{let r=class r{trackStep(e,i){return`${F(i.itemId,"")}|${F(i.recipeId,"")}`}trackById(e,i){return i.id}sortByValue(e,i){return i.value.sub(e.value).toNumber()}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=Fe({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var ve=(()=>{let r=class r{constructor(){this.contentSvc=$(ct),this.pDropdown=$(U,{self:!0}),this.labDropdownBase=N(),this.setAutoFocusFilter=Te(()=>{let e=this.contentSvc.isMobile();this.pDropdown.autofocusFilter=!e}),this.setStyleClass=Te(()=>{this.pDropdown.styleClass=this.labDropdownBase()})}ngOnInit(){this.pDropdown.appendTo="body",this.pDropdown.filter=!0,this.pDropdown.scrollHeight="40vh",this.pDropdown.panelStyleClass="tooltip"}};r.\u0275fac=function(i){return new(i||r)},r.\u0275dir=Y({type:r,selectors:[["","labDropdownBase",""]],inputs:{labDropdownBase:[1,"labDropdownBase"]},standalone:!0});let n=r;return n})();var dt=(()=>{let r=class r{transform(e,i,o){if(e==null)return[];if(!i?.length)return e;let a=new Set(i);return e.filter(m=>!a.has(m.value)||m.value===o)}};r.\u0275fac=function(i){return new(i||r)},r.\u0275pipe=Le({name:"filterOptions",type:r,pure:!0,standalone:!0});let n=r;return n})();var Zt=(n,r)=>r.id;function Gt(n,r){if(n&1&&(c(0,"div",8),h(1,"i"),g(2,"iconSmClass"),u()),n&2){let t=r.$implicit;p(),w(x(2,2,t.value))}}function Jt(n,r){if(n&1&&h(0,"lab-tooltip",11),n&2){let t=l().$implicit;s("id",t.value)}}function Xt(n,r){if(n&1&&(c(0,"div",9),h(1,"i"),g(2,"iconSmClass"),c(3,"div",10),E(4),u(),_(5,Jt,1,1,"ng-template",null,0,V),u()),n&2){let t=r.$implicit,e=B(6);s("pTooltip",t.value!=="module"?e:void 0),p(),w(x(2,4,t.value)),p(3),oe(" ",t.label," ")}}function Yt(n,r){if(n&1&&h(0,"lab-tooltip",11),n&2){let t=l(2).$implicit;s("id",t.id)}}function ei(n,r){if(n&1&&_(0,Yt,1,1,"lab-tooltip",11),n&2){let t=l().$implicit;k(t.id?0:-1)}}function ti(n,r){if(n&1){let t=y();c(0,"button",12),d("click",function(){f(t);let i=l().$index,o=l();return b(o.removeEntry(i))}),u()}if(n&2){let t=l().$implicit,e=l();s("disabled",t.id===e.ItemId.Module)}}function ii(n,r){if(n&1){let t=y();c(0,"div",2)(1,"lab-input-number",3),d("setValue",function(i){let o=f(t).$index,a=l();return b(a.setCount(o,i))}),u(),c(2,"p-dropdown",4),g(3,"filterOptions"),d("onChange",function(i){let o=f(t).$index,a=l();return b(a.setId(o,i))}),_(4,Gt,3,4,"ng-template",5)(5,Xt,7,6,"ng-template",6),u(),_(6,ei,1,1,"ng-template",null,0,V)(8,ti,1,1,"button",7),u()}if(n&2){let t,e=r.$implicit,i=r.$index,o=B(7),a=l();p(),s("value",(t=e.count)!==null&&t!==void 0?t:a.rational.zero)("maximum",a.maximum()[i])("disabled",e.id===a.ItemId.Module),p(),s("ngModel",e.id)("pTooltip",o)("options",Ke(3,7,a.options(),a.exclude(),e.id)),p(6),k(a.entity().modules!==!0?8:-1)}}var ge=(()=>{let r=class r{constructor(){this.settingsSvc=$(le),this.entity=N.required(),this.modules=N.required(),this.recipeId=N(),this.setValue=$e(),this.data=this.settingsSvc.dataset,this.exclude=J(()=>this.modules().map(e=>e.id).filter(re)),this.sum=J(()=>this.modules().map(e=>e.count).filter(re).reduce((e,i)=>e.add(i),I.zero)),this.options=J(()=>mt.moduleOptions(this.entity(),this.data(),this.recipeId())),this.maximum=J(()=>{let e=this.modules(),i=F(this.entity().modules,I.zero);if(i===!0)return e.map(()=>null);let o=this.sum(),a=e.find(v=>v.id===P.Module);a&&(o=o.sub(F(a.count,I.zero)));let m=i.sub(o);return e.map(v=>F(v.count,I.zero).add(m))}),this.rational=I,this.ItemId=P}setCount(e,i){let o=this.modules().map((a,m)=>e===m?X(a,{count:i}):a);this.updateEmpty(o),this.setValue.emit(o)}setId(e,i){i.originalEvent.stopPropagation();let o=i.value,a=this.modules().map((m,v)=>e===v?X(m,{id:o}):m);this.setValue.emit(a)}removeEntry(e){let i=this.modules().filter((o,a)=>e!==a);this.updateEmpty(i),this.setValue.emit(i)}updateEmpty(e){let i=this.entity().modules;if(i===!0||i==null)return;let o=e.map(a=>a.count).filter(re).reduce((a,m)=>a.add(m),I.zero);if(o.lt(i)){let a=i.sub(o),m=e.find(v=>v.id===P.Module);m?m.count=F(m.count,I.zero).add(a):e.push({id:P.Module,count:a})}else if(o.gt(i)){let a=o.sub(i),m=e.find(v=>v.id===P.Module);m&&(m.count=F(m.count,I.zero).sub(a),m.count.isZero()&&e.splice(e.indexOf(m),1))}}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=D({type:r,selectors:[["lab-modules"]],inputs:{entity:[1,"entity"],modules:[1,"modules"],recipeId:[1,"recipeId"]},outputs:{setValue:"setValue"},standalone:!0,features:[Q],decls:3,vars:0,consts:[["tooltip",""],[1,"d-flex","flex-column"],[1,"p-inputgroup"],["width","3rem",3,"setValue","value","maximum","disabled"],["labDropdownBase","icon",3,"onChange","ngModel","pTooltip","options"],["pTemplate","selectedItem"],["pTemplate","item"],["pButton","","pRipple","","type","button","icon","fa-solid fa-times",1,"p-button-outlined",3,"disabled"],[1,"d-flex"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],["type","module",3,"id"],["pButton","","pRipple","","type","button","icon","fa-solid fa-times",1,"p-button-outlined",3,"click","disabled"]],template:function(i,o){i&1&&(c(0,"div",1),ie(1,ii,9,11,"div",2,Zt),u()),i&2&&(p(),ne(o.modules()))},dependencies:[ce,se,pe,j,z,q,me,U,R,W,ve,dt,de,ue,he],encapsulation:2,changeDetection:0});let n=r;return n})();function oi(n,r){if(n&1){let t=y();c(0,"lab-input-number",10),g(1,"translate"),d("setValue",function(i){f(t);let o=l().$index,a=l();return b(a.setTotal(o,i))}),u()}if(n&2){let t=l().$implicit;s("pTooltip",x(1,2,"beaconsOverlay.totalTooltip"))("value",t.total)}}function ri(n,r){if(n&1&&(c(0,"div",4),h(1,"i"),g(2,"iconSmClass"),u()),n&2){let t=r.$implicit;p(),w(x(2,2,t.value))}}function ai(n,r){if(n&1&&h(0,"lab-tooltip",19),n&2){let t=l().$implicit;s("id",t.value)}}function li(n,r){if(n&1&&(c(0,"div",17),h(1,"i"),g(2,"iconSmClass"),c(3,"div",18),E(4),u(),_(5,ai,1,1,"ng-template",null,0,V),u()),n&2){let t=r.$implicit,e=B(6);s("pTooltip",e),p(),w(x(2,4,t.value)),p(3),oe(" ",t.label," ")}}function si(n,r){if(n&1&&h(0,"lab-tooltip",19),n&2){let t=l(2).$implicit;s("id",t.id)}}function pi(n,r){if(n&1&&_(0,si,1,1,"lab-tooltip",19),n&2){let t=l().$implicit;k(t.id?0:-1)}}function ci(n,r){if(n&1){let t=y();c(0,"lab-modules",20),d("setValue",function(i){f(t);let o=l().$index,a=l();return b(a.setModules(o,i))}),u()}if(n&2){let t=l().$implicit,e=l();s("entity",e.data().beaconEntities[t.id])("modules",t.modules)("recipeId",e.recipeId())}}function mi(n,r){if(n&1){let t=y();c(0,"div",3)(1,"div",9)(2,"lab-input-number",10),g(3,"translate"),d("setValue",function(i){let o=f(t).$index,a=l();return b(a.setCount(o,i))}),u(),_(4,oi,2,4,"lab-input-number",11),c(5,"p-dropdown",12),d("onChange",function(i){let o=f(t).$index,a=l();return b(a.setId(o,i))}),_(6,ri,3,4,"ng-template",13)(7,li,7,6,"ng-template",14),u(),_(8,pi,1,1,"ng-template",null,0,V),c(10,"button",15),d("click",function(){let i=f(t).$index,o=l();return b(o.removeEntry(i))}),u()(),_(11,ci,1,3,"lab-modules",16),u()}if(n&2){let t,e=r.$implicit,i=B(9),o=l();p(2),s("pTooltip",x(3,8,"beaconsOverlay.eachTooltip"))("value",(t=e.count)!==null&&t!==void 0?t:o.rational.zero),p(2),k(e.total?4:-1),p(),s("ngModel",e.id)("pTooltip",i)("options",o.options().beacons),p(5),s("disabled",o.beacons().length===1),p(),k(e.id&&e.modules?11:-1)}}var Pn=(()=>{let r=class r extends be{constructor(){super(...arguments),this.settingsSvc=$(le),this.setValue=new H,this.data=this.settingsSvc.dataset,this.options=this.settingsSvc.options,this.beacons=T([]),this.recipeId=T(void 0),this.rational=I}show(e,i,o){this.beacons.set(i.map(a=>Ee(K({},a),{modules:a.modules?.map(m=>K({},m))}))),this.recipeId.set(o),this._show(e)}setCount(e,i){this.beacons.update(o=>(o[e].count=i,o))}setId(e,i){i.originalEvent.stopPropagation(),this.beacons.update(o=>(o[e].id=i.value,o))}setModules(e,i){this.beacons.update(o=>(o[e].modules=i,o))}setTotal(e,i){this.beacons.update(o=>(o[e].total=i,o))}removeEntry(e){this.beacons.update(i=>i.filter((o,a)=>a!==e))}addEntry(){this.beacons.update(e=>{let i=this.options().beacons[0].value,o=this.data().beaconEntities[i].modules,a=[{id:P.Module,count:o}];return e.push({id:i,count:I.zero,modules:a}),e})}save(){let e=this.beacons().map(i=>X(i,{modules:i.modules?.filter(o=>o.count?.nonzero())}));this.setValue.emit(e)}};r.\u0275fac=(()=>{let e;return function(o){return(e||(e=ee(r)))(o||r)}})(),r.\u0275cmp=D({type:r,selectors:[["lab-beacons-overlay"]],outputs:{setValue:"setValue"},standalone:!0,features:[te,Q],decls:12,vars:9,consts:[["tooltip",""],["appendTo","body",3,"onHide"],[1,"d-flex","flex-column","gap-2"],[1,"d-flex","flex-column"],[1,"d-flex"],["pButton","","pRipple","","type","button","icon","fa-solid fa-plus",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],[1,"d-flex","gap-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-sm","p-button-secondary","flex-grow-1",3,"click","label"],[1,"p-inputgroup"],["width","3rem","tooltipPosition","top",3,"setValue","pTooltip","value"],["width","3rem","tooltipPosition","top",3,"pTooltip","value"],["labDropdownBase","icon",3,"onChange","ngModel","pTooltip","options"],["pTemplate","selectedItem"],["pTemplate","item"],["pButton","","pRipple","","type","button","icon","fa-solid fa-times",1,"p-button-outlined",3,"click","disabled"],[3,"entity","modules","recipeId"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],["type","beacon",3,"id"],[3,"setValue","entity","modules","recipeId"]],template:function(i,o){i&1&&(c(0,"p-overlayPanel",1),d("onHide",function(){return o.onHide()}),c(1,"div",2),ie(2,mi,12,10,"div",3,Ne),c(4,"div",4)(5,"button",5),g(6,"translate"),d("click",function(){return o.addEntry()}),u()(),c(7,"div",6)(8,"button",7),g(9,"translate"),d("click",function(){return o.hide()}),u(),c(10,"button",8),g(11,"translate"),d("click",function(){return o.hide(!0)}),u()()()()),i&2&&(p(2),ne(o.beacons()),p(3),s("label",x(6,3,"beaconsOverlay.addBeacons")),p(3),s("label",x(9,5,"ok")),p(2),s("label",x(11,7,"cancel")))},dependencies:[ce,se,pe,j,z,q,me,U,fe,_e,R,W,ve,de,ue,ge,he,ae],encapsulation:2,changeDetection:0});let n=r;return n})();function ui(n,r){if(n&1){let t=y();c(0,"lab-modules",6),d("setValue",function(i){f(t);let o=l();return b(o.modules.set(i))}),u()}if(n&2){let t=l();s("entity",r)("modules",t.modules())("recipeId",t.recipeId())}}var Kn=(()=>{let r=class r extends be{constructor(){super(...arguments),this.setValue=new H,this.machine=T(void 0),this.modules=T([]),this.recipeId=T(void 0)}show(e,i,o,a){this.machine.set(o),this.modules.set(i.map(m=>K({},m))),this.recipeId.set(a),this._show(e)}save(){let e=this.modules();this.machine()?.modules!==!0&&(e=e.filter(i=>i.count?.nonzero())),this.setValue.emit(e)}};r.\u0275fac=(()=>{let e;return function(o){return(e||(e=ee(r)))(o||r)}})(),r.\u0275cmp=D({type:r,selectors:[["lab-modules-overlay"]],outputs:{setValue:"setValue"},standalone:!0,features:[te,Q],decls:8,vars:7,consts:[["appendTo","body",3,"onHide"],[1,"d-flex","flex-column","gap-2"],[3,"entity","modules","recipeId"],[1,"d-flex","gap-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-sm","p-button-secondary","flex-grow-1",3,"click","label"],[3,"setValue","entity","modules","recipeId"]],template:function(i,o){if(i&1&&(c(0,"p-overlayPanel",0),d("onHide",function(){return o.onHide()}),c(1,"div",1),_(2,ui,1,3,"lab-modules",2),c(3,"div",3)(4,"button",4),g(5,"translate"),d("click",function(){return o.hide()}),u(),c(6,"button",5),g(7,"translate"),d("click",function(){return o.hide(!0)}),u()()()()),i&2){let a;p(2),k((a=o.machine())?2:-1,a),p(2),s("label",x(5,3,"ok")),p(2),s("label",x(7,5,"cancel"))}},dependencies:[j,z,fe,_e,ge,ae],encapsulation:2,changeDetection:0});let n=r;return n})();export{$i as a,Ri as b,Hi as c,qi as d,ve as e,dt as f,Pn as g,Kn as h};
