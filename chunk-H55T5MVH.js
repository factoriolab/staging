import{Ec as b,Ed as g,Gd as r,Ib as m,Id as I,O as u,S as d,Sc as f,ba as p,bd as h}from"./chunk-Z2AYPNVR.js";var k=(()=>{class i extends h{constructor(){super(...arguments),this.settingsSvc=d(I),this.itemsState=m(()=>i.computeItemsState(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.itemsModified=m(()=>{let s=this.state();return{belts:Object.keys(s).some(o=>s[o].beltId!=null),wagons:Object.keys(s).some(o=>s[o].wagonId!=null)}})}static computeItemsState(s,o,c){let a={};for(let n of c.itemIds.map(t=>c.itemEntities[t])){let t=f(s[n.id]);t.beltId||(n.stack?t.beltId=o.beltId:o.pipeId?t.beltId=o.pipeId:t.beltId=b.Pipe),t.wagonId||(t.wagonId=n.stack?o.cargoWagonId:o.fluidWagonId),a[n.id]=t}return a}static{this.\u0275fac=(()=>{let s;return function(c){return(s||(s=p(i)))(c||i)}})()}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var j=(()=>{class i extends h{constructor(){super(...arguments),this.settingsSvc=d(I),this.machinesState=m(()=>i.computeMachinesState(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset()))}static computeMachinesState(s,o,c){let a={};for(let n of c.machineIds){let t=f(s[n]),e=c.machineEntities[n];e.type===g.Burner&&(t.fuelOptions=r.fuelOptions(e,c),t.fuelId=t.fuelId??r.bestMatch(t.fuelOptions.map(l=>l.value),o.fuelRankIds)),e.modules&&(t.moduleOptions=r.moduleOptions(e,c),t.modules=r.hydrateModules(t.modules,t.moduleOptions,o.moduleRankIds,e.modules),t.beacons=r.hydrateBeacons(t.beacons,o.beacons)),t.overclock=t.overclock??o.overclock,a[n]=t}return a}static{this.\u0275fac=(()=>{let s;return function(c){return(s||(s=p(i)))(c||i)}})()}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var N=(()=>{class i extends h{constructor(){super(...arguments),this.itemsSvc=d(k),this.machinesSvc=d(j),this.settingsSvc=d(I),this.recipesState=m(()=>i.computeRecipesState(this.state(),this.machinesSvc.machinesState(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.adjustedDataset=m(()=>{let s=this.recipesState(),o=this.itemsSvc.itemsState(),c=this.settingsSvc.availableRecipeIds(),a=this.settingsSvc.settings(),n=this.settingsSvc.dataset();return r.adjustDataset(c,s,o,a,n)}),this.availableItemIds=m(()=>{let s=this.adjustedDataset();return s.itemIds.filter(o=>s.itemRecipeIds[o].length)})}static computeRecipesState(s,o,c,a){let n={};for(let t of a.recipeIds.map(e=>a.recipeEntities[e])){let e=f(s[t.id]);e.machineId==null&&(e.machineId=r.bestMatch(t.producers,c.machineRankIds));let l=a.machineEntities[e.machineId],S=o[e.machineId];if(t.isBurn?e.fuelId=Object.keys(t.in)[0]:e.fuelId=e.fuelId??S?.fuelId,e.fuelOptions=S?.fuelOptions,l!=null&&r.allowsModules(t,l)?(e.moduleOptions=r.moduleOptions(l,a,t.id),e.modules=r.hydrateModules(e.modules,e.moduleOptions,c.moduleRankIds,l.modules,S.modules),e.beacons=r.hydrateBeacons(e.beacons,S.beacons)):(delete e.modules,delete e.beacons),e.beacons)for(let v of e.beacons)v.total!=null&&(v.count==null||v.count.isZero())&&delete v.total;e.overclock=e.overclock??S?.overclock,n[t.id]=e}return n}static{this.\u0275fac=(()=>{let s;return function(c){return(s||(s=p(i)))(c||i)}})()}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{k as a,j as b,N as c};
