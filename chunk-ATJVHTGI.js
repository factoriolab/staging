import{Jd as l,Ud as b,_c as g,da as a,ha as p,hc as u,hd as c,je as m,ke as y,la as f,o as d}from"./chunk-YAB2OKXH.js";var $="lab-icon-css",E="lab-theme-css",P=(()=>{class h{document=f(u);store=f(g);themeValues$=new d(1);head=this.document.getElementsByTagName("head")[0];initialize(){this.store.select(y.selectDataset).pipe(a(e=>{let s=this.document.getElementById($);s&&this.head.removeChild(s);let n=this.document.createElement("style");n.id=$;let i="";e.iconIds.forEach(t=>{let o=e.iconEntities[t],r=this.escapeSelector(t);i+=`.${r}::before { background-image: url("${o.file}"); background-position: ${o.position}; } `,o.invertLight&&(i+=`body.light .${r}::before { filter: invert(1); } `,i+=`.invert .${r}::before { filter: invert(1); } `,i+=`body.light .invert .${r}::before { filter: none; } `)}),e.itemIds.map(t=>e.itemEntities[t]).filter(c("icon")).forEach(t=>{let o=e.iconEntities[t.icon],r=this.escapeSelector(t.id);i+=`.${r}.item::before { background-image: url("${o.file}"); background-position: ${o.position}; } `,o.invertLight&&(i+=`body.light .${r}.item::before { filter: invert(1); } `,i+=`.invert .${r}::before { filter: invert(1); } `,i+=`body.light .invert .${r}::before { filter: none; } `)}),e.recipeIds.map(t=>e.recipeEntities[t]).filter(c("icon")).forEach(t=>{let o=e.iconEntities[t.icon],r=this.escapeSelector(t.id);i+=`.${r}.recipe::before { background-image: url("${o.file}"); background-position: ${o.position}; } `,o.invertLight&&(i+=`body.light .${r}.recipe::before { filter: invert(1); } `,i+=`.invert .${r}::before { filter: invert(1); } `,i+=`body.light .invert .${r}::before { filter: none; } `)}),e.categoryIds.map(t=>e.categoryEntities[t]).filter(c("icon")).forEach(t=>{let o=e.iconEntities[t.icon],r=this.escapeSelector(t.id);i+=`.${r}.category::before { background-image: url("${o.file}"); background-position: ${o.position}; } `,o.invertLight&&(i+=`body.light .${r}.category::before { filter: invert(1); } `,i+=`.invert .${r}::before { filter: invert(1); } `,i+=`body.light .invert .${r}::before { filter: none; } `)}),e.itemIds.map(t=>e.itemEntities[t]).filter(c("iconText")).forEach(t=>{let o=this.escapeSelector(t.id);i+=`.${o}.item::after { content: "${t.iconText}"; } `}),e.recipeIds.map(t=>e.recipeEntities[t]).filter(c("iconText")).forEach(t=>{let o=this.escapeSelector(t.id);i+=`.${o}.recipe::after { content: "${t.iconText}"; } `}),e.categoryIds.map(t=>e.categoryEntities[t]).filter(c("iconText")).forEach(t=>{let o=this.escapeSelector(t.id);i+=`.${o}.category::after { content: "${t.iconText}"; } `}),n.innerText=i,this.head.appendChild(n)})).subscribe(),this.store.select(m.selectTheme).pipe(a(e=>{let s=this.document.getElementById(E);if(s){let n=this.themePath(e);if(s.href.endsWith(n))this.updateThemeValues();else{let i=this.document.createElement("link");i.rel="stylesheet",i.href=n,i.onload=()=>{s.href=n,this.head.removeChild(i),this.updateThemeValues()},this.head.appendChild(i)}}for(let n of[l.Light,l.Dark,l.Black])n===e?this.document.body.classList.add(n):this.document.body.classList.remove(n)})).subscribe()}updateThemeValues(){let e=getComputedStyle(this.document.body),s={textColor:e.getPropertyValue("--text-color"),successColor:e.getPropertyValue("--success-color"),successBackground:e.getPropertyValue("--success-background"),dangerColor:e.getPropertyValue("--danger-color"),dangerBackground:e.getPropertyValue("--danger-background")};this.themeValues$.next(s)}themePath(e){switch(e){case l.Light:return"theme-light.css";case l.Black:return"theme-black.css";default:return"theme-dark.css"}}escapeSelector(e){return e.replace(/([^A-Za-z0-9_-])/g,"\\$1")}static appInitTheme(){if((b.preferencesState?.theme??m.initialState.theme)===l.Light){let n=window.document.getElementById(E);n&&(n.href="theme-light.css")}}static \u0275fac=function(s){return new(s||h)};static \u0275prov=p({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})();export{P as a};
