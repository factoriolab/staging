import{Id as E,Kb as m,Nb as u,O as f,Oc as a,S as l,e as p,kd as h,od as g,rd as y,sd as b}from"./chunk-UQI3YGXD.js";var S="lab-icon-css",$="lab-theme-css",N=(()=>{let n=class n{constructor(){this.document=l(u),this.preferencesSvc=l(b),this.settingsSvc=l(E),this.themeValues$=new p(1),this.head=this.document.getElementsByTagName("head")[0],m(()=>{let e=this.preferencesSvc.theme(),o=this.document.getElementById($);if(o){let s=this.themePath(e);if(o.href.endsWith(s))this.updateThemeValues();else{let i=this.document.createElement("link");i.rel="stylesheet",i.href=s,i.onload=()=>{o.href=s,this.head.removeChild(i),this.updateThemeValues()},this.head.appendChild(i)}}for(let s of[h.Light,h.Dark,h.Black])s===e?this.document.body.classList.add(s):this.document.body.classList.remove(s)}),m(()=>{let e=this.settingsSvc.dataset(),o=this.document.getElementById(S);o&&this.head.removeChild(o);let s=this.document.createElement("style");s.id=S;let i="";e.iconIds.forEach(t=>{let c=e.iconEntities[t],r=this.escapeSelector(t);i+=`.${r}::before { background-image: url("${e.iconFile}"); background-position: ${c.position}; } `,i+=this.appendLightStyle(c,r,"")}),e.itemIds.map(t=>e.itemEntities[t]).filter(a("icon")).forEach(t=>{let c=e.iconEntities[t.icon],r=this.escapeSelector(t.id);i+=`.${r}.item::before { background-image: url("${e.iconFile}"); background-position: ${c.position}; } `,i+=this.appendLightStyle(c,r,".item")}),e.recipeIds.map(t=>e.recipeEntities[t]).filter(a("icon")).forEach(t=>{let c=e.iconEntities[t.icon],r=this.escapeSelector(t.id);i+=`.${r}.recipe::before { background-image: url("${e.iconFile}"); background-position: ${c.position}; } `,i+=this.appendLightStyle(c,r,".recipe")}),e.categoryIds.map(t=>e.categoryEntities[t]).filter(a("icon")).forEach(t=>{let c=e.iconEntities[t.icon],r=this.escapeSelector(t.id);i+=`.${r}.category::before { background-image: url("${e.iconFile}"); background-position: ${c.position}; } `,i+=this.appendLightStyle(c,r,".category")}),e.itemIds.map(t=>e.itemEntities[t]).filter(a("iconText")).forEach(t=>{let c=this.escapeSelector(t.id);i+=`.${c}.item::after { content: "${t.iconText}"; } `}),e.recipeIds.map(t=>e.recipeEntities[t]).filter(a("iconText")).forEach(t=>{let c=this.escapeSelector(t.id);i+=`.${c}.recipe::after { content: "${t.iconText}"; } `}),e.categoryIds.map(t=>e.categoryEntities[t]).filter(a("iconText")).forEach(t=>{let c=this.escapeSelector(t.id);i+=`.${c}.category::after { content: "${t.iconText}"; } `}),s.innerText=i,this.head.appendChild(s)})}appendLightStyle(e,o,s){if(!e.invertLight)return"";let i=`body.light .${o}${s}::before { filter: invert(1); } `;return i+=`.invert .${o}::before { filter: invert(1); } `,i+=`body.light .invert .${o}::before { filter: none; } `}updateThemeValues(){let e=getComputedStyle(this.document.body),o={textColor:e.getPropertyValue("--text-color"),successColor:e.getPropertyValue("--success-color"),successBackground:e.getPropertyValue("--success-background"),dangerColor:e.getPropertyValue("--danger-color"),dangerBackground:e.getPropertyValue("--danger-background")};this.themeValues$.next(o)}themePath(e){switch(e){case h.Light:return"theme-light.css";case h.Black:return"theme-black.css";default:return"theme-dark.css"}}escapeSelector(e){return e.replace(/([^A-Za-z0-9_-])/g,"\\$1")}static appInitTheme(){let e=y.theme,o=g("preferences");if(o)try{e=JSON.parse(o).theme}catch{}if(e===h.Light){let s=window.document.getElementById($);s&&(s.href="theme-light.css")}}};n.\u0275fac=function(o){return new(o||n)},n.\u0275prov=f({token:n,factory:n.\u0275fac,providedIn:"root"});let d=n;return d})();export{N as a};
