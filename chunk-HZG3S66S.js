import{Dd as y,Ec as b,Fd as r,Hd as g,Ib as d,Kc as v,O as p,Rc as S,S as m,ad as I,ba as h}from"./chunk-4K7DTB3N.js";var j=(()=>{class i extends I{constructor(){super(...arguments),this.settingsSvc=m(g),this.settings=d(()=>i.computeItemsSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.itemsModified=d(()=>{let e=this.state();return{belts:Object.keys(e).some(s=>e[s].beltId!=null),wagons:Object.keys(e).some(s=>e[s].wagonId!=null)}})}static computeItemsSettings(e,s,o){let a={};for(let c of o.itemIds.map(n=>o.itemEntities[n])){let n=e[c.id],t=this.defaultBelt(c,s),l=this.defaultWagon(c,s),u=v(n?.beltId,t),f=v(n?.wagonId,l);a[c.id]={beltId:u,defaultBeltId:t,wagonId:f,defaultWagonId:l}}return a}static defaultBelt(e,s){return e.stack?s.beltId:s.pipeId?s.pipeId:b.Pipe}static defaultWagon(e,s){return e.stack?s.cargoWagonId:s.fluidWagonId}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=h(i)))(o||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var O=(()=>{class i extends I{constructor(){super(...arguments),this.settingsSvc=m(g),this.settings=d(()=>i.computeMachinesSettings(this.state(),this.settingsSvc.settings(),this.settingsSvc.dataset()))}static computeMachinesSettings(e,s,o){let a={};for(let c of o.machineIds){let n=o.machineEntities[c],t=S(e[c]);n.type===y.Burner&&(t.fuelOptions=r.fuelOptions(n,o),t.defaultFuelId=r.bestMatch(t.fuelOptions.map(l=>l.value),s.fuelRankIds),t.fuelId=v(t?.fuelId,t.defaultFuelId)),n.modules&&(t.moduleOptions=r.moduleOptions(n,o),t.modules=r.hydrateModules(t.modules,t.moduleOptions,s.moduleRankIds,n.modules),t.beacons=r.hydrateBeacons(t.beacons,s.beacons)),t.overclock=t.overclock??s.overclock,a[c]=t}return a}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=h(i)))(o||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Q=(()=>{class i extends I{constructor(){super(...arguments),this.itemsSvc=m(j),this.machinesSvc=m(O),this.settingsSvc=m(g),this.settings=d(()=>i.computeRecipesSettings(this.state(),this.machinesSvc.settings(),this.settingsSvc.settings(),this.settingsSvc.dataset())),this.adjustedDataset=d(()=>{let e=this.settings(),s=this.itemsSvc.settings(),o=this.settingsSvc.availableRecipeIds(),a=this.settingsSvc.settings(),c=this.settingsSvc.dataset();return r.adjustDataset(o,e,s,a,c)}),this.availableItemIds=d(()=>{let e=this.adjustedDataset();return e.itemIds.filter(s=>e.itemRecipeIds[s].length)})}static computeRecipesSettings(e,s,o,a){let c={};for(let n of a.recipeIds.map(t=>a.recipeEntities[t])){let t=S(e[n.id]);t.machineId==null&&(t.machineId=r.bestMatch(n.producers,o.machineRankIds));let l=a.machineEntities[t.machineId],u=s[t.machineId];if(n.isBurn?t.fuelId=Object.keys(n.in)[0]:t.fuelId=t.fuelId??u?.fuelId,t.fuelOptions=u?.fuelOptions,l!=null&&r.allowsModules(n,l)?(t.moduleOptions=r.moduleOptions(l,a,n.id),t.modules=r.hydrateModules(t.modules,t.moduleOptions,o.moduleRankIds,l.modules,u.modules),t.beacons=r.hydrateBeacons(t.beacons,u.beacons)):(delete t.modules,delete t.beacons),t.beacons)for(let f of t.beacons)f.total!=null&&(f.count==null||f.count.isZero())&&delete f.total;t.overclock=t.overclock??u?.overclock,c[n.id]=t}return c}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=h(i)))(o||i)}})()}static{this.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{j as a,O as b,Q as c};
