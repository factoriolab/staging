import{a as De,b as Le,c as Ae,d as Ne,e as ze,g as Ge,h as qe}from"./chunk-GNHJGPMZ.js";import{b as yt}from"./chunk-I53NPTXK.js";import{a as Fe,b as Re,e as je,g as $e}from"./chunk-PJO3DCF6.js";import{a as Mt,b as Ot}from"./chunk-YOBTZJR2.js";import{a as ve,e as we,f as ye,s as Ee}from"./chunk-YJ32XG2B.js";import{b as Ft,c as Rt,d as Vt,e as Ue,f as We,g as He,i as Pt}from"./chunk-UEVZRP67.js";import{a as Ve,b as Pe}from"./chunk-XKSLUKGI.js";import{f as Me,g as Oe}from"./chunk-OZCEPD4V.js";import{e as Et,f as kt,h as Bt,i as ke,j as Be}from"./chunk-JX3YAFU2.js";import{B as It,n as gt,y as St,z as vt}from"./chunk-LYIDVOBE.js";import{a as wt,b as Te,c as at}from"./chunk-VWOD35WD.js";import{$ as M,$c as he,Ab as k,Ac as X,Ba as c,D as Yt,Dd as it,E as Zt,Ea as C,Ec as ht,Fb as se,Ga as Z,Gc as Se,Ha as ae,Hd as ot,Ia as O,Ib as ce,Ja as d,Ka as mt,Kb as Nt,Kc as et,La as le,Ma as A,Na as N,Nb as re,O as te,Oa as _,Pa as s,Qa as u,S as D,T as dt,Ta as j,Ua as R,Va as F,Vb as de,W as L,Wa as a,Wb as me,Xb as Ce,_ as B,ba as ee,bb as pe,cb as _e,cd as nt,d as Kt,db as b,eb as S,fb as E,fc as ue,gb as P,hd as Ut,ia as Lt,ib as Ct,ic as fe,jb as ut,kb as ft,ld as Wt,m as Xt,ma as ne,mb as xt,md as Ie,nb as Q,od as bt,pb as W,pd as Tt,qa as p,qb as At,rc as xe,sc as ge,sd as G,uc as h,ud as st,v as Qt,vb as tt,wb as r,wc as v,xb as x,ya as ie,yb as y,yd as be,za as oe,zb as _t}from"./chunk-LVJHIGHJ.js";import{a as rt,b as qt,f as sn,h as cn,j as Jt}from"./chunk-TWZW5B45.js";var Je=sn((Ht,zt)=>{"use strict";(function(t,i){typeof define=="function"&&define.amd?define([],i):typeof Ht<"u"?i():(i(),t.FileSaver={})})(Ht,function(){"use strict";function t(f,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function i(f,g,T){var I=new XMLHttpRequest;I.open("GET",f),I.responseType="blob",I.onload=function(){m(I.response,g,T)},I.onerror=function(){console.error("could not download file")},I.send()}function e(f){var g=new XMLHttpRequest;g.open("HEAD",f,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function n(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(g)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,l=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(f,g,T){var I=o.URL||o.webkitURL,w=document.createElement("a");g=g||f.name||"download",w.download=g,w.rel="noopener",typeof f=="string"?(w.href=f,w.origin===location.origin?n(w):e(w.href)?i(f,g,T):n(w,w.target="_blank")):(w.href=I.createObjectURL(f),setTimeout(function(){I.revokeObjectURL(w.href)},4e4),setTimeout(function(){n(w)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,T){if(g=g||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(t(f,T),g);else if(e(f))i(f,g,T);else{var I=document.createElement("a");I.href=f,I.target="_blank",setTimeout(function(){n(I)})}}:function(f,g,T,I){if(I=I||open("","_blank"),I&&(I.document.title=I.document.body.innerText="downloading..."),typeof f=="string")return i(f,g,T);var w=f.type==="application/octet-stream",V=/constructor/i.test(o.HTMLElement)||o.safari,$=/CriOS\/[\d]+/.test(navigator.userAgent);if(($||w&&V||l)&&typeof FileReader<"u"){var U=new FileReader;U.onloadend=function(){var pt=U.result;pt=$?pt:pt.replace(/^data:[^;]*;/,"data:attachment/file;"),I?I.location.href=pt:location=pt,I=null},U.readAsDataURL(f)}else{var z=o.URL||o.webkitURL,Y=z.createObjectURL(f);I?I.location=Y:location.href=Y,I=null,setTimeout(function(){z.revokeObjectURL(Y)},4e4)}});o.saveAs=m.saveAs=m,typeof zt<"u"&&(zt.exports=m)})});var Gt=cn(Je());var rn="text/csv;charset=UTF-8",dn=".csv",mn="text/json;charset=UTF-8",Cn=".json",un=["Item","Items","Surplus","Inputs","Outputs","Targets","Belts","Belt","Wagons","Wagon","Recipe","Machines","Machine","Modules","Beacons","Power","Pollution"],Ke=(()=>{let i=class i{constructor(){this.itemsSvc=D(wt),this.recipesSvc=D(at),this.settingsSvc=D(ot),this.itemsState=this.itemsSvc.itemsState,this.recipesState=this.recipesSvc.recipesState,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset}stepsToCsv(n){let o=n.map(f=>this.stepToJson(f,n)),l=un.filter(f=>o.some(g=>g[f]!=null)),m=o.map(f=>l.map(g=>f[g]).join(","));m.unshift(l.join(",")),m.unshift(`"${window.location.href}"`),this.saveAsCsv(m.join(`\r
`),"factoriolab_list")}flowToJson(n){this.saveAsJson(JSON.stringify(n),"factoriolab_flow")}saveAsCsv(n,o){(0,Gt.saveAs)(new Blob([n],{type:rn}),o+dn)}saveAsJson(n,o){(0,Gt.saveAs)(new Blob([n],{type:mn}),o+Cn)}stepToJson(n,o){let l=this.columnsState(),m=this.itemsState(),f=this.recipesState(),g=this.data(),T={};if(n.itemId!=null){T.Item=n.itemId;let I=m[n.itemId];n.items!=null&&(T.Items="="+n.items.sub(n.surplus??v.zero).toString()),n.surplus!=null&&(T.Surplus="="+n.surplus.toString()),l.belts.show&&(n.belts!=null&&(T.Belts="="+n.belts.toString()),T.Belt=I.beltId),l.wagons.show&&(n.wagons!=null&&(T.Wagons="="+n.wagons.toString()),T.Wagon=I.wagonId)}if(n.recipeId!=null){T.Recipe=n.recipeId;let I=g.adjustedRecipe[n.recipeId],w=f[n.recipeId],V=Object.keys(I.in).map($=>{let U=o.find(z=>z.itemId===$);return[$,U?.parents?.[n.id]?.toString()??""]}).filter($=>$[1]).map($=>`${$[0]}:${$[1]}`).join(",");if(V&&(T.Inputs=`"${V}"`),w.machineId!=null){let $=g.machineEntities[w.machineId],U=it.allowsModules(I,$);l.machines.show&&(n.machines!=null&&(T.Machines="="+n.machines.toString()),T.Machine=w.machineId,U&&w.modules!=null&&(T.Modules=`"${w.modules.filter(ht("count","id")).map(z=>`${z.count.toString()} ${z.id}`).join(",")}"`)),l.beacons.show&&U&&(T.Beacons=`"${X(w.beacons?.map(z=>`${X(z.count?.toString(),"")} ${X(z.id,"")} (${X(z.modules?.filter(ht("count","id")).map(Y=>`${Y.count.toString()} ${Y.id}`).join(","),"")})`).join(","),"")}"`),l.power.show&&n.power!=null&&(T.Power="="+n.power.toString()),l.pollution.show&&n.pollution!=null&&(T.Pollution="="+n.pollution.toString())}}if(n.outputs!=null){let I=n.outputs,w=Object.keys(I).map(V=>`${V}:${I[V].toString()}`).join(",");T.Outputs=`"${w}"`}if(n.parents!=null){let I=n.parents,w=Object.keys(I).map(V=>o.find($=>$.id===V)).filter(Se).filter(ht("recipeId")).map(V=>`${V.recipeId}:${I[V.id].toString()}`).join(",");T.Targets=`"${w}"`}return T}};i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=te({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();var Xe=(()=>{let i=class i{transform(n){return n}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"asStep",type:i,pure:!0,standalone:!0});let t=i;return t})();var Qe={[st.Chest]:{[G.Capacity0]:[{id:h.Inserter,value:v(.83)},{id:h.LongHandedInserter,value:v(1.2)},{id:h.FastInserter,value:v(2.31)},{id:h.StackInserter,value:v(4.62)}],[G.Capacity2]:[{id:h.Inserter,value:v(1.67)},{id:h.LongHandedInserter,value:v(2.4)},{id:h.FastInserter,value:v(4.62)},{id:h.StackInserter,value:v(9.23)}],[G.Capacity7]:[{id:h.Inserter,value:v(2.5)},{id:h.LongHandedInserter,value:v(3.6)},{id:h.FastInserter,value:v(6.92)},{id:h.StackInserter,value:v(27.69)}]},[st.ExpressTransportBelt]:{[G.Capacity0]:[{id:h.Inserter,value:v(.83)},{id:h.LongHandedInserter,value:v(1.2)},{id:h.FastInserter,value:v(2.31)},{id:h.StackInserter,value:v(4.44)}],[G.Capacity2]:[{id:h.Inserter,value:v(1.64)},{id:h.LongHandedInserter,value:v(2.35)},{id:h.FastInserter,value:v(4.44)},{id:h.StackInserter,value:v(7.74)}],[G.Capacity7]:[{id:h.Inserter,value:v(2.43)},{id:h.LongHandedInserter,value:v(3.46)},{id:h.FastInserter,value:v(6.43)},{id:h.StackInserter,value:v(13.85)}]},[st.FastTransportBelt]:{[G.Capacity0]:[{id:h.Inserter,value:v(.83)},{id:h.LongHandedInserter,value:v(1.2)},{id:h.FastInserter,value:v(2.31)},{id:h.StackInserter,value:v(4.44)}],[G.Capacity2]:[{id:h.Inserter,value:v(1.64)},{id:h.LongHandedInserter,value:v(2.35)},{id:h.FastInserter,value:v(4.44)},{id:h.StackInserter,value:v(7.06)}],[G.Capacity7]:[{id:h.Inserter,value:v(2.37)},{id:h.LongHandedInserter,value:v(3.33)},{id:h.FastInserter,value:v(6)},{id:h.StackInserter,value:v(10.91)}]},[st.TransportBelt]:{[G.Capacity0]:[{id:h.Inserter,value:v(.83)},{id:h.LongHandedInserter,value:v(1.2)},{id:h.FastInserter,value:v(2.31)},{id:h.StackInserter,value:v(4.44)}],[G.Capacity2]:[{id:h.Inserter,value:v(1.64)},{id:h.LongHandedInserter,value:v(2.35)},{id:h.FastInserter,value:v(4.44)},{id:h.StackInserter,value:v(5.71)}],[G.Capacity7]:[{id:h.Inserter,value:v(2.25)},{id:h.LongHandedInserter,value:v(3.1)},{id:h.FastInserter,value:v(5.29)},{id:h.StackInserter,value:v(6.79)}]}};var Ye=(()=>{let i=class i{transform(n,o){if(n!=null){let l=Qe[o.inserterTarget][o.inserterCapacity]?.find(m=>m.value.gt(n)||m.id===h.StackInserter);return l==null?null:{id:l.id,value:n.div(l.value)}}return null}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"inserterSpeed",type:i,pure:!0,standalone:!0});let t=i;return t})();var Ze=(()=>{let i=class i{transform(n){return n==null?"":" ".repeat(4-n.length)+n}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"leftPad",type:i,pure:!0,standalone:!0});let t=i;return t})();var q=(()=>{let i=class i{static transform(n,o){if(o==null)return n.toFraction();if(o===-2)return Math.round(n.mul(v(100n)).toNumber()).toString();let m=n.toPrecision(o).toString();if(o>0){let f=v(1,Math.pow(10,o));n.gt(v.zero)&&n.lt(f)&&(m=`<${m}`);let g=m.split(".");if(g.length>1){if(g[1].length<o){let T=o-g[1].length;return m+"0".repeat(T)}}else return n.isInteger()?m+" ".repeat(o+1):m+"."+"0".repeat(o)}return m}transform(n,o){return i.transform(n,o)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"rate",type:i,pure:!0,standalone:!0});let t=i;return t})();var tn=(()=>{let i=class i{transform(n,o,l){return l===h.Pumpjack?`${q.transform(n.mul(v(100n)),o!=null?Math.max(o-2,0):o)}%`:q.transform(n,o)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"machineRate",type:i,pure:!0,standalone:!0});let t=i;return t})();var en=(()=>{let i=class i{transform(n,o){return n==null?!1:o!==nt.DysonSphereProgram||n!==h.MiningMachine}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"machineShow",type:i,pure:!0,standalone:!0});let t=i;return t})();var nn=(()=>{let i=class i{transform(n,o){return o!==nt.CaptainOfIndustry||n!==h.MineControlTower}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"machineShowRate",type:i,pure:!0,standalone:!0});let t=i;return t})();var on=(()=>{let i=class i{transform(n,o,l=!1){if(n==null)return[];let m=n.map(f=>({label:o[f].name,value:f}));return l&&m.unshift({label:"None",value:h.Module}),m}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"options",type:i,pure:!0,standalone:!0});let t=i;return t})();var an=(()=>{let i=class i{transform(n,o,l){switch(l){case Ut.GW:return`${q.transform(n.div(v(1000000n)),o)} GW`;case Ut.MW:return`${q.transform(n.div(v(1000n)),o)} MW`;default:return`${q.transform(n,o)} kW`}}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"power",type:i,pure:!0,standalone:!0});let t=i;return t})();var ln=(()=>{let i=class i{constructor(){this.recipesSvc=D(at),this.routerSvc=D(yt),this.data=this.recipesSvc.adjustedDataset}transform(n,o){return Jt(this,null,function*(){let l=n;if(l.recipeId){let m=this.data().adjustedRecipe[l.recipeId];m.isTechnology&&m.productivity&&n.items&&(l=qt(rt({},n),{items:n.items.div(m.productivity)}))}return this.routerSvc.stepHref(l,o,this.data().hash)})}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"stepHref",type:i,pure:!0,standalone:!0});let t=i;return t})();var ct=(()=>{let i=class i{static transform(n){return n.itemId??n.recipeObjectiveId??n.recipeId??n.id}transform(n){return i.transform(n)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275pipe=L({name:"stepId",type:i,pure:!0,standalone:!0});let t=i;return t})();var J=class J{transform(i){return i==null?J.value.toFraction():J.value.toPrecision(i).toString()}};J.value=v(1n,3n),J.\u0275fac=function(e){return new(e||J)},J.\u0275pipe=L({name:"precisionExample",type:J,pure:!0,standalone:!0});var jt=J;var In=()=>({width:"400px"}),bn=()=>({"400px":"100vw"});function Tn(t,i){t&1&&(_(0,"tr")(1,"th"),S(2),r(3,"translate"),s(),_(4,"th"),S(5),r(6,"translate"),s(),_(7,"th"),S(8),r(9,"translate"),s(),_(10,"th"),S(11),r(12,"translate"),s()()),t&2&&(p(2),E(x(3,4,"columns.visibility")),p(3),E(x(6,6,"columns.decimals")),p(3),E(x(9,8,"columns.fractions")),p(3),E(x(12,10,"columns.example")))}function wn(t,i){if(t&1){let e=R();_(0,"td")(1,"p-inputNumber",7),ft("ngModelChange",function(o){B(e);let l=a().$implicit,m=a();return ut(m.editValue[l.value].precision,o)||(m.editValue[l.value].precision=o),M(o)}),s()(),_(2,"td",8)(3,"p-checkbox",9),F("onChange",function(o){B(e);let l=a().$implicit,m=a();return M(m.changeFraction(o.checked,l.value))}),s()(),_(4,"td"),S(5),r(6,"precisionExample"),s()}if(t&2){let e=a().$implicit,n=a();p(),C("min",0)("size",1)("showButtons",!0)("disabled",!n.editValue[e.value].show),Ct("ngModel",n.editValue[e.value].precision),p(2),C("ngModel",n.editValue[e.value].precision==null)("binary",!0)("disabled",!n.editValue[e.value].show),p(2),P(" ",x(6,9,n.editValue[e.value].precision)," ")}}function yn(t,i){t&1&&(_(0,"td",6)(1,"div",10),S(2),r(3,"translate"),s()()),t&2&&(p(2),E(x(3,1,"columns.notApplicable")))}function En(t,i){if(t&1){let e=R();_(0,"tr")(1,"td")(2,"p-checkbox",5),r(3,"translate"),ft("ngModelChange",function(o){let l=B(e).$implicit,m=a();return ut(m.editValue[l.value].show,o)||(m.editValue[l.value].show=o),M(o)}),s()(),c(4,wn,7,11)(5,yn,4,3,"td",6),s()}if(t&2){let e=i.$implicit,n=a();p(2),Ct("ngModel",n.editValue[e.value].show),C("binary",!0)("label",x(3,5,e.label))("disabled",e.disabled),p(2),d(n.columnsInf[e.value].hasPrecision?4:5)}}function kn(t,i){if(t&1){let e=R();_(0,"button",14),r(1,"translate"),F("click",function(){B(e);let o=a(2);return M(o.reset())}),s()}t&2&&C("label",x(1,1,"reset"))}function Bn(t,i){if(t&1){let e=R();c(0,kn,2,3,"button",11),_(1,"button",12),r(2,"translate"),F("click",function(){B(e);let o=a();return M(o.hide())}),s(),_(3,"button",13),r(4,"translate"),F("click",function(){B(e);let o=a();return M(o.hide(!0))}),s()}if(t&2){let e=a();d(e.modified?0:-1),p(),C("label",x(2,3,"ok")),p(2),C("label",x(4,5,"cancel"))}}var pn=(()=>{let i=class i extends je{constructor(){super(...arguments),this.preferencesSvc=D(Tt),this.settingsSvc=D(ot),this.columnOptions=this.settingsSvc.columnOptions,this.editValue=Ie,this.columnsInf=Wt}get modified(){return Object.keys(this.editValue).some(n=>this.editValue[n].precision!==bt.columns[n].precision||this.editValue[n].show!==bt.columns[n].show)}initEdit(n){this.editValue=Object.keys(n).filter(o=>Wt[o]!=null).reduce((o,l)=>(o[l]=rt({},n[l]),o),{})}open(n){this.initEdit(n),this.show()}changeFraction(n,o){this.editValue[o].precision=n?null:1}reset(){this.initEdit(bt.columns)}save(){let n=this.editValue;this.preferencesSvc.apply({columns:n})}};i.\u0275fac=(()=>{let n;return function(l){return(n||(n=ee(i)))(l||i)}})(),i.\u0275cmp=dt({type:i,selectors:[["lab-columns"]],standalone:!0,features:[oe,xt],decls:6,vars:15,consts:[[3,"visibleChange","onHide","visible","modal","dismissableMask","draggable","resizable","focusOnShow","breakpoints","header"],["responsiveLayout","scroll","styleClass","p-datatable-sm",3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"ngModelChange","ngModel","binary","label","disabled"],["colspan","3",1,"text-center"],["styleClass","w-100","inputStyleClass","text-end",1,"w-100",3,"ngModelChange","min","size","showButtons","disabled","ngModel"],[1,"text-center"],[3,"onChange","ngModel","binary","disabled"],[1,"p-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-secondary",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"click","label"]],template:function(o,l){o&1&&(_(0,"p-dialog",0),r(1,"translate"),ft("visibleChange",function(f){return ut(l.visible,f)||(l.visible=f),f}),F("onHide",function(){return l.onHide()}),_(2,"p-table",1),c(3,Tn,13,12,"ng-template",2)(4,En,6,7,"ng-template",3),s(),c(5,Bn,5,7,"ng-template",4),s()),o&2&&(ae(Q(13,In)),Ct("visible",l.visible),C("modal",!0)("dismissableMask",!0)("draggable",!1)("resizable",!1)("focusOnShow",!1)("breakpoints",Q(14,bn))("header",x(1,11,"columns.header")),p(2),C("value",l.columnOptions()))},dependencies:[Bt,Et,kt,vt,St,gt,Ot,Mt,Re,Fe,Rt,Ft,Pt,Vt,jt,It],styles:["th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{width:115px}[_nghost-%COMP%]     .p-dialog-content{padding-bottom:1rem}"],changeDetection:0});let t=i;return t})();var Mn=["stepsTable"],$t=(t,i)=>i.id,K=(t,i)=>i.key,On=()=>[25,50,100,1e3],_n=()=>[],Fn=(t,i,e,n,o,l,m,f,g,T,I,w,V)=>({items:t,itemId:i,belts:e,beltId:n,wagons:o,wagonId:l,machines:m,machineId:f,recipeId:g,recipeObjectiveId:T,percent:I,percentOnDest:!0,destId:w,inputs:V}),Rn=(t,i,e,n,o,l,m,f,g,T,I,w,V,$)=>({items:t,itemId:i,belts:e,beltId:n,wagons:o,wagonId:l,machines:m,machineId:f,recipeId:g,recipeObjectiveId:T,percent:I,destId:w,destRecipeObjectiveId:V,destIsRecipe:!0,outputs:$}),Dt=(t,i)=>({step:t,percent:i}),Vn=(t,i)=>({items:t,itemId:i}),Pn=(t,i,e,n,o,l,m,f,g,T,I,w,V)=>({items:t,itemId:i,belts:e,beltId:n,wagons:o,wagonId:l,machines:m,machineId:f,recipeId:g,recipeObjectiveId:T,percent:I,destId:w,destRecipeObjectiveId:V,destIsRecipe:!0}),jn=(t,i,e,n,o,l,m,f,g)=>({items:t,itemId:i,belts:e,beltId:n,wagons:o,wagonId:l,percent:m,destId:f,destRecipeObjectiveId:g,destIsRecipe:!0}),$n=(t,i,e,n,o,l,m,f,g,T,I,w,V)=>({items:t,itemId:i,belts:e,beltId:n,wagons:o,wagonId:l,machines:m,machineId:f,recipeId:g,recipeObjectiveId:T,percent:I,percentOnDest:!0,destId:w,destRecipeObjectiveId:V}),lt=(t,i)=>({value:t,itemId:i}),Dn=(t,i)=>({columnSettings:t,totals:i,type:"belt"}),Ln=(t,i)=>({columnSettings:t,totals:i}),An=(t,i,e)=>({columnSettings:t,totals:i,modulesTotals:e,type:"machine"}),Nn=(t,i,e)=>({columnSettings:t,totals:i,modulesTotals:e,type:"beacon"});function Un(t,i){if(t&1){let e=R();_(0,"button",34),r(1,"translate"),F("click",function(){B(e);let o=a(2);return M(o.exportSvc.stepsToCsv(o.steps()))}),s()}t&2&&C("label",x(1,1,"steps.downloadAsCsv"))}function Wn(t,i){if(t&1){let e=R();_(0,"button",37),r(1,"translate"),F("click",function(){B(e);let o=a(3);return M(o.resetChecked())}),s()}t&2&&C("pTooltip",x(1,1,"steps.checkedUndoTooltip"))}function Hn(t,i){if(t&1&&(_(0,"th")(1,"div",35),u(2,"i",36),c(3,Wn,2,3,"button",26),s()()),t&2){let e=a(2);p(3),d(e.settings().checkedItemIds.size||e.settings().checkedRecipeIds.size||e.settings().checkedObjectiveIds.size?3:-1)}}function zn(t,i){t&1&&(_(0,"th"),S(1),r(2,"translate"),s()),t&2&&(p(),E(x(2,1,"options.column.tree")))}function Gn(t,i){t&1&&u(0,"p-sortIcon",25)}function qn(t,i){if(t&1){let e=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(e);let l=a(2);return M(l.resetExcludedItems(o))}),s()}t&2&&C("pTooltip",x(1,1,"steps.itemsUndoTooltip"))}function Jn(t,i){t&1&&u(0,"p-sortIcon",38)}function Kn(t,i){if(t&1){let e=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(e);let l=a(3);return M(l.resetBelts(o))}),s()}t&2&&C("pTooltip",x(1,1,"steps.beltsUndoTooltip"))}function Xn(t,i){if(t&1&&(_(0,"th",27)(1,"div",24)(2,"span"),S(3),r(4,"translate"),s(),c(5,Jn,1,0,"p-sortIcon",38)(6,Kn,2,3,"button",26),s()()),t&2){let e=a(2);p(3),E(x(4,3,"options.column.belts")),p(2),d(e.focus()?-1:5),p(),d(e.itemsModified().belts?6:-1)}}function Qn(t,i){t&1&&u(0,"p-sortIcon",39)}function Yn(t,i){if(t&1){let e=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(e);let l=a(3);return M(l.resetWagons(o))}),s()}t&2&&C("pTooltip",x(1,1,"steps.wagonsUndoTooltip"))}function Zn(t,i){if(t&1&&(_(0,"th",28)(1,"div",24)(2,"span"),S(3),r(4,"translate"),s(),c(5,Qn,1,0,"p-sortIcon",39)(6,Yn,2,3,"button",26),s()()),t&2){let e=a(2);p(3),E(x(4,3,e.dispRateInfo().wagonsLabel)),p(2),d(e.focus()?-1:5),p(),d(e.itemsModified().wagons?6:-1)}}function ti(t,i){t&1&&u(0,"p-sortIcon",30)}function ei(t,i){if(t&1){let e=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(e);let l=a(2);return M(l.resetMachines(o))}),s()}t&2&&C("pTooltip",x(1,1,"steps.machinesUndoTooltip"))}function ni(t,i){if(t&1){let e=R();_(0,"button",37),r(1,"translate"),F("click",function(){B(e);let o=a(3);return M(o.resetBeacons())}),s()}t&2&&C("pTooltip",x(1,1,"steps.beaconsUndoTooltip"))}function ii(t,i){if(t&1&&(_(0,"th",31)(1,"div",24)(2,"span"),S(3),r(4,"translate"),s(),c(5,ni,2,3,"button",26),s()()),t&2){let e=a(2);p(3),E(x(4,2,"options.column.beacons")),p(2),d(e.recipesModified().beacons?5:-1)}}function oi(t,i){t&1&&u(0,"p-sortIcon",41)}function ai(t,i){if(t&1&&(_(0,"th",32)(1,"div",40)(2,"span"),S(3),r(4,"translate"),s(),c(5,oi,1,0,"p-sortIcon",41),s()()),t&2){let e=a(2);p(3),E(x(4,2,"options.column.power")),p(2),d(e.focus()?-1:5)}}function li(t,i){t&1&&u(0,"p-sortIcon",42)}function pi(t,i){if(t&1&&(_(0,"th",33)(1,"div",40)(2,"span"),S(3),r(4,"translate"),s(),c(5,li,1,0,"p-sortIcon",42),s()()),t&2){let e=a(2);p(3),E(x(4,2,e.dispRateInfo().pollutionLabel)),p(2),d(e.focus()?-1:5)}}function _i(t,i){t&1&&u(0,"th")}function si(t,i){if(t&1){let e=R();_(0,"tr")(1,"td",18)(2,"div",19)(3,"button",20),r(4,"translate"),F("click",function(){B(e);let o=a(),l=b(14);return M(l.open(o.columnsState()))}),s(),c(5,Un,2,3,"button",21),s()()(),_(6,"tr",22),u(7,"th"),c(8,Hn,4,1,"th")(9,zn,3,3,"th"),_(10,"th",23)(11,"div",24)(12,"span"),S(13),r(14,"translate"),s(),c(15,Gn,1,0,"p-sortIcon",25)(16,qn,2,3,"button",26),s()(),c(17,Xn,7,5,"th",27)(18,Zn,7,5,"th",28),_(19,"th",29)(20,"div",24)(21,"span"),S(22),r(23,"translate"),s(),c(24,ti,1,0,"p-sortIcon",30)(25,ei,2,3,"button",26),s()(),c(26,ii,6,4,"th",31)(27,ai,6,4,"th",32)(28,pi,6,4,"th",33)(29,_i,1,0,"th"),s()}if(t&2){let e=a();p(3),C("label",x(4,16,"steps.columnSettings")),p(2),d(e.steps().length?5:-1),p(3),d(!e.focus()&&e.columnsState().checkbox.show?8:-1),p(),d(!e.focus()&&e.columnsState().tree.show?9:-1),p(4),E(x(14,18,e.dispRateInfo().itemsLabel)),p(2),d(e.focus()?-1:15),p(),d(e.settings().excludedItemIds.size?16:-1),p(),d(e.columnsState().belts.show?17:-1),p(),d(e.columnsState().wagons.show?18:-1),p(4),E(x(23,20,"options.column.machines")),p(2),d(e.focus()?-1:24),p(),d(e.recipesModified().machines?25:-1),p(),d(e.columnsState().beacons.show?26:-1),p(),d(e.columnsState().power.show?27:-1),p(),d(e.columnsState().pollution.show?28:-1),p(),d(e.columnsState().link.show?29:-1)}}function ci(t,i){if(t&1&&u(0,"div",44),t&2){let e=i.$implicit,n=a();C("id","step_"+n.id+"_"+e.label)}}function ri(t,i){if(t&1){let e=R();_(0,"td",47)(1,"div",52)(2,"p-checkbox",53),F("onChange",function(o){B(e);let l=a(),m=a(2);return M(m.changeStepChecked(l,o.checked))}),s()()()}if(t&2){let e=a();p(2),C("binary",!0)("ngModel",e.checked)}}function di(t,i){if(t&1&&u(0,"div",60),t&2){let e=i.$implicit,n=i.$index,o=i.$count;Z("trail",e)("last",n===o-1)}}function mi(t,i){if(t&1&&(A(0,di,1,4,"div",59,mt),u(2,"div",55)),t&2){let e=a(2),n=a(2);N(n.stepTree()[e.id])}}function Ci(t,i){if(t&1&&u(0,"lab-tooltip",63),t&2){let e=a(3);C("id",e.itemId)}}function ui(t,i){if(t&1){let e=R();_(0,"button",61),r(1,"iconSmClass"),F("click",function(){B(e);let o=a(2),l=a(2);return M(l.changeItemExcluded(o.itemId,!l.settings().excludedItemIds.has(o.itemId)))}),u(2,"i",62),c(3,Ci,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(4),n=a(2),o=a(2);Z("hover-active",o.settings().excludedItemIds.has(n.itemId)),C("icon",x(1,4,n.itemId))("pTooltip",e)}}function fi(t,i){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(3);p(),P("#",e.recipeObjectiveId,"")}}function xi(t,i){if(t&1&&u(0,"lab-tooltip",65),t&2){let e=a(4);C("id",e.recipeId)}}function gi(t,i){if(t&1&&c(0,xi,1,1,"lab-tooltip",65),t&2){let e=a(3);d(e.recipeId?0:-1)}}function Si(t,i){if(t&1&&(_(0,"i",64),r(1,"iconSmClass"),c(2,fi,2,1,"span")(3,gi,1,1,"ng-template",null,5,k),s()),t&2){let e=b(4),n=a(2);O(y(1,4,n.recipeId,"recipe")),C("pTooltip",e),p(2),d(n.recipeObjectiveId!=null?2:-1)}}function vi(t,i){if(t&1&&(_(0,"td",48)(1,"div",54),c(2,mi,3,0,"div",55),_(3,"div",56),c(4,ui,5,6,"button",57)(5,Si,5,7,"i",58),s()()()),t&2){let e,n=a(),o=a(2),l=b(1);p(2),d(!l.sortField&&((e=o.stepTree()[n.id])!=null&&e.length)?2:-1),p(2),d(n.itemId&&n.recipeObjectiveId==null?4:5)}}function hi(t,i){if(t&1&&(_(0,"span",67),S(1),r(2,"rate"),s()),t&2){let e=a(2),n=a(2);p(),P("(+",y(2,1,e.surplus,n.columnsState().items.precision),") ")}}function Ii(t,i){if(t&1&&u(0,"lab-tooltip",63),t&2){let e=a(3);C("id",e.itemId)}}function bi(t,i){if(t&1){let e=R();_(0,"button",61),r(1,"iconSmClass"),F("click",function(){B(e);let o=a(2),l=a(2);return M(l.changeItemExcluded(o.itemId,!l.settings().excludedItemIds.has(o.itemId)))}),u(2,"i",62),c(3,Ii,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(4),n=a(2),o=a(2);Z("hover-active",o.settings().excludedItemIds.has(n.itemId)),C("icon",x(1,4,n.itemId))("pTooltip",e)}}function Ti(t,i){if(t&1&&(_(0,"td",66),c(1,hi,3,4,"span",67),_(2,"span",67),S(3),r(4,"rate"),s()(),_(5,"td",68)(6,"div",24)(7,"span",69),S(8),s(),c(9,bi,5,6,"button",57),s()()),t&2){let e,n=a(),o=a(2);p(),d(n.surplus&&n.surplus.nonzero()?1:-1),p(2),E(y(4,4,n.items.sub((e=n.surplus)!==null&&e!==void 0?e:o.rational.zero),o.columnsState().items.precision)),p(5),E(o.data().itemEntities[n.itemId].name),p(),d(!o.preferences().hideDuplicateIcons||!o.columnsState().tree.show?9:-1)}}function wi(t,i){t&1&&u(0,"td",31)}function yi(t,i){if(t&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),t&2){let e=a().$implicit;p(),O(x(2,2,e.value))}}function Ei(t,i){if(t&1&&c(0,yi,3,4,"div",45),t&2){let e=i.$implicit;d(e?0:-1)}}function ki(t,i){if(t&1&&u(0,"lab-tooltip",76),t&2){let e=a().$implicit;C("id",e.value)}}function Bi(t,i){if(t&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,ki,1,1,"ng-template",null,5,k),s()),t&2){let e=i.$implicit,n=b(6);C("pTooltip",n),p(),O(x(2,4,e.value)),p(3),P(" ",e.label," ")}}function Mi(t,i){if(t&1&&u(0,"lab-tooltip",76),t&2){let e=a(2);C("id",e)}}function Oi(t,i){if(t&1){let e=R();_(0,"p-dropdown",71),F("onChange",function(o){let l=B(e),m=a(4),f=a(2);return M(f.itemsSvc.updateEntityField(m.itemId,"beltId",o.value,l))}),c(1,Ei,1,1,"ng-template",72)(2,Bi,7,6,"ng-template",73)(3,Mi,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(4),n=a(),o=a(5);C("pTooltip",e)("ngModel",n)("options",o.options().belts)}}function Fi(t,i){if(t&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),t&2){let e=i.$implicit;p(),O(x(2,2,e.value))}}function Ri(t,i){if(t&1&&u(0,"lab-tooltip",77),t&2){let e=a().$implicit;C("id",e.value)}}function Vi(t,i){if(t&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,Ri,1,1,"ng-template",null,5,k),s()),t&2){let e=i.$implicit,n=b(6);C("pTooltip",n),p(),O(x(2,4,e.value)),p(3),P(" ",e.label," ")}}function Pi(t,i){if(t&1&&u(0,"lab-tooltip",77),t&2){let e=a(3);C("id",e)}}function ji(t,i){if(t&1){let e=R();_(0,"p-dropdown",71),F("onChange",function(o){let l=B(e),m=a(5),f=a(2);return M(f.itemsSvc.updateEntityField(m.itemId,"beltId",o.value,l))}),c(1,Fi,3,4,"ng-template",72)(2,Vi,7,6,"ng-template",73)(3,Pi,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(4),n=a(2),o=a(5);C("pTooltip",e)("ngModel",n)("options",o.options().pipes)}}function $i(t,i){if(t&1&&u(0,"lab-tooltip",77),t&2){let e=a(3);C("id",e)}}function Di(t,i){if(t&1&&(_(0,"i",64),r(1,"iconClass"),c(2,$i,1,1,"ng-template",null,5,k),s()),t&2){let e=b(3),n=a(2);O(x(1,3,n)),C("pTooltip",e)}}function Li(t,i){if(t&1&&c(0,ji,5,3,"p-dropdown",70)(1,Di,4,5,"i",58),t&2){let e,n=a(),o=a(5);d((e=o.data().pipeIds.indexOf(n)!==-1&&o.settings().pipeId)?0:1,e)}}function Ai(t,i){if(t&1&&(_(0,"td",66)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",68)(5,"div",24),c(6,Oi,5,3,"p-dropdown",70)(7,Li,2,1),s()()),t&2){let e,n=a(3),o=a(2);p(2),E(y(3,2,n.belts,o.columnsState().belts.precision)),p(4),d((e=o.data().beltIds.indexOf(i)!==-1&&o.settings().beltId)?6:7,e)}}function Ni(t,i){if(t&1&&c(0,Ai,8,5),t&2){let e,n=a(2),o=a(2);d((e=o.itemsState()[n.itemId].beltId)?0:-1,e)}}function Ui(t,i){t&1&&u(0,"td",31)}function Wi(t,i){if(t&1&&c(0,Ni,1,1)(1,Ui,1,0,"td",31),t&2){let e=a();d(e.itemId&&e.belts?0:1)}}function Hi(t,i){if(t&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),t&2){let e=a().$implicit;p(),O(x(2,2,e.value))}}function zi(t,i){if(t&1&&c(0,Hi,3,4,"div",45),t&2){let e=i.$implicit;d(e?0:-1)}}function Gi(t,i){if(t&1&&u(0,"lab-tooltip",78),t&2){let e=a().$implicit;C("id",e.value)}}function qi(t,i){if(t&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,Gi,1,1,"ng-template",null,5,k),s()),t&2){let e=i.$implicit,n=b(6);C("pTooltip",n),p(),O(x(2,4,e.value)),p(3),P(" ",e.label," ")}}function Ji(t,i){if(t&1&&u(0,"lab-tooltip",78),t&2){let e=a(2);C("id",e)}}function Ki(t,i){if(t&1){let e=R();_(0,"p-dropdown",71),F("onChange",function(o){let l=B(e),m=a(4),f=a(2);return M(f.itemsSvc.updateEntityField(m.itemId,"wagonId",o.value,l))}),c(1,zi,1,1,"ng-template",72)(2,qi,7,6,"ng-template",73)(3,Ji,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(4),n=a(),o=a(5);C("pTooltip",e)("ngModel",n)("options",o.options().cargoWagons)}}function Xi(t,i){if(t&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),t&2){let e=a().$implicit;p(),O(x(2,2,e.value))}}function Qi(t,i){if(t&1&&c(0,Xi,3,4,"div",45),t&2){let e=i.$implicit;d(e?0:-1)}}function Yi(t,i){if(t&1&&u(0,"lab-tooltip",79),t&2){let e=a().$implicit;C("id",e.value)}}function Zi(t,i){if(t&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s()(),c(5,Yi,1,1,"ng-template",null,5,k)),t&2){let e=i.$implicit,n=b(6);C("pTooltip",n),p(),O(x(2,4,e.value)),p(3),P(" ",e.label," ")}}function to(t,i){if(t&1&&u(0,"lab-tooltip",79),t&2){let e=a(3);C("id",e)}}function eo(t,i){if(t&1){let e=R();_(0,"p-dropdown",71),F("onChange",function(o){let l=B(e),m=a(5),f=a(2);return M(f.itemsSvc.updateEntityField(m.itemId,"wagonId",o.value,l))}),c(1,Qi,1,1,"ng-template",72)(2,Zi,7,6,"ng-template",73)(3,to,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(4),n=a(2),o=a(5);C("pTooltip",e)("ngModel",n)("options",o.options().fluidWagons)}}function no(t,i){if(t&1&&c(0,eo,5,3,"p-dropdown",70),t&2){let e,n=a(),o=a(5);d((e=o.data().fluidWagonIds.indexOf(n)!==-1&&o.settings().fluidWagonId)?0:-1,e)}}function io(t,i){if(t&1&&(_(0,"td",66)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",68)(5,"div",24),c(6,Ki,5,3,"p-dropdown",70)(7,no,1,1),s()()),t&2){let e,n=a(3),o=a(2);p(2),E(y(3,2,n.wagons,o.columnsState().wagons.precision)),p(4),d((e=o.data().cargoWagonIds.indexOf(i)!==-1&&o.settings().cargoWagonId)?6:7,e)}}function oo(t,i){if(t&1&&c(0,io,8,5),t&2){let e,n=a(2),o=a(2);d((e=o.itemsState()[n.itemId].wagonId)?0:-1,e)}}function ao(t,i){t&1&&u(0,"td",31)}function lo(t,i){if(t&1&&c(0,oo,1,1)(1,ao,1,0,"td",31),t&2){let e=a();d(e.itemId&&e.wagons?0:1)}}function po(t,i){if(t&1&&(_(0,"span",67),S(1),r(2,"machineRate"),s()),t&2){let e=a(),n=a(),o=a(2);p(),E(_t(2,1,n.machines,o.columnsState().machines.precision,e))}}function _o(t,i){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(4);p(),P("#",e.recipeObjectiveId,"")}}function so(t,i){if(t&1&&u(0,"lab-tooltip",65),t&2){let e=a(4);C("id",e.recipeId)}}function co(t,i){if(t&1){let e=R();_(0,"button",83),F("click",function(){B(e);let o=a(3),l=a(2);return M(l.objectivesSvc.add({targetId:o.recipeId,unit:l.ObjectiveUnit.Machines}))}),_(1,"span",84),r(2,"iconSmClass"),c(3,_o,2,1,"span"),s(),u(4,"i",85),c(5,so,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(6),n=a(3);C("pTooltip",e),p(),O(y(2,4,n.recipeId,"recipe")),p(2),d(n.recipeObjectiveId?3:-1)}}function ro(t,i){if(t&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),t&2){let e=a().$implicit;p(),O(x(2,2,e.value))}}function mo(t,i){if(t&1&&c(0,ro,3,4,"div",45),t&2){let e=i.$implicit;d(e?0:-1)}}function Co(t,i){if(t&1&&u(0,"lab-tooltip",87),t&2){let e=a().$implicit;C("id",e.value)}}function uo(t,i){if(t&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,Co,1,1,"ng-template",null,5,k),s()),t&2){let e=i.$implicit,n=b(6);C("pTooltip",n),p(),O(x(2,4,e.value)),p(3),P(" ",e.label," ")}}function fo(t,i){if(t&1&&u(0,"lab-tooltip",87),t&2){let e=a(3);C("id",e)}}function xo(t,i){if(t&1){let e=R();_(0,"p-dropdown",86),r(1,"options"),F("onChange",function(o){B(e);let l=a(3),m=a(2);return M(m.changeRecipeField(l,o.value,"machine"))}),c(2,mo,1,1,"ng-template",72)(3,uo,7,6,"ng-template",73)(4,fo,1,1,"ng-template",null,5,k),s()}if(t&2){let e=b(5),n=a(2),o=a(),l=a(2);C("pTooltip",e)("options",y(1,3,o.recipe.producers,l.data().itemEntities))("ngModel",n)}}function go(t,i){if(t&1){let e=R();_(0,"p-inputNumber",88,6),r(2,"translate"),F("onBlur",function(){let o;B(e);let l=b(1),m=a(3),f=a(2);return M(f.changeRecipeField(m,(o=l.value)!==null&&o!==void 0?o:100,"overclock"))}),s()}if(t&2){let e=a(3);C("min",1)("max",250)("step",10)("maxFractionDigits",2)("size",3)("pTooltip",x(2,7,"steps.overclockTooltip"))("ngModel",e.recipeSettings.overclock)}}function So(t,i){if(t&1&&u(0,"lab-tooltip",90),t&2){let e=a(2);C("id",e)}}function vo(t,i){if(t&1&&(_(0,"div",24)(1,"i",89),r(2,"iconSmClass"),c(3,So,1,1,"ng-template",null,5,k),s()()),t&2){let e=b(4),n=a();p(),O(x(2,3,n)),C("pTooltip",e)}}function ho(t,i){if(t&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),t&2){let e=i.$implicit;p(),O(x(2,2,e.value))}}function Io(t,i){if(t&1&&u(0,"lab-tooltip",90),t&2){let e=a().$implicit;C("id",e.value)}}function bo(t,i){if(t&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,Io,1,1,"ng-template",null,5,k),s()),t&2){let e=i.$implicit,n=b(6);C("pTooltip",n),p(),O(x(2,4,e.value)),p(3),P(" ",e.label," ")}}function To(t,i){if(t&1&&u(0,"lab-tooltip",90),t&2){let e=a(2);C("id",e)}}function wo(t,i){if(t&1){let e=R();_(0,"p-dropdown",71),F("onChange",function(o){B(e);let l=a(4),m=a(2);return M(m.changeRecipeField(l,o.value,"fuel"))}),c(1,ho,3,4,"ng-template",72)(2,bo,7,6,"ng-template",73)(3,To,1,1,"ng-template",null,5,k),s()}if(t&2){let e,n=b(4),o=a(),l=a(3);C("pTooltip",n)("ngModel",o)("options",(e=l.recipeSettings.fuelOptions)!==null&&e!==void 0?e:Q(3,_n))}}function yo(t,i){if(t&1&&c(0,vo,5,5,"div",24)(1,wo,5,4,"p-dropdown",70),t&2){let e=a(3);d(e.recipe.isBurn?0:e.recipeSettings.machineId?1:-1)}}function Eo(t,i){if(t&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),t&2){let e=i.$implicit;p(),O(x(2,2,e.value))}}function ko(t,i){if(t&1&&u(0,"lab-tooltip",93),t&2){let e=a().$implicit;C("id",e.value)}}function Bo(t,i){if(t&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,ko,1,1,"ng-template",null,5,k),s()),t&2){let e=i.$implicit,n=b(6);C("pTooltip",e.value!=="module"?n:void 0),p(),O(x(2,4,e.value)),p(3),P(" ",e.label," ")}}function Mo(t,i){if(t&1){let e=R();_(0,"p-dropdown",92),r(1,"translate"),F("onChange",function(o){B(e);let l=a(5),m=a(2);return M(m.changeRecipeField(l,[{id:o.value,count:m.rational.one}],"modules"))}),c(2,Eo,3,4,"ng-template",72)(3,Bo,7,6,"ng-template",73),s()}if(t&2){let e,n=a(2),o=a(3);C("pTooltip",x(1,3,"settings.modifierTooltip"))("ngModel",n[0].id)("options",(e=o.recipeSettings.moduleOptions)!==null&&e!==void 0?e:Q(5,_n))}}function Oo(t,i){if(t&1&&(_(0,"i",84),r(1,"iconSmClass"),_(2,"span"),S(3),s()()),t&2){let e=i.$implicit;O(x(1,3,e.id)),p(3),E(e.count)}}function Fo(t,i){if(t&1&&u(0,"lab-tooltip",93),t&2){let e=a().$implicit;C("id",e.id)}}function Ro(t,i){if(t&1&&c(0,Fo,1,1,"lab-tooltip",93),t&2){let e=i.$implicit;d(e.id?0:-1)}}function Vo(t,i){if(t&1&&A(0,Ro,1,1,null,null,$t),t&2){let e=a(3);N(e)}}function Po(t,i){if(t&1){let e=R();_(0,"button",94),F("click",function(o){B(e);let l=b(5),m=a(),f=a(),g=a(3);return M(l.show(o,f,m,g.recipeId))}),A(1,Oo,4,5,"i",95,$t),u(3,"i",96),s(),_(4,"lab-modules-overlay",97,7),F("setValue",function(o){B(e);let l=a(5),m=a(2);return M(m.changeRecipeField(l,o,"modules"))}),s(),c(6,Vo,2,0,"ng-template",null,5,k)}if(t&2){let e=b(7),n=a(2);C("pTooltip",e),p(),N(n)}}function jo(t,i){if(t&1&&c(0,Mo,4,6,"p-dropdown",91)(1,Po,8,1),t&2){let e=i;d(e.modules!==!0&&(e.modules!=null&&e.modules.isOne())?0:e.modules!=null?1:-1)}}function $o(t,i){if(t&1&&c(0,jo,2,1),t&2){let e,n=a(2),o=a(3);d((e=o.data().machineEntities[n])?0:-1,e)}}function Do(t,i){if(t&1&&(_(0,"div",24)(1,"span",69),S(2),s(),c(3,co,7,7,"button",80)(4,xo,6,6,"p-dropdown",81),r(5,"machineShow"),c(6,go,3,9,"p-inputNumber",82)(7,yo,2,1)(8,$o,1,1),s()),t&2){let e,n,o=a(),l=a(),m=a(2);p(2),E(l.recipe.name),p(),d(!m.preferences().hideDuplicateIcons||l.itemId!=null&&l.itemId!==l.recipeId?3:-1),p(),d(y(5,6,o,m.data().game)?4:-1),p(2),d(m.data().game===m.Game.Satisfactory?6:-1),p(),d((e=l.recipeSettings==null?null:l.recipeSettings.fuelId)?7:-1,e),p(),d((n=l.recipeSettings==null?null:l.recipeSettings.modules)?8:-1,n)}}function Lo(t,i){if(t&1&&(_(0,"td",66),c(1,po,3,5,"span",67),r(2,"machineShowRate"),s(),_(3,"td",68),c(4,Do,9,9,"div",24),s()),t&2){let e=a(),n=a(2);p(),d(e.machines&&e.machines.nonzero()&&y(2,2,i,n.data().game)?1:-1),p(3),d(e.recipeId&&e.recipe&&e.recipeSettings?4:-1)}}function Ao(t,i){t&1&&u(0,"td",31)}function No(t,i){if(t&1&&(_(0,"i",100),r(1,"iconSmClass"),_(2,"span"),S(3),s()()),t&2){let e=a().$implicit;O(x(1,3,e.id)),p(3),E(e.total)}}function Uo(t,i){if(t&1&&(_(0,"i",84),r(1,"iconSmClass"),_(2,"span"),S(3),s()()),t&2){let e=i.$implicit;O(x(1,3,e.id)),p(3),E(e.count)}}function Wo(t,i){if(t&1&&(_(0,"div",45)(1,"i",84),r(2,"iconSmClass"),_(3,"span"),S(4),s()(),c(5,No,4,5,"i",99),A(6,Uo,4,5,"i",95,$t),s()),t&2){let e=i.$implicit;p(),O(x(2,4,e.id)),p(3),E(e.count),p(),d(e.total?5:-1),p(),N(e.modules)}}function Ho(t,i){t&1&&u(0,"lab-tooltip",101),t&2&&C("id",i)}function zo(t,i){if(t&1&&c(0,Ho,1,1,"lab-tooltip",101),t&2){let e,n=a(3);d((e=n.recipeSettings.beacons==null||n.recipeSettings.beacons[0]==null?null:n.recipeSettings.beacons[0].id)?0:-1,e)}}function Go(t,i){if(t&1){let e=R();_(0,"button",98),F("click",function(o){B(e);let l=b(5),m=a(2);return M(l.show(o,m.recipeSettings.beacons))}),A(1,Wo,8,6,"div",45,mt),u(3,"i",96),s(),_(4,"lab-beacons-overlay",97,8),F("setValue",function(o){B(e);let l=a(2),m=a(2);return M(m.changeRecipeField(l,o,"beacons"))}),s(),c(6,zo,1,1,"ng-template",null,5,k)}if(t&2){let e=b(7),n=a(2);C("pTooltip",e),p(),N(n.recipeSettings.beacons)}}function qo(t,i){if(t&1&&(_(0,"td",49),c(1,Go,8,1),s()),t&2){let e=a();p(),d(e.recipeId&&e.recipeSettings&&e.recipeSettings.beacons?1:-1)}}function Jo(t,i){if(t&1&&(_(0,"span",67),S(1),r(2,"power"),s()),t&2){let e=a(2),n=a(2);p(),E(_t(2,1,e.power,n.columnsState().power.precision,n.effectivePowerUnit()))}}function Ko(t,i){if(t&1&&(_(0,"td",50),c(1,Jo,3,5,"span",67),s()),t&2){let e=a();p(),d(e.power&&e.power.nonzero()?1:-1)}}function Xo(t,i){if(t&1&&(_(0,"span",67),S(1),r(2,"rate"),s()),t&2){let e=a(2),n=a(2);p(),E(y(2,1,e.pollution,n.columnsState().pollution.precision))}}function Qo(t,i){if(t&1&&(_(0,"td",50),c(1,Xo,3,4,"span",67),s()),t&2){let e=a();p(),d(e.pollution&&e.pollution.nonzero()?1:-1)}}function Yo(t,i){if(t&1){let e=R();_(0,"button",105),r(1,"translate"),F("click",function(){B(e);let o=a(2),l=a(2);return M(l.resetStep(o))}),s()}t&2&&C("pTooltip",x(1,1,"steps.stepUndoTooltip"))}function Zo(t,i){if(t&1&&(_(0,"td",51)(1,"div",45)(2,"a",102),r(3,"stepHref"),r(4,"async"),u(5,"button",103),r(6,"translate"),s(),c(7,Yo,2,3,"button",104),s()()),t&2){let e=a(),n=a(2);p(2),C("queryParams",x(4,6,y(3,3,e,n.routerSvc.zipConfig()))),p(3),C("pTooltip",x(6,8,"steps.openNewTabTooltip")),p(2),d(e.recipeId&&n.stepsModified().recipes[e.recipeId]||e.itemId&&n.stepsModified().items[e.itemId]||e.recipeObjectiveId&&n.stepsModified().objectives[e.recipeObjectiveId]?7:-1)}}function ta(t,i){if(t&1){let e=R();_(0,"tr")(1,"td",43),u(2,"div",44),A(3,ci,1,1,"div",44,$t),_(5,"div",45)(6,"button",46),r(7,"translate"),F("click",function(){let o=B(e),l=a().expanded,m=a();return M(m.expandRow(o,l))}),s()()(),c(8,ri,3,2,"td",47)(9,vi,6,2,"td",48)(10,Ti,10,7)(11,wi,1,0,"td",31)(12,Wi,2,1)(13,lo,2,1)(14,Lo,5,5)(15,Ao,1,0,"td",31)(16,qo,2,1,"td",49)(17,Ko,2,1,"td",50)(18,Qo,2,1,"td",50)(19,Zo,8,10,"td",51),s()}if(t&2){let e,n=i,o=a().expanded,l=a();p(2),C("id","step_"+n.id),p(),N(l.stepDetails()[n.id].tabs),p(3),Z("fa-rotate-90",o),C("pTooltip",x(7,15,o?"steps.hideDetails":"steps.showDetails"))("pRowToggler",n),p(2),d(!l.focus()&&l.columnsState().checkbox.show?8:-1),p(),d(!l.focus()&&l.columnsState().tree.show?9:-1),p(),d(n.itemId&&n.items?10:11),p(2),d(l.columnsState().belts.show?12:-1),p(),d(l.columnsState().wagons.show?13:-1),p(),d((e=n.recipeSettings==null?null:n.recipeSettings.machineId)?14:15,e),p(2),d(l.columnsState().beacons.show?16:-1),p(),d(l.columnsState().power.show?17:-1),p(),d(l.columnsState().pollution.show?18:-1),p(),d(l.columnsState().link.show?19:-1)}}function ea(t,i){if(t&1&&(c(0,ta,20,17,"tr"),r(1,"asStep")),t&2){let e,n=i.$implicit;d((e=x(1,1,n))?0:-1,e)}}function na(t,i){if(t&1&&(_(0,"a",111),u(1,"span",112),_(2,"span",113),S(3),r(4,"translate"),s()()),t&2){let e=i.$implicit,n=a(3);C("id",e.id),p(),O(n.stepDetailIcon[e.label]),p(2),E(x(4,4,"options.stepDetailTab."+e.label))}}function ia(t,i){t&1&&j(0)}function oa(t,i){if(t&1&&(_(0,"tr",106),c(1,ia,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()()),t&2){a(4);let e=b(9);p(),C("ngTemplateOutlet",e),p(2),P(" ",x(4,2,"steps.sources")," ")}}function aa(t,i){t&1&&j(0)}function la(t,i){if(t&1&&c(0,aa,1,0,"ng-container",116),t&2){let e=a().$implicit,n=a(2),o=a(2),l=b(11);C("ngTemplateOutlet",l)("ngTemplateOutletContext",tt(2,Fn,[n.items==null?null:n.items.mul(e.value),n.itemId,n.belts==null?null:n.belts.mul(e.value),o.itemsState()[n.itemId].beltId,n.wagons==null?null:n.wagons.mul(e.value),o.itemsState()[n.itemId].wagonId,e.step==null?null:e.step.machines,e.step==null||e.step.recipeSettings==null?null:e.step.recipeSettings.machineId,e.step==null?null:e.step.recipeId,e.step==null?null:e.step.recipeObjectiveId,e.value,n.itemId,e.inputs]))}}function pa(t,i){if(t&1&&c(0,la,1,16,"ng-container"),t&2){let e=a(2);d(e.itemId?0:-1)}}function _a(t,i){t&1&&j(0)}function sa(t,i){if(t&1&&(_(0,"tr",106),c(1,_a,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()()),t&2){a(4);let e=b(9);p(),C("ngTemplateOutlet",e),p(2),P(" ",x(4,2,"steps.destinations")," ")}}function ca(t,i){t&1&&j(0)}function ra(t,i){if(t&1&&c(0,ca,1,0,"ng-container",116),t&2){let e,n=a().$implicit,o=a(2),l=a(2),m=b(11);C("ngTemplateOutlet",m)("ngTemplateOutletContext",tt(2,Rn,[o.items==null?null:o.items.mul(n.value),o.itemId,o.belts==null?null:o.belts.mul(n.value),l.itemsState()[o.itemId].beltId,o.wagons==null?null:o.wagons.mul(n.value),l.itemsState()[o.itemId].wagonId,l.stepDetails()[o.id].outputs.length===1?o.machines==null?null:o.machines.mul(n.value):null,l.stepDetails()[o.id].outputs.length===1?o.recipeSettings==null?null:o.recipeSettings.machineId:null,o.recipeId,o.recipeObjectiveId,n.value,(e=l.stepById()[n.key])==null?null:e.recipeId,(e=l.stepById()[n.key])==null?null:e.recipeObjectiveId,n.key===""]))}}function da(t,i){if(t&1&&c(0,ra,1,17,"ng-container"),t&2){let e=a(2);d(e.itemId?0:-1)}}function ma(t,i){if(t&1&&(c(0,oa,5,4,"tr",106),A(1,pa,1,1,null,null,mt),c(3,sa,5,4,"tr",106),A(4,da,1,1,null,null,K),r(6,"keyvalue")),t&2){let e=a(),n=a(2);d(n.stepDetails()[e.id].outputs.length?0:-1),p(),N(n.stepDetails()[e.id].outputs),p(2),d(e.parents?3:-1),p(),N(y(6,2,e.parents,n.trackSvc.sortByValue))}}function Ca(t,i){t&1&&j(0)}function ua(t,i){t&1&&j(0)}function fa(t,i){if(t&1&&c(0,ua,1,0,"ng-container",116),t&2){let e=a(),n=a().$implicit,o=a(4);a(2);let l=b(11);C("ngTemplateOutlet",l)("ngTemplateOutletContext",W(2,Vn,e.step.items.mul(e.percent).div(o.recipe.productivity),n.key))}}function xa(t,i){if(t&1&&c(0,fa,1,5,"ng-container"),t&2){let e=i;d(e.step&&e.percent&&e.step.items?0:-1)}}function ga(t,i){if(t&1&&c(0,xa,1,1),t&2){let e,n=i.$implicit,o=a(4),l=a(2);d((e=W(1,Dt,l.stepByItemEntities()[n.key],o.outputs==null?null:o.outputs[n.key]))?0:-1,e)}}function Sa(t,i){if(t&1&&(_(0,"tr",106),c(1,Ca,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()(),A(5,ga,1,4,null,null,K),r(7,"keyvalue")),t&2){let e=a(3),n=a(2),o=b(9);p(),C("ngTemplateOutlet",o),p(2),P(" ",x(4,2,"steps.depletion")," "),p(2),N(y(7,4,e.outputs,n.trackSvc.sortByValue))}}function va(t,i){t&1&&j(0)}function ha(t,i){t&1&&j(0)}function Ia(t,i){if(t&1&&c(0,ha,1,0,"ng-container",116),t&2){let e=i,n=a(2),o=a().$implicit,l=a(4),m=a(2),f=b(11);C("ngTemplateOutlet",f)("ngTemplateOutletContext",tt(2,Pn,[n.step.items==null?null:n.step.items.mul(n.percent),o.key,n.step.belts==null?null:n.step.belts.mul(n.percent),m.itemsState()[n.step.itemId].beltId,n.step.wagons==null?null:n.step.wagons.mul(n.percent),m.itemsState()[n.step.itemId].wagonId,e.step==null?null:e.step.machines,e.step==null||e.step.recipeSettings==null?null:e.step.recipeSettings.machineId,e.step==null?null:e.step.recipeId,e.step==null?null:e.step.recipeObjectiveId,n.percent,l.recipeId,l.recipeObjectiveId]))}}function ba(t,i){t&1&&j(0)}function Ta(t,i){if(t&1&&c(0,ba,1,0,"ng-container",116),t&2){let e=a(2),n=a().$implicit,o=a(4),l=a(2),m=b(11);C("ngTemplateOutlet",m)("ngTemplateOutletContext",tt(2,jn,[e.step.items==null?null:e.step.items.mul(e.percent),n.key,e.step.belts==null?null:e.step.belts.mul(e.percent),l.itemsState()[e.step.itemId].beltId,e.step.wagons==null?null:e.step.wagons.mul(e.percent),l.itemsState()[e.step.itemId].wagonId,e.percent,o.recipeId,o.recipeObjectiveId]))}}function wa(t,i){if(t&1&&c(0,Ia,1,16,"ng-container")(1,Ta,1,12,"ng-container"),t&2){let e,n=a(),o=a(7);d((e=o.stepDetails()[n.step.id].outputs.length===1&&o.stepDetails()[n.step.id].outputs[0])?0:1,e)}}function ya(t,i){if(t&1&&c(0,wa,2,1),t&2){let e=i;d(e.step.itemId&&e.percent?0:-1)}}function Ea(t,i){if(t&1&&c(0,ya,1,1),t&2){let e,n=i.$implicit,o=a(4),l=a(2);d((e=W(1,Dt,l.stepByItemEntities()[n.key],(e=l.stepByItemEntities()[n.key].parents)==null?null:e[o.id]))?0:-1,e)}}function ka(t,i){if(t&1&&(_(0,"tr",106),c(1,va,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()(),A(5,Ea,1,4,null,null,K),r(7,"keyvalue")),t&2){let e=a(3),n=a(2),o=b(9);p(),C("ngTemplateOutlet",o),p(2),P(" ",x(4,2,"steps.inputs")," "),p(2),N(y(7,4,e.recipe.in,n.trackSvc.sortByValue))}}function Ba(t,i){t&1&&j(0)}function Ma(t,i){t&1&&j(0)}function Oa(t,i){t&1&&j(0)}function Fa(t,i){t&1&&j(0)}function Ra(t,i){if(t&1&&c(0,Fa,1,0,"ng-container",116),t&2){let e=a(),n=a().$implicit,o=a(3),l=a(2),m=b(11);C("ngTemplateOutlet",m)("ngTemplateOutletContext",tt(2,$n,[e.step.items==null?null:e.step.items.mul(e.percent),n.key,e.step.belts==null?null:e.step.belts.mul(e.percent),l.itemsState()[e.step.itemId].beltId,e.step.wagons==null?null:e.step.wagons.mul(e.percent),l.itemsState()[e.step.itemId].wagonId,o.machines,o.recipeSettings==null?null:o.recipeSettings.machineId,o.recipeId,o.recipeObjectiveId,e.percent,n.key,o.recipeObjectiveId]))}}function Va(t,i){if(t&1&&c(0,Ra,1,16,"ng-container"),t&2){let e=i;d(e.step.itemId&&e.percent?0:-1)}}function Pa(t,i){if(t&1&&c(0,Va,1,1),t&2){let e,n=i.$implicit,o=a(3),l=a(2);d((e=W(1,Dt,l.stepByItemEntities()[n.key],o.outputs==null?null:o.outputs[n.key]))?0:-1,e)}}function ja(t,i){if(t&1&&(c(0,Sa,8,7)(1,ka,8,7),r(2,"keyvalue"),_(3,"tr",106),c(4,Ba,1,0,"ng-container",114),_(5,"td",115),S(6),r(7,"translate"),s()(),_(8,"tr",106),c(9,Ma,1,0,"ng-container",114),_(10,"td",117)(11,"span",67),S(12),r(13,"rate"),s()(),_(14,"td",118)(15,"div",45),u(16,"i",119),s()(),u(17,"td",18),s(),_(18,"tr",106),c(19,Oa,1,0,"ng-container",114),_(20,"td",115),S(21),r(22,"translate"),s()(),A(23,Pa,1,4,null,null,K),r(25,"keyvalue")),t&2){let e=a(2),n=a(2),o=b(9);d(n.data().game===n.Game.Factorio&&e.recipe.isMining?0:-1),p(),d(x(2,8,e.recipe.in).length?1:-1),p(3),C("ngTemplateOutlet",o),p(2),P(" ",x(7,10,"steps.time")," "),p(3),C("ngTemplateOutlet",o),p(3),E(y(13,12,e.recipe.time,n.columnsState().items.precision)),p(7),C("ngTemplateOutlet",o),p(2),P(" ",x(22,15,"steps.outputs")," "),p(2),N(y(25,17,e.recipe.out,n.trackSvc.sortByValue))}}function $a(t,i){if(t&1&&c(0,ja,26,20),t&2){let e=a();d(e.recipe?0:-1)}}function Da(t,i){t&1&&j(0)}function La(t,i){if(t&1&&(c(0,Da,1,0,"ng-container",116),r(1,"rate")),t&2){let e=a(2),n=a().$implicit;a();let o=b(28),l=a(2),m=a(2);C("ngTemplateOutlet",o)("ngTemplateOutletContext",W(5,lt,y(1,2,e.step.items.mul(e.percent).div(l.machines),m.columnsState().items.precision),n.key))}}function Aa(t,i){t&1&&j(0)}function Na(t,i){if(t&1&&(c(0,Aa,1,0,"ng-container",116),r(1,"rate")),t&2){let e=a(4);a(2);let n=b(28),o=a(2),l=a(2);C("ngTemplateOutlet",n)("ngTemplateOutletContext",W(5,lt,y(1,2,e.step.belts.mul(e.percent).div(o.machines),l.columnsState().belts.precision),i))}}function Ua(t,i){if(t&1&&c(0,Na,2,8,"ng-container"),t&2){let e,n=a(4).$implicit,o=a(5);d((e=o.itemsState()[n.key].beltId)?0:-1,e)}}function Wa(t,i){if(t&1&&(_(0,"td"),c(1,Ua,1,1),s()),t&2){let e=a(2);p(),d(e.step.belts?1:-1)}}function Ha(t,i){t&1&&j(0)}function za(t,i){if(t&1&&(c(0,Ha,1,0,"ng-container",116),r(1,"rate")),t&2){let e=i;a(6);let n=b(28);C("ngTemplateOutlet",n)("ngTemplateOutletContext",W(5,lt,y(1,2,e.value,1),e.id))}}function Ga(t,i){if(t&1&&(c(0,za,2,8,"ng-container"),r(1,"inserterSpeed")),t&2){let e,n=a(3),o=a(4),l=a(2);d((e=y(1,1,n.step.items.mul(n.percent).div(o.machines).div(l.dispRateInfo().value),l.settings()))?0:-1,e)}}function qa(t,i){if(t&1&&(_(0,"td"),c(1,Ga,2,4),s()),t&2){let e=a(2),n=a().$implicit,o=a(5);p(),d(o.itemsState()[n.key].beltId!==o.ItemId.Pipe&&e.step.items?1:-1)}}function Ja(t,i){if(t&1&&(_(0,"tr")(1,"td"),c(2,La,2,8,"ng-container"),s(),c(3,Wa,2,1,"td")(4,qa,2,1,"td"),s()),t&2){let e=a(),n=a(6);p(2),d(e.step.items?2:-1),p(),d(n.columnsState().belts.show?3:-1),p(),d(n.data().game===n.Game.Factorio?4:-1)}}function Ka(t,i){t&1&&c(0,Ja,5,3,"tr"),t&2&&d(i.percent?0:-1)}function Xa(t,i){if(t&1&&c(0,Ka,1,1),t&2){let e,n=i.$implicit,o=a(3),l=a(2);d((e=W(1,Dt,l.stepByItemEntities()[n.key],(e=l.stepByItemEntities()[n.key].parents)==null?null:e[o.id]))?0:-1,e)}}function Qa(t,i){t&1&&u(0,"i",122)}function Ya(t,i){if(t&1&&u(0,"lab-tooltip",65),t&2){let e=a(4);C("id",e.recipeId)}}function Za(t,i){if(t&1&&u(0,"lab-tooltip",87),t&2){let e=a();C("id",e)}}function tl(t,i){if(t&1&&(_(0,"div",24)(1,"i",64),r(2,"iconClass"),c(3,Ya,1,1,"ng-template",null,5,k),s(),_(5,"i",64),r(6,"iconClass"),c(7,Za,1,1,"ng-template",null,5,k),s()()),t&2){let e=b(4),n=a(3);p(),O(y(2,6,n.recipeId,"recipe")),C("pTooltip",e),p(4),O(x(6,9,i)),C("pTooltip",e)}}function el(t,i){t&1&&j(0)}function nl(t,i){if(t&1&&(c(0,el,1,0,"ng-container",116),r(1,"rate")),t&2){let e=i;a(5);let n=b(28);C("ngTemplateOutlet",n)("ngTemplateOutletContext",W(5,lt,y(1,2,e.value,1),e.id))}}function il(t,i){if(t&1&&(c(0,nl,2,8,"ng-container"),r(1,"inserterSpeed")),t&2){let e,n=a(2),o=a(6);d((e=y(1,1,n,o.settings()))?0:-1,e)}}function ol(t,i){if(t&1&&(_(0,"td"),c(1,il,2,4),s()),t&2){let e=a(2).$implicit,n=a(5);p(),d(n.itemsState()[e.key].beltId!==n.ItemId.Pipe?1:-1)}}function al(t,i){t&1&&j(0)}function ll(t,i){if(t&1&&(c(0,al,1,0,"ng-container",116),r(1,"rate")),t&2){let e=i,n=a(2);a(2);let o=b(28),l=a(4);C("ngTemplateOutlet",o)("ngTemplateOutletContext",W(5,lt,y(1,2,n.div(l.beltSpeed()[e]),l.columnsState().belts.precision),e))}}function pl(t,i){if(t&1&&(_(0,"td"),c(1,ll,2,8,"ng-container"),s()),t&2){let e,n=a(2).$implicit,o=a(5);p(),d((e=o.itemsState()[n.key].beltId)?1:-1,e)}}function _l(t,i){t&1&&j(0)}function sl(t,i){if(t&1&&(_(0,"tr"),c(1,ol,2,1,"td")(2,pl,2,1,"td"),_(3,"td"),c(4,_l,1,0,"ng-container",116),r(5,"rate"),s()()),t&2){let e=a().$implicit;a();let n=b(28),o=a(4);p(),d(o.data().game===o.Game.Factorio?1:-1),p(),d(o.columnsState().belts.show?2:-1),p(2),C("ngTemplateOutlet",n)("ngTemplateOutletContext",W(7,lt,y(5,4,i.mul(o.dispRateInfo().value),o.columnsState().items.precision),e.key))}}function cl(t,i){if(t&1&&c(0,sl,6,10,"tr"),t&2){let e,n=i.$implicit,o=a(3);d((e=n.value.div(o.recipe.time))?0:-1,e)}}function rl(t,i){if(t&1&&u(0,"lab-tooltip",63),t&2){let e=a().itemId;C("id",e)}}function dl(t,i){if(t&1&&(_(0,"div",40)(1,"span",67),S(2),s(),_(3,"i",64),r(4,"iconClass"),c(5,rl,1,1,"ng-template",null,5,k),s()()),t&2){let e=i.value,n=i.itemId,o=b(6);p(2),E(e),p(),O(x(4,4,n)),C("pTooltip",o)}}function ml(t,i){if(t&1&&(_(0,"div",24)(1,"table",121),A(2,Xa,1,4,null,null,K),r(4,"keyvalue"),s(),c(5,Qa,1,0,"i",122),r(6,"keyvalue"),_(7,"table",121)(8,"tr")(9,"td",117)(10,"span",67),S(11),r(12,"rate"),s()(),_(13,"td"),c(14,tl,9,11,"div",24),s()(),_(15,"tr")(16,"td",117)(17,"span",67),S(18),r(19,"rate"),s()(),_(20,"td"),u(21,"i",119),s()()(),u(22,"i",122),_(23,"table",121),A(24,cl,1,1,null,null,K),r(26,"keyvalue"),s(),c(27,dl,7,6,"ng-template",null,10,k),s()),t&2){let e,n=a(2),o=a(2);p(2),N(y(4,4,n.recipe.in,o.trackSvc.sortByValue)),p(3),d(x(6,7,n.recipe.in).length?5:-1),p(6),E(y(12,9,o.rational.one,o.columnsState().machines.precision)),p(3),d((e=n.recipeSettings==null?null:n.recipeSettings.machineId)?14:-1,e),p(4),E(y(19,12,o.dispRateInfo().value,o.columnsState().machines.precision)),p(6),N(y(26,15,n.recipe.out,o.trackSvc.sortByValue))}}function Cl(t,i){t&1&&(u(0,"small",120),r(1,"translate")),t&2&&C("innerHTML",x(1,1,"steps.inserterCountInfo"),ne)}function ul(t,i){if(t&1&&(_(0,"tr",106),u(1,"td"),_(2,"td",18),c(3,ml,29,18,"div",24)(4,Cl,2,3,"small",120),s()()),t&2){let e=a(),n=a(2);p(3),d(e.recipeId&&e.recipe&&e.machines?3:-1),p(),d(n.data().game===n.Game.Factorio?4:-1)}}function fl(t,i){if(t&1&&u(0,"lab-tooltip",65),t&2){let e=a().$implicit;C("id",e)}}function xl(t,i){if(t&1){let e=R();_(0,"button",128),r(1,"iconSmClass"),F("click",function(){let o=B(e).$implicit,l=a(5);return M(l.changeRecipesExcluded([o],!l.settings().excludedRecipeIds.has(o)))}),u(2,"i",62),c(3,fl,1,1,"ng-template",null,5,k),s()}if(t&2){let e=i.$implicit,n=b(4),o=a(5);Z("hover-active",o.settings().excludedRecipeIds.has(e)),C("icon",y(1,4,e,"recipe"))("pTooltip",n)}}function gl(t,i){if(t&1){let e=R();_(0,"tr",106),u(1,"td"),_(2,"td",18)(3,"div")(4,"div",123),S(5),r(6,"translate"),s(),_(7,"div",124)(8,"small"),S(9),r(10,"translate"),s()(),_(11,"p-checkbox",125),r(12,"translate"),F("onChange",function(){let o=B(e),l=a(4);return M(l.changeRecipesExcluded(o.recipeIds,o.allRecipesIncluded))}),s()()()(),_(13,"tr",106),u(14,"td"),_(15,"td",18)(16,"div",126),A(17,xl,5,7,"button",127,le),s()()()}if(t&2){let e=i;p(5),P(" ",x(6,5,"steps.includedRecipes")," "),p(4),E(x(10,7,"steps.includedRecipesInfo")),p(2),C("ngModel",e.allRecipesIncluded)("binary",!0)("label",x(12,9,"picker.includeAll")),p(6),N(e.recipeIds)}}function Sl(t,i){if(t&1&&c(0,gl,19,11),t&2){let e,n=a(),o=a(2);d((e=n.itemId&&o.stepDetails()[n.id])?0:-1,e)}}function vl(t,i){if(t&1){let e=R();_(0,"tr",106)(1,"td",107)(2,"a",108),u(3,"button",109),s()(),_(4,"td",18)(5,"p-tabMenu",110,9),r(7,"stepId"),F("activeItemChange",function(o){let l=B(e),m=a(2);return M(m.setActiveItem(l,o))}),c(8,na,5,6,"ng-template",73),s()()(),c(9,ma,7,5)(10,$a,1,1)(11,ul,5,2,"tr",106)(12,Sl,1,1)}if(t&2){let e,n=i,o=b(6),l=a(2);p(2),C("relativeTo",l.route)("fragment",n.id),p(3),C("model",l.stepDetails()[n.id].tabs)("activeItem",l.activeItem[x(7,5,n)]),p(4),d((e=o.activeItem==null?null:o.activeItem.label)===l.StepDetailTab.Item?9:e===l.StepDetailTab.Recipe?10:e===l.StepDetailTab.Machine?11:e===l.StepDetailTab.Recipes?12:-1)}}function hl(t,i){if(t&1&&(c(0,vl,13,7),r(1,"asStep")),t&2){let e,n=i.$implicit;d((e=x(1,1,n))?0:-1,e)}}function Il(t,i){t&1&&(_(0,"tr")(1,"td",18)(2,"div",52)(3,"span"),S(4),r(5,"translate"),s()()()()),t&2&&(p(4),E(x(5,1,"steps.emptyMessage")))}function bl(t,i){if(t&1&&c(0,Il,6,3,"tr"),t&2){let e=a();d(e.focus()?0:-1)}}function Tl(t,i){t&1&&u(0,"td",31)}function wl(t,i){t&1&&u(0,"td")}function yl(t,i){t&1&&u(0,"td")}function El(t,i){if(t&1&&c(0,wl,1,0,"td")(1,yl,1,0,"td"),t&2){let e=a(2);d(e.columnsState().checkbox.show?0:-1),p(),d(e.columnsState().tree.show?1:-1)}}function kl(t,i){if(t&1&&(u(0,"td"),c(1,El,2,2)),t&2){let e=a();p(),d(e.focus()?-1:1)}}function Bl(t,i){t&1&&j(0)}function Ml(t,i){if(t&1&&u(0,"lab-tooltip",63),t&2){let e=a(2).itemId;C("id",e)}}function Ol(t,i){if(t&1&&u(0,"lab-tooltip",76),t&2){let e=a(3).beltId;C("id",e)}}function Fl(t,i){if(t&1&&(_(0,"td",117)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",118)(5,"div",45)(6,"i",64),r(7,"iconClass"),c(8,Ol,1,1,"ng-template",null,5,k),s()()()),t&2){let e=b(9),n=a(2),o=n.belts,l=n.beltId,m=a();p(2),E(y(3,4,o,m.columnsState().belts.precision)),p(4),O(x(7,7,l)),C("pTooltip",e)}}function Rl(t,i){if(t&1&&u(0,"lab-tooltip",78),t&2){let e=a(4).wagonId;C("id",e)}}function Vl(t,i){if(t&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Rl,1,1,"ng-template",null,5,k),s()),t&2){let e=b(3),n=a(3).wagonId;O(x(1,3,n)),C("pTooltip",e)}}function Pl(t,i){if(t&1&&u(0,"lab-tooltip",79),t&2){let e=a(4).wagonId;C("id",e)}}function jl(t,i){if(t&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Pl,1,1,"ng-template",null,5,k),s()),t&2){let e=b(3),n=a(3).wagonId;O(x(1,3,n)),C("pTooltip",e)}}function $l(t,i){if(t&1&&(_(0,"td",117)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",118)(5,"div",45),c(6,Vl,4,5,"i",58)(7,jl,4,5,"i",58),s()()),t&2){let e=a(2),n=e.wagons,o=e.wagonId,l=a();p(2),E(y(3,2,n,l.columnsState().wagons.precision)),p(4),d(l.data().cargoWagonIds.indexOf(o)!==-1?6:7)}}function Dl(t,i){if(t&1&&(_(0,"span",67),S(1),r(2,"machineRate"),s()),t&2){let e=a(2),n=e.machines,o=e.machineId,l=a();p(),E(_t(2,1,n,l.columnsState().machines.precision,o))}}function Ll(t,i){t&1&&(_(0,"div",130),S(1),r(2,"translate"),s()),t&2&&(p(),P(" ",x(2,1,"steps.inputs")," "))}function Al(t,i){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(3).recipeObjectiveId;p(),P("#",e,"")}}function Nl(t,i){if(t&1&&u(0,"lab-tooltip",65),t&2){let e=a(3).recipeId;C("id",e)}}function Ul(t,i){if(t&1&&u(0,"lab-tooltip",87),t&2){let e=a(3).machineId;C("id",e)}}function Wl(t,i){if(t&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Al,2,1,"span")(3,Nl,1,1,"ng-template",null,5,k),s(),_(5,"i",64),r(6,"iconClass"),c(7,Ul,1,1,"ng-template",null,5,k),s()),t&2){let e=b(4),n=a(2),o=n.machineId,l=n.recipeId,m=n.recipeObjectiveId;O(y(1,7,l,"recipe")),C("pTooltip",e),p(2),d(m?2:-1),p(3),O(x(6,10,o)),C("pTooltip",e)}}function Hl(t,i){t&1&&(S(0),r(1,"translate")),t&2&&P(" ",x(1,1,"steps.inputs")," ")}function zl(t,i){if(t&1&&(_(0,"div",131),c(1,Hl,2,3),s()),t&2){let e=a(2).inputs;p(),d(e?1:-1)}}function Gl(t,i){t&1&&u(0,"i",132)}function ql(t,i){t&1&&u(0,"i",132)}function Jl(t,i){if(t&1&&(_(0,"span"),S(1),s()),t&2){let e=a(4).destRecipeObjectiveId;p(),P("#",e,"")}}function Kl(t,i){if(t&1&&u(0,"lab-tooltip",133),t&2){let e=a(4),n=e.destId,o=e.destIsRecipe;C("id",n)("type",o?"recipe":"item")}}function Xl(t,i){if(t&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Jl,2,1,"span")(3,Kl,1,2,"ng-template",null,5,k),s()),t&2){let e=b(4),n=a(3),o=n.destId,l=n.destRecipeObjectiveId,m=n.destIsRecipe;O(y(1,4,o,m?"recipe":"item")),C("pTooltip",e),p(2),d(l?2:-1)}}function Ql(t,i){t&1&&(_(0,"span"),S(1),r(2,"translate"),s()),t&2&&(p(),P(" ",x(2,1,"steps.outputs")," "))}function Yl(t,i){if(t&1&&(c(0,Gl,1,0,"i",132),_(1,"span",67),S(2),r(3,"rate"),r(4,"leftPad"),s(),c(5,ql,1,0,"i",132)(6,Xl,5,7,"i",58)(7,Ql,3,3,"span")),t&2){let e=a(2),n=e.percent,o=e.percentOnDest,l=e.destId,m=e.outputs;d(o?0:-1),p(2),P("",x(4,8,y(3,5,n,-2)),"%"),p(3),d(o?-1:5),p(),d(l?6:-1),p(),d(m?7:-1)}}function Zl(t,i){if(t&1&&(c(0,Bl,1,0,"ng-container",114),_(1,"td",117)(2,"span",67),S(3),r(4,"rate"),s()(),_(5,"td",118)(6,"div",45)(7,"i",64),r(8,"iconClass"),c(9,Ml,1,1,"ng-template",null,5,k),s()()(),c(11,Fl,10,9)(12,$l,8,5),_(13,"td",117),c(14,Dl,3,5,"span",67),r(15,"machineShowRate"),s(),_(16,"td",129)(17,"div",24),c(18,Ll,3,3,"div",130)(19,Wl,9,12),r(20,"machineShow"),c(21,zl,2,1,"div",131)(22,Yl,8,10),s()()),t&2){let e=b(10),n=a(),o=n.items,l=n.itemId,m=n.belts,f=n.beltId,g=n.wagons,T=n.wagonId,I=n.machines,w=n.machineId,V=n.percent,$=n.inputs,U=a(),z=b(9);C("ngTemplateOutlet",z),p(3),E(y(4,11,o,U.columnsState().items.precision)),p(4),O(x(8,14,l)),C("pTooltip",e),p(4),d(U.columnsState().belts.show&&m&&f?11:-1),p(),d(U.columnsState().wagons.show&&g&&T?12:-1),p(2),d(I&&I.nonzero()&&y(15,16,w,U.data().game)?14:-1),p(4),d($?18:-1),p(),d(y(20,19,w,U.data().game)?19:21),p(3),d(V?22:-1)}}function tp(t,i){if(t&1&&(_(0,"tr",106),c(1,Zl,23,22),s()),t&2){let e=i.itemId;p(),d(e?1:-1)}}function ep(t,i){t&1&&u(0,"td")}function np(t,i){t&1&&u(0,"td")}function ip(t,i){t&1&&j(0)}function op(t,i){t&1&&j(0)}function ap(t,i){t&1&&j(0)}function lp(t,i){t&1&&j(0)}function pp(t,i){if(t&1&&(_(0,"td",134)(1,"span",67),S(2),r(3,"power"),s()()),t&2){let e=a(3);p(2),E(_t(3,1,e.totals().power,e.columnsState().power.precision,e.effectivePowerUnit()))}}function _p(t,i){if(t&1&&(_(0,"td",134)(1,"span",67),S(2),r(3,"rate"),s()()),t&2){let e=a(3);p(2),E(y(3,1,e.totals().pollution,e.columnsState().pollution.precision))}}function sp(t,i){t&1&&u(0,"td")}function cp(t,i){if(t&1&&(_(0,"tr"),u(1,"td"),c(2,ep,1,0,"td")(3,np,1,0,"td"),_(4,"td",31),S(5),r(6,"translate"),s(),c(7,ip,1,0,"ng-container",116)(8,op,1,0,"ng-container",116)(9,ap,1,0,"ng-container",116)(10,lp,1,0,"ng-container",116)(11,pp,4,5,"td",134)(12,_p,4,4,"td",134)(13,sp,1,0,"td"),s()),t&2){a();let e=b(2),n=a();p(2),d(n.columnsState().checkbox.show?2:-1),p(),d(n.columnsState().tree.show?3:-1),p(2),P(" ",x(6,14,"steps.total")," "),p(2),C("ngTemplateOutlet",e)("ngTemplateOutletContext",W(16,Dn,n.columnsState().belts,n.totals().belts)),p(),C("ngTemplateOutlet",e)("ngTemplateOutletContext",W(19,Ln,n.columnsState().wagons,n.totals().wagons)),p(),C("ngTemplateOutlet",e)("ngTemplateOutletContext",At(22,An,n.columnsState().machines,n.totals().machines,n.totals().modules)),p(),C("ngTemplateOutlet",e)("ngTemplateOutletContext",At(26,Nn,n.columnsState().beacons,n.totals().beacons,n.totals().beaconModules)),p(),d(n.columnsState().power.show?11:-1),p(),d(n.columnsState().pollution.show?12:-1),p(),d(n.columnsState().link.show?13:-1)}}function rp(t,i){if(t&1&&(_(0,"div",136)(1,"span",67),S(2),r(3,"rate"),s()()),t&2){let e=i.$implicit,n=a(2).columnSettings;p(2),E(y(3,1,e.value,n.precision))}}function dp(t,i){if(t&1&&u(0,"lab-tooltip",133),t&2){let e=a(2).$implicit,n=a(2).type;C("id",e.key)("type",n)}}function mp(t,i){if(t&1&&(_(0,"i",141),r(1,"iconClass"),c(2,dp,1,2,"ng-template",null,5,k),s()),t&2){let e=b(3),n=a().$implicit;O(x(1,3,n.key)),C("pTooltip",e)}}function Cp(t,i){if(t&1&&u(0,"lab-tooltip",65),t&2){let e=a(2).$implicit;C("id",e.key)}}function up(t,i){if(t&1&&(_(0,"i",141),r(1,"iconClass"),c(2,Cp,1,1,"ng-template",null,5,k),s()),t&2){let e=b(3),n=a().$implicit;O(y(1,3,n.key,"recipe")),C("pTooltip",e)}}function fp(t,i){if(t&1&&c(0,mp,4,5,"i",140)(1,up,4,6,"i",140),t&2){let e=i.$implicit,n=a(4);d(n.data().itemEntities[e.key]?0:1)}}function xp(t,i){if(t&1&&u(0,"lab-tooltip",93),t&2){let e=a().$implicit;C("id",e.key)}}function gp(t,i){if(t&1&&(_(0,"div",142)(1,"span",67),S(2),s()(),_(3,"i",141),r(4,"iconClass"),c(5,xp,1,1,"ng-template",null,5,k),s()),t&2){let e=i.$implicit,n=b(6);p(2),E(e.value),p(),O(y(4,4,e.key,"item")),C("pTooltip",e.key!=="module"?n:void 0)}}function Sp(t,i){if(t&1&&(_(0,"td",135),A(1,rp,4,4,"div",136,K),r(3,"keyvalue"),s(),_(4,"td",137)(5,"div",45)(6,"div",138),A(7,fp,2,1,null,null,K),r(9,"keyvalue"),s(),_(10,"div",139),A(11,gp,7,7,null,null,K),r(13,"keyvalue"),s()()()),t&2){let e=a(),n=e.totals,o=e.modulesTotals,l=a(2);p(),N(y(3,0,n,l.trackSvc.sortByValue)),p(6),N(y(9,3,n,l.trackSvc.sortByValue)),p(4),N(y(13,6,o,l.trackSvc.sortByValue))}}function vp(t,i){if(t&1&&c(0,Sp,14,9),t&2){let e=i.columnSettings;d(e.show?0:-1)}}function hp(t,i){if(t&1&&c(0,cp,14,30,"tr")(1,vp,1,1,"ng-template",null,11,k),t&2){let e=a();d(e.focus()?-1:0)}}var Rs=(()=>{let i=class i{constructor(){this.document=D(re),this.route=D(ue),this.ref=D(se),this.contentSvc=D(ve),this.exportSvc=D(Ke),this.itemsSvc=D(wt),this.machinesSvc=D(Te),this.objectivesSvc=D(Ee),this.preferencesSvc=D(Tt),this.recipesSvc=D(at),this.routerSvc=D(yt),this.settingsSvc=D(ot),this.trackSvc=D(Ne),this.focus=Lt(!1),this.selectedId=Lt(),this.stepsTable=ie.required("stepsTable"),this.itemsState=this.itemsSvc.itemsState,this.itemsModified=this.itemsSvc.itemsModified,this.machinesState=this.machinesSvc.machinesState,this.recipesModified=this.objectivesSvc.recipesModified,this.stepsModified=this.objectivesSvc.stepsModified,this.stepTree=this.objectivesSvc.stepTree,this.stepDetails=this.objectivesSvc.stepDetails,this.stepById=this.objectivesSvc.stepById,this.stepByItemEntities=this.objectivesSvc.stepByItemEntities,this.effectivePowerUnit=this.objectivesSvc.effectivePowerUnit,this.totals=this.objectivesSvc.totals,this.settings=this.settingsSvc.settings,this.dispRateInfo=this.settingsSvc.displayRateInfo,this.beltSpeed=this.settingsSvc.beltSpeed,this.options=this.settingsSvc.options,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset,this.preferences=this.preferencesSvc.state,this._steps=this.objectivesSvc.steps,this.steps=ce(()=>{let n=[...this._steps()];if(!this.focus())return n;let l=this.selectedId();return n.filter(m=>m.id===l)}),this.activeItemsEffect=Nt(()=>{let n=this.steps(),o=this.stepDetails();this.setActiveItems(n,o)}),this.toggleEffect=Nt(()=>{let n=this.focus(),o=this.steps()[0];n&&o&&(this.stepsTable().toggleRow(o),this.expandRow(o,!1))}),this.sortSteps$=new Kt(null),this.activeItem={},this.stepDetailTab=he("stepDetailTab"),this.stepDetailIcon=ye,this.ItemId=h,this.StepDetailTab=we,this.Game=nt,this.ObjectiveUnit=be,this.rational=v,Xt([this.sortSteps$.pipe(Zt()),ge(this._steps)]).pipe(xe()).subscribe(([[n,o],l])=>{this.sortSteps(n,o,l)})}ngOnInit(){this.route.fragment.pipe(Yt(),Qt(n=>n!=null)).subscribe(n=>{this.fragmentId=n})}ngAfterViewInit(){this.loadFragmentId()}loadFragmentId(){if(this.fragmentId)try{let n=this.fragmentId,[o,l,m]=n.split("_"),f=this.steps(),g=this.stepDetails(),T=f.find(w=>w.id===l);if(T==null||!g[T.id].tabs.length)return;this.stepsTable().toggleRow(T),setTimeout(()=>{if(m){let w=this.document.querySelector(`#${n}`);w&&w.click()}else this.document.querySelector(`#${n}`)?.scrollIntoView()},10)}catch{}}sortSteps(n,o,l){if(o?.order==null||o.field==null)return;let m=o.order,f=o.field;if(n!=null&&n.field===f&&n.order!==m&&m===-1&&this.stepsTable!=null){o.data?.sort((g,T)=>l.indexOf(g)-l.indexOf(T)),this.stepsTable().sortOrder=0,this.stepsTable().sortField="",this.stepsTable().reset(),this.sortSteps$.next(null);return}o.data?.sort((g,T)=>(g[f]??v(0n)).sub(T[f]??v(0n)).toNumber()*m)}setActiveItems(n,o){n.forEach(l=>{this.updateActiveItem(l,o,!1)})}expandRow(n,o){o||this.updateActiveItem(n,this.stepDetails(),!0)}updateActiveItem(n,o,l){let m=ct.transform(n),f=this._getActiveItem(n,m,o,l);if(f){let g=ct.transform(n);this.activeItem[g]=f}}_getActiveItem(n,o,l,m){let f=this.activeItem[o],g=l[n.id];if(g==null)return null;if(f!=null){let I=g.tabs.find(w=>w.label===f.label);if(I!=null)return I}if(f==null&&!m)return null;let T=this.stepDetailTab();if(T){let I=g.tabs.find(w=>w.label===T);if(I!=null)return I}return g.tabs[0]}setActiveItem(n,o){if(o==null)return;let l=ct.transform(n);this.activeItem[l]=o,this.stepDetailTab.set(o.label)}resetStep(n){n.itemId&&this.itemsSvc.resetId(n.itemId),n.recipeObjectiveId?this.objectivesSvc.updateEntity(n.recipeObjectiveId,{machineId:void 0,fuelId:void 0,modules:void 0,beacons:void 0,overclock:void 0}):n.recipeId&&this.recipesSvc.resetId(n.recipeId)}changeItemExcluded(n,o){let l=et(n,o,this.settings().excludedItemIds);this.settingsSvc.apply({excludedItemIds:l})}changeRecipesExcluded(n,o){let l=et(n,o,this.settings().excludedRecipeIds),m=new Set(X(this.data().defaults?.excludedRecipeIds,[]));this.settingsSvc.updateField("excludedRecipeIds",l,m)}changeRecipeField(n,o,l){if(n.recipeId==null)return;let m=n.recipeSettings;if(m?.machineId==null)return;let f=n.recipeObjectiveId??n.recipeId,g=n.recipeObjectiveId!=null?this.objectivesSvc.updateEntityField.bind(this):this.recipesSvc.updateEntityField.bind(this),T=this.machinesState(),I=this.settings(),w=T[m.machineId];switch(l){case"machine":{if(typeof o!="string")return;let V=this.data(),$=it.bestMatch(V.recipeEntities[n.recipeId].producers,I.machineRankIds);g(f,"machineId",o,$);break}case"fuel":{if(typeof o!="string")return;g(f,"fuelId",o,w.fuelId);break}case"modules":{if(!Array.isArray(o))return;o=o;let V=this.data().machineEntities[m.machineId],$=it.dehydrateModules(o,X(m.moduleOptions,[]),I.moduleRankIds,V.modules,w.modules);g(f,"modules",$);break}case"beacons":{if(!Array.isArray(o))return;o=o;let V=w.beacons,$=it.dehydrateBeacons(o,V);g(f,"beacons",$);break}case"overclock":{if(typeof o!="number")return;let V=w.overclock;g(f,"overclock",v(o),V);break}}}changeStepChecked(n,o){if(n.itemId!=null){let l=et(n.itemId,o,this.settings().checkedItemIds);this.settingsSvc.apply({checkedItemIds:l})}else if(n.recipeObjectiveId!=null){let l=et(n.recipeObjectiveId,o,this.settings().checkedObjectiveIds);this.settingsSvc.apply({checkedObjectiveIds:l})}else if(n.recipeId!=null){let l=et(n.recipeId,o,this.settings().checkedRecipeIds);this.settingsSvc.apply({checkedRecipeIds:l})}}resetChecked(){this.settingsSvc.apply({checkedItemIds:new Set,checkedObjectiveIds:new Set,checkedRecipeIds:new Set})}resetExcludedItems(n){this.settingsSvc.apply({excludedItemIds:new Set}),n.stopImmediatePropagation()}resetBelts(n){this.itemsSvc.resetFields("beltId"),n.stopImmediatePropagation()}resetWagons(n){this.itemsSvc.resetFields("wagonId"),n.stopImmediatePropagation()}resetMachines(n){let o=["machineId","overclock","modules","beacons"];this.objectivesSvc.resetFields(...o),this.recipesSvc.resetFields(...o),n.stopImmediatePropagation()}resetBeacons(){this.objectivesSvc.resetFields("beacons"),this.recipesSvc.resetFields("beacons")}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=dt({type:i,selectors:[["lab-steps"]],viewQuery:function(o,l){o&1&&pe(l.stepsTable,Mn,5),o&2&&_e()},inputs:{focus:[1,"focus"],selectedId:[1,"selectedId"]},standalone:!0,features:[xt],decls:15,vars:10,consts:[["stepsTable",""],["emptyCol2",""],["leftPad",""],["detailRow",""],["columnsDlg",""],["tooltip",""],["overclockInput",""],["modulePicker",""],["beaconsOverlay",""],["expandTabMenu",""],["machineValueCell",""],["totalCell",""],["dataKey","id","styleClass","p-datatable-sm",3,"rowsChange","sortFunction","rowTrackBy","value","customSort","rowExpandMode","defaultSortOrder","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],["pTemplate","footer"],["colspan","100"],[1,"d-flex","gap-2","py-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-table-columns",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"label"],[1,"column-header-row"],["colspan","2","pSortableColumn","items"],[1,"d-flex","align-items-center"],["field","items"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"pTooltip"],["colspan","2","pSortableColumn","belts"],["colspan","2","pSortableColumn","wagons"],["colspan","2","pSortableColumn","machines"],["field","machines"],["colspan","2"],["pSortableColumn","power"],["pSortableColumn","pollution"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"click","label"],[1,"d-flex","align-items-center","justify-content-center"],[1,"fa-solid","fa-square-check"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"click","pTooltip"],["field","belts"],["field","wagons"],[1,"d-flex","align-items-center","justify-content-end"],["field","power"],["field","pollution"],[1,"w-0","px-0","px-sm-1"],[1,"fragment",3,"id"],[1,"d-flex"],["pButton","","pRipple","","type","button","icon","fa-solid fa-angle-right",1,"p-button-text","p-button-rounded","transition-ease",3,"click","pTooltip","pRowToggler"],[1,"px-0","px-sm-2"],[1,"overflow-hidden","px-0","px-sm-1","py-0"],["colspan","2",1,"px-0","px-sm-2"],[1,"px-0","px-sm-2","text-end"],[1,"w-0","px-0","ps-sm-1"],[1,"d-flex","justify-content-center"],[3,"onChange","binary","ngModel"],[1,"d-flex","align-items-center","links"],[1,"indent"],[1,"icon"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"hover-active","icon","pTooltip"],[3,"class","pTooltip"],[1,"connect",3,"trail","last"],[1,"connect"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","icon","pTooltip"],[1,"hover-icon","fa-solid","fa-eye-slash"],[3,"id"],[3,"pTooltip"],["type","recipe",3,"id"],[1,"w-0","px-0","px-sm-2","text-end"],[1,"monospace"],[1,"px-0","pe-sm-2"],[1,"find-text"],["labDropdownBase","icon",3,"pTooltip","ngModel","options"],["labDropdownBase","icon",3,"onChange","pTooltip","ngModel","options"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],["type","belt",3,"id"],["type","pipe",3,"id"],["type","cargo-wagon",3,"id"],["type","fluid-wagon",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"pTooltip"],["labDropdownBase","icon",3,"pTooltip","options","ngModel"],["suffix","%","inputStyleClass","text-end",3,"min","max","step","maxFractionDigits","size","pTooltip","ngModel"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","pTooltip"],[1,"p-button-icon"],[1,"hover-icon","fa-solid","fa-circle-plus"],["labDropdownBase","icon",3,"onChange","pTooltip","options","ngModel"],["type","machine",3,"id"],["suffix","%","inputStyleClass","text-end",3,"onBlur","min","max","step","maxFractionDigits","size","pTooltip","ngModel"],[1,"padded",3,"pTooltip"],["type","fuel",3,"id"],["labDropdownBase","icon","labNoDrag","",3,"pTooltip","ngModel","options"],["labDropdownBase","icon","labNoDrag","",3,"onChange","pTooltip","ngModel","options"],["type","module",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","modules","p-button-text",3,"click","pTooltip"],[1,"p-button-icon",3,"class"],[1,"hover-icon","fa-solid","fa-gear"],[3,"setValue"],["pButton","","pRipple","","type","button",1,"hover-action","icons","p-button-text","flex-column",3,"click","pTooltip"],[1,"p-button-icon","sum",3,"class"],[1,"p-button-icon","sum"],["type","beacon",3,"id"],["target","_blank","routerLink",".",1,"text-decoration-none",3,"queryParams"],["pButton","","pRipple","","type","button","icon","fa-solid fa-arrow-up-right-from-square","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"click","pTooltip"],[1,"detail"],[1,"px-1"],["routerLink",".","queryParamsHandling","preserve",1,"text-decoration-none",3,"relativeTo","fragment"],["pButton","","pRipple","","type","button","icon","fa-solid fa-link",1,"p-button-text","p-button-rounded"],[3,"activeItemChange","model","activeItem"],[1,"p-menuitem-link",3,"id"],[1,"p-menuitem-icon"],[1,"p-menuitem-text"],[4,"ngTemplateOutlet"],["colspan","100",1,"fw-bold"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-0","text-end"],[1,"ps-0"],[1,"lab-icon","time"],[3,"innerHTML"],[1,"mw-0"],[1,"fa-solid","fa-arrow-right","mx-3"],[1,"fw-bold"],[1,"mb-2"],[3,"onChange","ngModel","binary","label"],[1,"d-flex","flex-wrap"],["pButton","","pRipple","","type","button",1,"p-button-text","hover-action","me-2",3,"hover-active","icon","pTooltip"],["pButton","","pRipple","","type","button",1,"p-button-text","hover-action","me-2",3,"click","icon","pTooltip"],["colspan","100",1,"p-0"],[1,"position-absolute"],[1,"text-center",2,"width","68px"],[1,"m-1","p-2","fa-solid","fa-arrow-right"],[3,"id","type"],[1,"text-end","inherit"],[1,"w-0","text-end","inherit"],[1,"py-2","icon-height"],[1,"ps-0","inherit"],[1,"d-flex","flex-column","justify-content-center"],[1,"modules-column"],[1,"d-block",3,"class","pTooltip"],[1,"d-block",3,"pTooltip"],[1,"p-2","icon-height","text-end"]],template:function(o,l){if(o&1){let m=R();_(0,"p-table",12,0),F("rowsChange",function(g){return B(m),M(l.preferencesSvc.apply({rows:g}))})("sortFunction",function(g){return B(m),M(l.sortSteps$.next(g))}),c(2,si,30,22,"ng-template",13)(3,ea,2,3,"ng-template",14)(4,hl,2,3,"ng-template",15)(5,bl,1,1,"ng-template",16)(6,Tl,1,0,"ng-template",null,1,k)(8,kl,2,1,"ng-template",null,2,k)(10,tp,2,1,"ng-template",null,3,k)(12,hp,3,1,"ng-template",17),s(),u(13,"lab-columns",null,4)}o&2&&C("rowTrackBy",l.trackSvc.trackStep)("value",l.steps())("customSort",!0)("rowExpandMode",l.focus()?"single":"multiple")("defaultSortOrder",-1)("paginator",!l.focus()&&!l.preferences().disablePaginator)("rows",l.preferences().rows)("rowsPerPageOptions",Q(9,On))("showCurrentPageReport",!0)},dependencies:[me,Bt,Et,kt,Ce,de,fe,vt,St,gt,Ot,Mt,Oe,Me,Rt,Ft,Pt,Vt,Ue,He,We,Le,De,ke,Be,Xe,Ge,pn,ze,Ve,Pe,Ye,Ze,tn,en,nn,qe,Ae,on,an,q,ln,ct,$e,It],styles:[".links[_ngcontent-%COMP%]{height:50px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{position:relative;margin-left:16px;height:100vh}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%], .links[_ngcontent-%COMP%]   .connect.trail[_ngcontent-%COMP%]{border-left:2px dotted var(--text-color-secondary)}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%]:not(.trail){margin-bottom:50vh;height:50vh}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:24px}@media (max-width: 1199.98px){.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{margin-left:8px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:16px}}.links[_ngcontent-%COMP%]   .indent[_ngcontent-%COMP%]{margin-left:0;border-top:2px dotted var(--text-color-secondary);width:8px}.links[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px}[_nghost-%COMP%]     .p-dropdown:not(:is(:hover,   :focus,   .ng-invalid)), [_nghost-%COMP%]     .p-inputtext:not(:is(:hover,   :focus,   .ng-invalid)){border-color:transparent;background-color:transparent}tr.detail[_ngcontent-%COMP%]{background-color:var(--surface-ground)}[_nghost-%COMP%]     tr.detail .p-tabmenu .p-tabmenu-nav .p-tabmenuitem:not(.p-highlight) .p-menuitem-link{background-color:transparent}.icon-height[_ngcontent-%COMP%]{min-height:32px}.modules-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;margin:auto}.fragment[_ngcontent-%COMP%]{position:absolute;top:-10rem;visibility:hidden}.column-header-row[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{height:48px}"],changeDetection:0});let t=i;return t})();export{Je as a,Ke as b,Rs as c};
