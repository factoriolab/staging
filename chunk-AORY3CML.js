import{a as mi}from"./chunk-CUFKS2BC.js";import{$e as fe,Ac as hi,Ad as Ot,Dc as di,I as si,K as oi,N as li,Qd as Ee,Sd as ut,T as ft,Td as oe,Ua as ci,Ud as gi,_ as ne,_c as re,a as Dt,ad as ui,b as ee,ba as ae,da as J,dd as pi,ed as ht,gd as _i,ha as xt,jd as se,je as le,kd as dt,ke as tt,la as K,m as ke,pd as Re,u as Ie,uc as fi,ve as ce,we as bi,x as ie,y as Mt,yd as Q}from"./chunk-YAB2OKXH.js";function Rt(e){let a=e.length;for(;--a>=0;)e[a]=0}var Pn=0,an=1,Kn=2,Wn=3,Gn=258,Je=29,Xt=256,Ut=Xt+1+Je,vt=30,Qe=19,rn=2*Ut+1,pt=15,Te=16,Xn=7,ti=256,sn=16,on=17,ln=18,Ve=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ge=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Yn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),cn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qn=512,it=new Array((Ut+2)*2);Rt(it);var Zt=new Array(vt*2);Rt(Zt);var Ct=new Array(qn);Rt(Ct);var Vt=new Array(Gn-Wn+1);Rt(Vt);var ei=new Array(Je);Rt(ei);var be=new Array(vt);Rt(be);function Ae(e,a,t,i,r){this.static_tree=e,this.extra_bits=a,this.extra_base=t,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}var fn,hn,dn;function Ne(e,a){this.dyn_tree=e,this.max_code=0,this.stat_desc=a}var un=e=>e<256?Ct[e]:Ct[256+(e>>>7)],Ht=(e,a)=>{e.pending_buf[e.pending++]=a&255,e.pending_buf[e.pending++]=a>>>8&255},L=(e,a,t)=>{e.bi_valid>Te-t?(e.bi_buf|=a<<e.bi_valid&65535,Ht(e,e.bi_buf),e.bi_buf=a>>Te-e.bi_valid,e.bi_valid+=t-Te):(e.bi_buf|=a<<e.bi_valid&65535,e.bi_valid+=t)},X=(e,a,t)=>{L(e,t[a*2],t[a*2+1])},pn=(e,a)=>{let t=0;do t|=e&1,e>>>=1,t<<=1;while(--a>0);return t>>>1},Jn=e=>{e.bi_valid===16?(Ht(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Qn=(e,a)=>{let t=a.dyn_tree,i=a.max_code,r=a.stat_desc.static_tree,n=a.stat_desc.has_stree,o=a.stat_desc.extra_bits,s=a.stat_desc.extra_base,f=a.stat_desc.max_length,l,c,p,h,d,_,b=0;for(h=0;h<=pt;h++)e.bl_count[h]=0;for(t[e.heap[e.heap_max]*2+1]=0,l=e.heap_max+1;l<rn;l++)c=e.heap[l],h=t[t[c*2+1]*2+1]+1,h>f&&(h=f,b++),t[c*2+1]=h,!(c>i)&&(e.bl_count[h]++,d=0,c>=s&&(d=o[c-s]),_=t[c*2],e.opt_len+=_*(h+d),n&&(e.static_len+=_*(r[c*2+1]+d)));if(b!==0){do{for(h=f-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[f]--,b-=2}while(b>0);for(h=f;h!==0;h--)for(c=e.bl_count[h];c!==0;)p=e.heap[--l],!(p>i)&&(t[p*2+1]!==h&&(e.opt_len+=(h-t[p*2+1])*t[p*2],t[p*2+1]=h),c--)}},_n=(e,a,t)=>{let i=new Array(pt+1),r=0,n,o;for(n=1;n<=pt;n++)r=r+t[n-1]<<1,i[n]=r;for(o=0;o<=a;o++){let s=e[o*2+1];s!==0&&(e[o*2]=pn(i[s]++,s))}},ta=()=>{let e,a,t,i,r,n=new Array(pt+1);for(t=0,i=0;i<Je-1;i++)for(ei[i]=t,e=0;e<1<<Ve[i];e++)Vt[t++]=i;for(Vt[t-1]=i,r=0,i=0;i<16;i++)for(be[i]=r,e=0;e<1<<ge[i];e++)Ct[r++]=i;for(r>>=7;i<vt;i++)for(be[i]=r<<7,e=0;e<1<<ge[i]-7;e++)Ct[256+r++]=i;for(a=0;a<=pt;a++)n[a]=0;for(e=0;e<=143;)it[e*2+1]=8,e++,n[8]++;for(;e<=255;)it[e*2+1]=9,e++,n[9]++;for(;e<=279;)it[e*2+1]=7,e++,n[7]++;for(;e<=287;)it[e*2+1]=8,e++,n[8]++;for(_n(it,Ut+1,n),e=0;e<vt;e++)Zt[e*2+1]=5,Zt[e*2]=pn(e,5);fn=new Ae(it,Ve,Xt+1,Ut,pt),hn=new Ae(Zt,ge,0,vt,pt),dn=new Ae(new Array(0),Yn,0,Qe,Xn)},gn=e=>{let a;for(a=0;a<Ut;a++)e.dyn_ltree[a*2]=0;for(a=0;a<vt;a++)e.dyn_dtree[a*2]=0;for(a=0;a<Qe;a++)e.bl_tree[a*2]=0;e.dyn_ltree[ti*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},bn=e=>{e.bi_valid>8?Ht(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},wi=(e,a,t,i)=>{let r=a*2,n=t*2;return e[r]<e[n]||e[r]===e[n]&&i[a]<=i[t]},De=(e,a,t)=>{let i=e.heap[t],r=t<<1;for(;r<=e.heap_len&&(r<e.heap_len&&wi(a,e.heap[r+1],e.heap[r],e.depth)&&r++,!wi(a,i,e.heap[r],e.depth));)e.heap[t]=e.heap[r],t=r,r<<=1;e.heap[t]=i},zi=(e,a,t)=>{let i,r,n=0,o,s;if(e.sym_next!==0)do i=e.pending_buf[e.sym_buf+n++]&255,i+=(e.pending_buf[e.sym_buf+n++]&255)<<8,r=e.pending_buf[e.sym_buf+n++],i===0?X(e,r,a):(o=Vt[r],X(e,o+Xt+1,a),s=Ve[o],s!==0&&(r-=ei[o],L(e,r,s)),i--,o=un(i),X(e,o,t),s=ge[o],s!==0&&(i-=be[o],L(e,i,s)));while(n<e.sym_next);X(e,ti,a)},He=(e,a)=>{let t=a.dyn_tree,i=a.stat_desc.static_tree,r=a.stat_desc.has_stree,n=a.stat_desc.elems,o,s,f=-1,l;for(e.heap_len=0,e.heap_max=rn,o=0;o<n;o++)t[o*2]!==0?(e.heap[++e.heap_len]=f=o,e.depth[o]=0):t[o*2+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=f<2?++f:0,t[l*2]=1,e.depth[l]=0,e.opt_len--,r&&(e.static_len-=i[l*2+1]);for(a.max_code=f,o=e.heap_len>>1;o>=1;o--)De(e,t,o);l=n;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],De(e,t,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,t[l*2]=t[o*2]+t[s*2],e.depth[l]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,t[o*2+1]=t[s*2+1]=l,e.heap[1]=l++,De(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Qn(e,a),_n(t,f,e.bl_count)},xi=(e,a,t)=>{let i,r=-1,n,o=a[0*2+1],s=0,f=7,l=4;for(o===0&&(f=138,l=3),a[(t+1)*2+1]=65535,i=0;i<=t;i++)n=o,o=a[(i+1)*2+1],!(++s<f&&n===o)&&(s<l?e.bl_tree[n*2]+=s:n!==0?(n!==r&&e.bl_tree[n*2]++,e.bl_tree[sn*2]++):s<=10?e.bl_tree[on*2]++:e.bl_tree[ln*2]++,s=0,r=n,o===0?(f=138,l=3):n===o?(f=6,l=3):(f=7,l=4))},yi=(e,a,t)=>{let i,r=-1,n,o=a[0*2+1],s=0,f=7,l=4;for(o===0&&(f=138,l=3),i=0;i<=t;i++)if(n=o,o=a[(i+1)*2+1],!(++s<f&&n===o)){if(s<l)do X(e,n,e.bl_tree);while(--s!==0);else n!==0?(n!==r&&(X(e,n,e.bl_tree),s--),X(e,sn,e.bl_tree),L(e,s-3,2)):s<=10?(X(e,on,e.bl_tree),L(e,s-3,3)):(X(e,ln,e.bl_tree),L(e,s-11,7));s=0,r=n,o===0?(f=138,l=3):n===o?(f=6,l=3):(f=7,l=4)}},ea=e=>{let a;for(xi(e,e.dyn_ltree,e.l_desc.max_code),xi(e,e.dyn_dtree,e.d_desc.max_code),He(e,e.bl_desc),a=Qe-1;a>=3&&e.bl_tree[cn[a]*2+1]===0;a--);return e.opt_len+=3*(a+1)+5+5+4,a},ia=(e,a,t,i)=>{let r;for(L(e,a-257,5),L(e,t-1,5),L(e,i-4,4),r=0;r<i;r++)L(e,e.bl_tree[cn[r]*2+1],3);yi(e,e.dyn_ltree,a-1),yi(e,e.dyn_dtree,t-1)},na=e=>{let a=4093624447,t;for(t=0;t<=31;t++,a>>>=1)if(a&1&&e.dyn_ltree[t*2]!==0)return 0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return 1;for(t=32;t<Xt;t++)if(e.dyn_ltree[t*2]!==0)return 1;return 0},Si=!1,aa=e=>{Si||(ta(),Si=!0),e.l_desc=new Ne(e.dyn_ltree,fn),e.d_desc=new Ne(e.dyn_dtree,hn),e.bl_desc=new Ne(e.bl_tree,dn),e.bi_buf=0,e.bi_valid=0,gn(e)},mn=(e,a,t,i)=>{L(e,(Pn<<1)+(i?1:0),3),bn(e),Ht(e,t),Ht(e,~t),t&&e.pending_buf.set(e.window.subarray(a,a+t),e.pending),e.pending+=t},ra=e=>{L(e,an<<1,3),X(e,ti,it),Jn(e)},sa=(e,a,t,i)=>{let r,n,o=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=na(e)),He(e,e.l_desc),He(e,e.d_desc),o=ea(e),r=e.opt_len+3+7>>>3,n=e.static_len+3+7>>>3,n<=r&&(r=n)):r=n=t+5,t+4<=r&&a!==-1?mn(e,a,t,i):e.strategy===4||n===r?(L(e,(an<<1)+(i?1:0),3),zi(e,it,Zt)):(L(e,(Kn<<1)+(i?1:0),3),ia(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),zi(e,e.dyn_ltree,e.dyn_dtree)),gn(e),i&&bn(e)},oa=(e,a,t)=>(e.pending_buf[e.sym_buf+e.sym_next++]=a,e.pending_buf[e.sym_buf+e.sym_next++]=a>>8,e.pending_buf[e.sym_buf+e.sym_next++]=t,a===0?e.dyn_ltree[t*2]++:(e.matches++,a--,e.dyn_ltree[(Vt[t]+Xt+1)*2]++,e.dyn_dtree[un(a)*2]++),e.sym_next===e.sym_end),la=aa,ca=mn,fa=sa,ha=oa,da=ra,ua={_tr_init:la,_tr_stored_block:ca,_tr_flush_block:fa,_tr_tally:ha,_tr_align:da},pa=(e,a,t,i)=>{let r=e&65535|0,n=e>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+a[i++]|0,n=n+r|0;while(--o);r%=65521,n%=65521}return r|n<<16|0},Pt=pa,_a=()=>{let e,a=[];for(var t=0;t<256;t++){e=t;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;a[t]=e}return a},ga=new Uint32Array(_a()),ba=(e,a,t,i)=>{let r=ga,n=i+t;e^=-1;for(let o=i;o<n;o++)e=e>>>8^r[(e^a[o])&255];return e^-1},F=ba,bt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Et={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:ma,_tr_stored_block:Pe,_tr_flush_block:wa,_tr_tally:st,_tr_align:za}=ua,{Z_NO_FLUSH:ot,Z_PARTIAL_FLUSH:xa,Z_FULL_FLUSH:ya,Z_FINISH:H,Z_BLOCK:vi,Z_OK:B,Z_STREAM_END:ki,Z_STREAM_ERROR:Y,Z_DATA_ERROR:Sa,Z_BUF_ERROR:Me,Z_DEFAULT_COMPRESSION:va,Z_FILTERED:ka,Z_HUFFMAN_ONLY:he,Z_RLE:Ia,Z_FIXED:Ra,Z_DEFAULT_STRATEGY:Ea,Z_UNKNOWN:Ta,Z_DEFLATED:ze}=Et,Aa=9,Na=15,Da=8,Ma=29,Oa=256,Ke=Oa+1+Ma,$a=30,Fa=19,Ba=2*Ke+1,Za=15,I=3,rt=258,q=rt+I+1,La=32,kt=42,ii=57,We=69,Ge=73,Xe=91,Ye=103,_t=113,Ft=666,Z=1,Tt=2,mt=3,At=4,ja=3,gt=(e,a)=>(e.msg=bt[a],a),Ii=e=>e*2-(e>4?9:0),at=e=>{let a=e.length;for(;--a>=0;)e[a]=0},Ua=e=>{let a,t,i,r=e.w_size;a=e.hash_size,i=a;do t=e.head[--i],e.head[i]=t>=r?t-r:0;while(--a);a=r,i=a;do t=e.prev[--i],e.prev[i]=t>=r?t-r:0;while(--a)},Ca=(e,a,t)=>(a<<e.hash_shift^t)&e.hash_mask,lt=Ca,C=e=>{let a=e.state,t=a.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.output.set(a.pending_buf.subarray(a.pending_out,a.pending_out+t),e.next_out),e.next_out+=t,a.pending_out+=t,e.total_out+=t,e.avail_out-=t,a.pending-=t,a.pending===0&&(a.pending_out=0))},V=(e,a)=>{wa(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,a),e.block_start=e.strstart,C(e.strm)},T=(e,a)=>{e.pending_buf[e.pending++]=a},$t=(e,a)=>{e.pending_buf[e.pending++]=a>>>8&255,e.pending_buf[e.pending++]=a&255},qe=(e,a,t,i)=>{let r=e.avail_in;return r>i&&(r=i),r===0?0:(e.avail_in-=r,a.set(e.input.subarray(e.next_in,e.next_in+r),t),e.state.wrap===1?e.adler=Pt(e.adler,a,r,t):e.state.wrap===2&&(e.adler=F(e.adler,a,r,t)),e.next_in+=r,e.total_in+=r,r)},wn=(e,a)=>{let t=e.max_chain_length,i=e.strstart,r,n,o=e.prev_length,s=e.nice_match,f=e.strstart>e.w_size-q?e.strstart-(e.w_size-q):0,l=e.window,c=e.w_mask,p=e.prev,h=e.strstart+rt,d=l[i+o-1],_=l[i+o];e.prev_length>=e.good_match&&(t>>=2),s>e.lookahead&&(s=e.lookahead);do if(r=a,!(l[r+o]!==_||l[r+o-1]!==d||l[r]!==l[i]||l[++r]!==l[i+1])){i+=2,r++;do;while(l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&l[++i]===l[++r]&&i<h);if(n=rt-(h-i),i=h-rt,n>o){if(e.match_start=a,o=n,n>=s)break;d=l[i+o-1],_=l[i+o]}}while((a=p[a&c])>f&&--t!==0);return o<=e.lookahead?o:e.lookahead},It=e=>{let a=e.w_size,t,i,r;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-q)&&(e.window.set(e.window.subarray(a,a+a-i),0),e.match_start-=a,e.strstart-=a,e.block_start-=a,e.insert>e.strstart&&(e.insert=e.strstart),Ua(e),i+=a),e.strm.avail_in===0)break;if(t=qe(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=t,e.lookahead+e.insert>=I)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=lt(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=lt(e,e.ins_h,e.window[r+I-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<I)););}while(e.lookahead<q&&e.strm.avail_in!==0)},zn=(e,a)=>{let t=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i,r,n,o=0,s=e.strm.avail_in;do{if(i=65535,n=e.bi_valid+42>>3,e.strm.avail_out<n||(n=e.strm.avail_out-n,r=e.strstart-e.block_start,i>r+e.strm.avail_in&&(i=r+e.strm.avail_in),i>n&&(i=n),i<t&&(i===0&&a!==H||a===ot||i!==r+e.strm.avail_in)))break;o=a===H&&i===r+e.strm.avail_in?1:0,Pe(e,0,0,o),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,C(e.strm),r&&(r>i&&(r=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,i-=r),i&&(qe(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(o===0);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?At:a!==ot&&a!==H&&e.strm.avail_in===0&&e.strstart===e.block_start?Tt:(n=e.window_size-e.strstart,e.strm.avail_in>n&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,n+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),n>e.strm.avail_in&&(n=e.strm.avail_in),n&&(qe(e.strm,e.window,e.strstart,n),e.strstart+=n,e.insert+=n>e.w_size-e.insert?e.w_size-e.insert:n),e.high_water<e.strstart&&(e.high_water=e.strstart),n=e.bi_valid+42>>3,n=e.pending_buf_size-n>65535?65535:e.pending_buf_size-n,t=n>e.w_size?e.w_size:n,r=e.strstart-e.block_start,(r>=t||(r||a===H)&&a!==ot&&e.strm.avail_in===0&&r<=n)&&(i=r>n?n:r,o=a===H&&e.strm.avail_in===0&&i===r?1:0,Pe(e,e.block_start,i,o),e.block_start+=i,C(e.strm)),o?mt:Z)},Oe=(e,a)=>{let t,i;for(;;){if(e.lookahead<q){if(It(e),e.lookahead<q&&a===ot)return Z;if(e.lookahead===0)break}if(t=0,e.lookahead>=I&&(e.ins_h=lt(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-q&&(e.match_length=wn(e,t)),e.match_length>=I)if(i=st(e,e.strstart-e.match_start,e.match_length-I),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=I){e.match_length--;do e.strstart++,e.ins_h=lt(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=lt(e,e.ins_h,e.window[e.strstart+1]);else i=st(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(V(e,!1),e.strm.avail_out===0))return Z}return e.insert=e.strstart<I-1?e.strstart:I-1,a===H?(V(e,!0),e.strm.avail_out===0?mt:At):e.sym_next&&(V(e,!1),e.strm.avail_out===0)?Z:Tt},yt=(e,a)=>{let t,i,r;for(;;){if(e.lookahead<q){if(It(e),e.lookahead<q&&a===ot)return Z;if(e.lookahead===0)break}if(t=0,e.lookahead>=I&&(e.ins_h=lt(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=I-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-q&&(e.match_length=wn(e,t),e.match_length<=5&&(e.strategy===ka||e.match_length===I&&e.strstart-e.match_start>4096)&&(e.match_length=I-1)),e.prev_length>=I&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-I,i=st(e,e.strstart-1-e.prev_match,e.prev_length-I),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=lt(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=I-1,e.strstart++,i&&(V(e,!1),e.strm.avail_out===0))return Z}else if(e.match_available){if(i=st(e,0,e.window[e.strstart-1]),i&&V(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Z}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=st(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<I-1?e.strstart:I-1,a===H?(V(e,!0),e.strm.avail_out===0?mt:At):e.sym_next&&(V(e,!1),e.strm.avail_out===0)?Z:Tt},Va=(e,a)=>{let t,i,r,n,o=e.window;for(;;){if(e.lookahead<=rt){if(It(e),e.lookahead<=rt&&a===ot)return Z;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=I&&e.strstart>0&&(r=e.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){n=e.strstart+rt;do;while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<n);e.match_length=rt-(n-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=I?(t=st(e,1,e.match_length-I),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=st(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(V(e,!1),e.strm.avail_out===0))return Z}return e.insert=0,a===H?(V(e,!0),e.strm.avail_out===0?mt:At):e.sym_next&&(V(e,!1),e.strm.avail_out===0)?Z:Tt},Ha=(e,a)=>{let t;for(;;){if(e.lookahead===0&&(It(e),e.lookahead===0)){if(a===ot)return Z;break}if(e.match_length=0,t=st(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(V(e,!1),e.strm.avail_out===0))return Z}return e.insert=0,a===H?(V(e,!0),e.strm.avail_out===0?mt:At):e.sym_next&&(V(e,!1),e.strm.avail_out===0)?Z:Tt};function G(e,a,t,i,r){this.good_length=e,this.max_lazy=a,this.nice_length=t,this.max_chain=i,this.func=r}var Bt=[new G(0,0,0,0,zn),new G(4,4,8,4,Oe),new G(4,5,16,8,Oe),new G(4,6,32,32,Oe),new G(4,4,16,16,yt),new G(8,16,32,32,yt),new G(8,16,128,128,yt),new G(8,32,128,256,yt),new G(32,128,258,1024,yt),new G(32,258,258,4096,yt)],Pa=e=>{e.window_size=2*e.w_size,at(e.head),e.max_lazy_match=Bt[e.level].max_lazy,e.good_match=Bt[e.level].good_length,e.nice_match=Bt[e.level].nice_length,e.max_chain_length=Bt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=I-1,e.match_available=0,e.ins_h=0};function Ka(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ze,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Ba*2),this.dyn_dtree=new Uint16Array((2*$a+1)*2),this.bl_tree=new Uint16Array((2*Fa+1)*2),at(this.dyn_ltree),at(this.dyn_dtree),at(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Za+1),this.heap=new Uint16Array(2*Ke+1),at(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ke+1),at(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Yt=e=>{if(!e)return 1;let a=e.state;return!a||a.strm!==e||a.status!==kt&&a.status!==ii&&a.status!==We&&a.status!==Ge&&a.status!==Xe&&a.status!==Ye&&a.status!==_t&&a.status!==Ft?1:0},xn=e=>{if(Yt(e))return gt(e,Y);e.total_in=e.total_out=0,e.data_type=Ta;let a=e.state;return a.pending=0,a.pending_out=0,a.wrap<0&&(a.wrap=-a.wrap),a.status=a.wrap===2?ii:a.wrap?kt:_t,e.adler=a.wrap===2?0:1,a.last_flush=-2,ma(a),B},yn=e=>{let a=xn(e);return a===B&&Pa(e.state),a},Wa=(e,a)=>Yt(e)||e.state.wrap!==2?Y:(e.state.gzhead=a,B),Sn=(e,a,t,i,r,n)=>{if(!e)return Y;let o=1;if(a===va&&(a=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>Aa||t!==ze||i<8||i>15||a<0||a>9||n<0||n>Ra||i===8&&o!==1)return gt(e,Y);i===8&&(i=9);let s=new Ka;return e.state=s,s.strm=e,s.status=kt,s.wrap=o,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+I-1)/I),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=(s.lit_bufsize-1)*3,s.level=a,s.strategy=n,s.method=t,yn(e)},Ga=(e,a)=>Sn(e,a,ze,Na,Da,Ea),Xa=(e,a)=>{if(Yt(e)||a>vi||a<0)return e?gt(e,Y):Y;let t=e.state;if(!e.output||e.avail_in!==0&&!e.input||t.status===Ft&&a!==H)return gt(e,e.avail_out===0?Me:Y);let i=t.last_flush;if(t.last_flush=a,t.pending!==0){if(C(e),e.avail_out===0)return t.last_flush=-1,B}else if(e.avail_in===0&&Ii(a)<=Ii(i)&&a!==H)return gt(e,Me);if(t.status===Ft&&e.avail_in!==0)return gt(e,Me);if(t.status===kt&&t.wrap===0&&(t.status=_t),t.status===kt){let r=ze+(t.w_bits-8<<4)<<8,n=-1;if(t.strategy>=he||t.level<2?n=0:t.level<6?n=1:t.level===6?n=2:n=3,r|=n<<6,t.strstart!==0&&(r|=La),r+=31-r%31,$t(t,r),t.strstart!==0&&($t(t,e.adler>>>16),$t(t,e.adler&65535)),e.adler=1,t.status=_t,C(e),t.pending!==0)return t.last_flush=-1,B}if(t.status===ii){if(e.adler=0,T(t,31),T(t,139),T(t,8),t.gzhead)T(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),T(t,t.gzhead.time&255),T(t,t.gzhead.time>>8&255),T(t,t.gzhead.time>>16&255),T(t,t.gzhead.time>>24&255),T(t,t.level===9?2:t.strategy>=he||t.level<2?4:0),T(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(T(t,t.gzhead.extra.length&255),T(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(e.adler=F(e.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=We;else if(T(t,0),T(t,0),T(t,0),T(t,0),T(t,0),T(t,t.level===9?2:t.strategy>=he||t.level<2?4:0),T(t,ja),t.status=_t,C(e),t.pending!==0)return t.last_flush=-1,B}if(t.status===We){if(t.gzhead.extra){let r=t.pending,n=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+n>t.pending_buf_size;){let s=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+s),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>r&&(e.adler=F(e.adler,t.pending_buf,t.pending-r,r)),t.gzindex+=s,C(e),t.pending!==0)return t.last_flush=-1,B;r=0,n-=s}let o=new Uint8Array(t.gzhead.extra);t.pending_buf.set(o.subarray(t.gzindex,t.gzindex+n),t.pending),t.pending+=n,t.gzhead.hcrc&&t.pending>r&&(e.adler=F(e.adler,t.pending_buf,t.pending-r,r)),t.gzindex=0}t.status=Ge}if(t.status===Ge){if(t.gzhead.name){let r=t.pending,n;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>r&&(e.adler=F(e.adler,t.pending_buf,t.pending-r,r)),C(e),t.pending!==0)return t.last_flush=-1,B;r=0}t.gzindex<t.gzhead.name.length?n=t.gzhead.name.charCodeAt(t.gzindex++)&255:n=0,T(t,n)}while(n!==0);t.gzhead.hcrc&&t.pending>r&&(e.adler=F(e.adler,t.pending_buf,t.pending-r,r)),t.gzindex=0}t.status=Xe}if(t.status===Xe){if(t.gzhead.comment){let r=t.pending,n;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>r&&(e.adler=F(e.adler,t.pending_buf,t.pending-r,r)),C(e),t.pending!==0)return t.last_flush=-1,B;r=0}t.gzindex<t.gzhead.comment.length?n=t.gzhead.comment.charCodeAt(t.gzindex++)&255:n=0,T(t,n)}while(n!==0);t.gzhead.hcrc&&t.pending>r&&(e.adler=F(e.adler,t.pending_buf,t.pending-r,r))}t.status=Ye}if(t.status===Ye){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(C(e),t.pending!==0))return t.last_flush=-1,B;T(t,e.adler&255),T(t,e.adler>>8&255),e.adler=0}if(t.status=_t,C(e),t.pending!==0)return t.last_flush=-1,B}if(e.avail_in!==0||t.lookahead!==0||a!==ot&&t.status!==Ft){let r=t.level===0?zn(t,a):t.strategy===he?Ha(t,a):t.strategy===Ia?Va(t,a):Bt[t.level].func(t,a);if((r===mt||r===At)&&(t.status=Ft),r===Z||r===mt)return e.avail_out===0&&(t.last_flush=-1),B;if(r===Tt&&(a===xa?za(t):a!==vi&&(Pe(t,0,0,!1),a===ya&&(at(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),C(e),e.avail_out===0))return t.last_flush=-1,B}return a!==H?B:t.wrap<=0?ki:(t.wrap===2?(T(t,e.adler&255),T(t,e.adler>>8&255),T(t,e.adler>>16&255),T(t,e.adler>>24&255),T(t,e.total_in&255),T(t,e.total_in>>8&255),T(t,e.total_in>>16&255),T(t,e.total_in>>24&255)):($t(t,e.adler>>>16),$t(t,e.adler&65535)),C(e),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?B:ki)},Ya=e=>{if(Yt(e))return Y;let a=e.state.status;return e.state=null,a===_t?gt(e,Sa):B},qa=(e,a)=>{let t=a.length;if(Yt(e))return Y;let i=e.state,r=i.wrap;if(r===2||r===1&&i.status!==kt||i.lookahead)return Y;if(r===1&&(e.adler=Pt(e.adler,a,t,0)),i.wrap=0,t>=i.w_size){r===0&&(at(i.head),i.strstart=0,i.block_start=0,i.insert=0);let f=new Uint8Array(i.w_size);f.set(a.subarray(t-i.w_size,t),0),a=f,t=i.w_size}let n=e.avail_in,o=e.next_in,s=e.input;for(e.avail_in=t,e.next_in=0,e.input=a,It(i);i.lookahead>=I;){let f=i.strstart,l=i.lookahead-(I-1);do i.ins_h=lt(i,i.ins_h,i.window[f+I-1]),i.prev[f&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=f,f++;while(--l);i.strstart=f,i.lookahead=I-1,It(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=I-1,i.match_available=0,e.next_in=o,e.input=s,e.avail_in=n,i.wrap=r,B},Ja=Ga,Qa=Sn,tr=yn,er=xn,ir=Wa,nr=Xa,ar=Ya,rr=qa,sr="pako deflate (from Nodeca project)",Lt={deflateInit:Ja,deflateInit2:Qa,deflateReset:tr,deflateResetKeep:er,deflateSetHeader:ir,deflate:nr,deflateEnd:ar,deflateSetDictionary:rr,deflateInfo:sr},or=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),lr=function(e){let a=Array.prototype.slice.call(arguments,1);for(;a.length;){let t=a.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(let i in t)or(t,i)&&(e[i]=t[i])}}return e},cr=e=>{let a=0;for(let i=0,r=e.length;i<r;i++)a+=e[i].length;let t=new Uint8Array(a);for(let i=0,r=0,n=e.length;i<n;i++){let o=e[i];t.set(o,r),r+=o.length}return t},xe={assign:lr,flattenChunks:cr},vn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{vn=!1}var Kt=new Uint8Array(256);for(let e=0;e<256;e++)Kt[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Kt[254]=Kt[254]=1;var fr=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let a,t,i,r,n,o=e.length,s=0;for(r=0;r<o;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),s+=t<128?1:t<2048?2:t<65536?3:4;for(a=new Uint8Array(s),n=0,r=0;n<s;r++)t=e.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),t<128?a[n++]=t:t<2048?(a[n++]=192|t>>>6,a[n++]=128|t&63):t<65536?(a[n++]=224|t>>>12,a[n++]=128|t>>>6&63,a[n++]=128|t&63):(a[n++]=240|t>>>18,a[n++]=128|t>>>12&63,a[n++]=128|t>>>6&63,a[n++]=128|t&63);return a},hr=(e,a)=>{if(a<65534&&e.subarray&&vn)return String.fromCharCode.apply(null,e.length===a?e:e.subarray(0,a));let t="";for(let i=0;i<a;i++)t+=String.fromCharCode(e[i]);return t},dr=(e,a)=>{let t=a||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,a));let i,r,n=new Array(t*2);for(r=0,i=0;i<t;){let o=e[i++];if(o<128){n[r++]=o;continue}let s=Kt[o];if(s>4){n[r++]=65533,i+=s-1;continue}for(o&=s===2?31:s===3?15:7;s>1&&i<t;)o=o<<6|e[i++]&63,s--;if(s>1){n[r++]=65533;continue}o<65536?n[r++]=o:(o-=65536,n[r++]=55296|o>>10&1023,n[r++]=56320|o&1023)}return hr(n,r)},ur=(e,a)=>{a=a||e.length,a>e.length&&(a=e.length);let t=a-1;for(;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?a:t+Kt[e[t]]>a?t:a},Wt={string2buf:fr,buf2string:dr,utf8border:ur};function pr(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var kn=pr,In=Object.prototype.toString,{Z_NO_FLUSH:_r,Z_SYNC_FLUSH:gr,Z_FULL_FLUSH:br,Z_FINISH:mr,Z_OK:me,Z_STREAM_END:wr,Z_DEFAULT_COMPRESSION:zr,Z_DEFAULT_STRATEGY:xr,Z_DEFLATED:yr}=Et;function qt(e){this.options=xe.assign({level:zr,method:yr,chunkSize:16384,windowBits:15,memLevel:8,strategy:xr},e||{});let a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kn,this.strm.avail_out=0;let t=Lt.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(t!==me)throw new Error(bt[t]);if(a.header&&Lt.deflateSetHeader(this.strm,a.header),a.dictionary){let i;if(typeof a.dictionary=="string"?i=Wt.string2buf(a.dictionary):In.call(a.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(a.dictionary):i=a.dictionary,t=Lt.deflateSetDictionary(this.strm,i),t!==me)throw new Error(bt[t]);this._dict_set=!0}}qt.prototype.push=function(e,a){let t=this.strm,i=this.options.chunkSize,r,n;if(this.ended)return!1;for(a===~~a?n=a:n=a===!0?mr:_r,typeof e=="string"?t.input=Wt.string2buf(e):In.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),(n===gr||n===br)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(r=Lt.deflate(t,n),r===wr)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),r=Lt.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===me;if(t.avail_out===0){this.onData(t.output);continue}if(n>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};qt.prototype.onData=function(e){this.chunks.push(e)};qt.prototype.onEnd=function(e){e===me&&(this.result=xe.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ni(e,a){let t=new qt(a);if(t.push(e,!0),t.err)throw t.msg||bt[t.err];return t.result}function Sr(e,a){return a=a||{},a.raw=!0,ni(e,a)}function vr(e,a){return a=a||{},a.gzip=!0,ni(e,a)}var kr=qt,Ir=ni,Rr=Sr,Er=vr,Tr=Et,Ar={Deflate:kr,deflate:Ir,deflateRaw:Rr,gzip:Er,constants:Tr},de=16209,Nr=16191,Dr=function(a,t){let i,r,n,o,s,f,l,c,p,h,d,_,b,z,m,x,y,g,E,$,w,A,R,S,k=a.state;i=a.next_in,R=a.input,r=i+(a.avail_in-5),n=a.next_out,S=a.output,o=n-(t-a.avail_out),s=n+(a.avail_out-257),f=k.dmax,l=k.wsize,c=k.whave,p=k.wnext,h=k.window,d=k.hold,_=k.bits,b=k.lencode,z=k.distcode,m=(1<<k.lenbits)-1,x=(1<<k.distbits)-1;t:do{_<15&&(d+=R[i++]<<_,_+=8,d+=R[i++]<<_,_+=8),y=b[d&m];e:for(;;){if(g=y>>>24,d>>>=g,_-=g,g=y>>>16&255,g===0)S[n++]=y&65535;else if(g&16){E=y&65535,g&=15,g&&(_<g&&(d+=R[i++]<<_,_+=8),E+=d&(1<<g)-1,d>>>=g,_-=g),_<15&&(d+=R[i++]<<_,_+=8,d+=R[i++]<<_,_+=8),y=z[d&x];i:for(;;){if(g=y>>>24,d>>>=g,_-=g,g=y>>>16&255,g&16){if($=y&65535,g&=15,_<g&&(d+=R[i++]<<_,_+=8,_<g&&(d+=R[i++]<<_,_+=8)),$+=d&(1<<g)-1,$>f){a.msg="invalid distance too far back",k.mode=de;break t}if(d>>>=g,_-=g,g=n-o,$>g){if(g=$-g,g>c&&k.sane){a.msg="invalid distance too far back",k.mode=de;break t}if(w=0,A=h,p===0){if(w+=l-g,g<E){E-=g;do S[n++]=h[w++];while(--g);w=n-$,A=S}}else if(p<g){if(w+=l+p-g,g-=p,g<E){E-=g;do S[n++]=h[w++];while(--g);if(w=0,p<E){g=p,E-=g;do S[n++]=h[w++];while(--g);w=n-$,A=S}}}else if(w+=p-g,g<E){E-=g;do S[n++]=h[w++];while(--g);w=n-$,A=S}for(;E>2;)S[n++]=A[w++],S[n++]=A[w++],S[n++]=A[w++],E-=3;E&&(S[n++]=A[w++],E>1&&(S[n++]=A[w++]))}else{w=n-$;do S[n++]=S[w++],S[n++]=S[w++],S[n++]=S[w++],E-=3;while(E>2);E&&(S[n++]=S[w++],E>1&&(S[n++]=S[w++]))}}else if(g&64){a.msg="invalid distance code",k.mode=de;break t}else{y=z[(y&65535)+(d&(1<<g)-1)];continue i}break}}else if(g&64)if(g&32){k.mode=Nr;break t}else{a.msg="invalid literal/length code",k.mode=de;break t}else{y=b[(y&65535)+(d&(1<<g)-1)];continue e}break}}while(i<r&&n<s);E=_>>3,i-=E,_-=E<<3,d&=(1<<_)-1,a.next_in=i,a.next_out=n,a.avail_in=i<r?5+(r-i):5-(i-r),a.avail_out=n<s?257+(s-n):257-(n-s),k.hold=d,k.bits=_},St=15,Ri=852,Ei=592,Ti=0,$e=1,Ai=2,Mr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Or=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),$r=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Fr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Br=(e,a,t,i,r,n,o,s)=>{let f=s.bits,l=0,c=0,p=0,h=0,d=0,_=0,b=0,z=0,m=0,x=0,y,g,E,$,w,A=null,R,S=new Uint16Array(St+1),k=new Uint16Array(St+1),ct=null,ri,Qt,te;for(l=0;l<=St;l++)S[l]=0;for(c=0;c<i;c++)S[a[t+c]]++;for(d=f,h=St;h>=1&&S[h]===0;h--);if(d>h&&(d=h),h===0)return r[n++]=1<<24|64<<16|0,r[n++]=1<<24|64<<16|0,s.bits=1,0;for(p=1;p<h&&S[p]===0;p++);for(d<p&&(d=p),z=1,l=1;l<=St;l++)if(z<<=1,z-=S[l],z<0)return-1;if(z>0&&(e===Ti||h!==1))return-1;for(k[1]=0,l=1;l<St;l++)k[l+1]=k[l]+S[l];for(c=0;c<i;c++)a[t+c]!==0&&(o[k[a[t+c]]++]=c);if(e===Ti?(A=ct=o,R=20):e===$e?(A=Mr,ct=Or,R=257):(A=$r,ct=Fr,R=0),x=0,c=0,l=p,w=n,_=d,b=0,E=-1,m=1<<d,$=m-1,e===$e&&m>Ri||e===Ai&&m>Ei)return 1;for(;;){ri=l-b,o[c]+1<R?(Qt=0,te=o[c]):o[c]>=R?(Qt=ct[o[c]-R],te=A[o[c]-R]):(Qt=96,te=0),y=1<<l-b,g=1<<_,p=g;do g-=y,r[w+(x>>b)+g]=ri<<24|Qt<<16|te|0;while(g!==0);for(y=1<<l-1;x&y;)y>>=1;if(y!==0?(x&=y-1,x+=y):x=0,c++,--S[l]===0){if(l===h)break;l=a[t+o[c]]}if(l>d&&(x&$)!==E){for(b===0&&(b=d),w+=p,_=l-b,z=1<<_;_+b<h&&(z-=S[_+b],!(z<=0));)_++,z<<=1;if(m+=1<<_,e===$e&&m>Ri||e===Ai&&m>Ei)return 1;E=x&$,r[E]=d<<24|_<<16|w-n|0}}return x!==0&&(r[w+x]=l-b<<24|64<<16|0),s.bits=d,0},jt=Br,Zr=0,Rn=1,En=2,{Z_FINISH:Ni,Z_BLOCK:Lr,Z_TREES:ue,Z_OK:wt,Z_STREAM_END:jr,Z_NEED_DICT:Ur,Z_STREAM_ERROR:P,Z_DATA_ERROR:Tn,Z_MEM_ERROR:An,Z_BUF_ERROR:Cr,Z_DEFLATED:Di}=Et,ye=16180,Mi=16181,Oi=16182,$i=16183,Fi=16184,Bi=16185,Zi=16186,Li=16187,ji=16188,Ui=16189,we=16190,et=16191,Fe=16192,Ci=16193,Be=16194,Vi=16195,Hi=16196,Pi=16197,Ki=16198,pe=16199,_e=16200,Wi=16201,Gi=16202,Xi=16203,Yi=16204,qi=16205,Ze=16206,Ji=16207,Qi=16208,D=16209,Nn=16210,Dn=16211,Vr=852,Hr=592,Pr=15,Kr=Pr,tn=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Wr(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var zt=e=>{if(!e)return 1;let a=e.state;return!a||a.strm!==e||a.mode<ye||a.mode>Dn?1:0},Mn=e=>{if(zt(e))return P;let a=e.state;return e.total_in=e.total_out=a.total=0,e.msg="",a.wrap&&(e.adler=a.wrap&1),a.mode=ye,a.last=0,a.havedict=0,a.flags=-1,a.dmax=32768,a.head=null,a.hold=0,a.bits=0,a.lencode=a.lendyn=new Int32Array(Vr),a.distcode=a.distdyn=new Int32Array(Hr),a.sane=1,a.back=-1,wt},On=e=>{if(zt(e))return P;let a=e.state;return a.wsize=0,a.whave=0,a.wnext=0,Mn(e)},$n=(e,a)=>{let t;if(zt(e))return P;let i=e.state;return a<0?(t=0,a=-a):(t=(a>>4)+5,a<48&&(a&=15)),a&&(a<8||a>15)?P:(i.window!==null&&i.wbits!==a&&(i.window=null),i.wrap=t,i.wbits=a,On(e))},Fn=(e,a)=>{if(!e)return P;let t=new Wr;e.state=t,t.strm=e,t.window=null,t.mode=ye;let i=$n(e,a);return i!==wt&&(e.state=null),i},Gr=e=>Fn(e,Kr),en=!0,Le,je,Xr=e=>{if(en){Le=new Int32Array(512),je=new Int32Array(32);let a=0;for(;a<144;)e.lens[a++]=8;for(;a<256;)e.lens[a++]=9;for(;a<280;)e.lens[a++]=7;for(;a<288;)e.lens[a++]=8;for(jt(Rn,e.lens,0,288,Le,0,e.work,{bits:9}),a=0;a<32;)e.lens[a++]=5;jt(En,e.lens,0,32,je,0,e.work,{bits:5}),en=!1}e.lencode=Le,e.lenbits=9,e.distcode=je,e.distbits=5},Bn=(e,a,t,i)=>{let r,n=e.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),i>=n.wsize?(n.window.set(a.subarray(t-n.wsize,t),0),n.wnext=0,n.whave=n.wsize):(r=n.wsize-n.wnext,r>i&&(r=i),n.window.set(a.subarray(t-i,t-i+r),n.wnext),i-=r,i?(n.window.set(a.subarray(t-i,t),0),n.wnext=i,n.whave=n.wsize):(n.wnext+=r,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=r))),0},Yr=(e,a)=>{let t,i,r,n,o,s,f,l,c,p,h,d,_,b,z=0,m,x,y,g,E,$,w,A,R=new Uint8Array(4),S,k,ct=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(zt(e)||!e.output||!e.input&&e.avail_in!==0)return P;t=e.state,t.mode===et&&(t.mode=Fe),o=e.next_out,r=e.output,f=e.avail_out,n=e.next_in,i=e.input,s=e.avail_in,l=t.hold,c=t.bits,p=s,h=f,A=wt;t:for(;;)switch(t.mode){case ye:if(t.wrap===0){t.mode=Fe;break}for(;c<16;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,R[0]=l&255,R[1]=l>>>8&255,t.check=F(t.check,R,2,0),l=0,c=0,t.mode=Mi;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",t.mode=D;break}if((l&15)!==Di){e.msg="unknown compression method",t.mode=D;break}if(l>>>=4,c-=4,w=(l&15)+8,t.wbits===0&&(t.wbits=w),w>15||w>t.wbits){e.msg="invalid window size",t.mode=D;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=l&512?Ui:et,l=0,c=0;break;case Mi:for(;c<16;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(t.flags=l,(t.flags&255)!==Di){e.msg="unknown compression method",t.mode=D;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=D;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(R[0]=l&255,R[1]=l>>>8&255,t.check=F(t.check,R,2,0)),l=0,c=0,t.mode=Oi;case Oi:for(;c<32;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(R[0]=l&255,R[1]=l>>>8&255,R[2]=l>>>16&255,R[3]=l>>>24&255,t.check=F(t.check,R,4,0)),l=0,c=0,t.mode=$i;case $i:for(;c<16;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(R[0]=l&255,R[1]=l>>>8&255,t.check=F(t.check,R,2,0)),l=0,c=0,t.mode=Fi;case Fi:if(t.flags&1024){for(;c<16;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(R[0]=l&255,R[1]=l>>>8&255,t.check=F(t.check,R,2,0)),l=0,c=0}else t.head&&(t.head.extra=null);t.mode=Bi;case Bi:if(t.flags&1024&&(d=t.length,d>s&&(d=s),d&&(t.head&&(w=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(n,n+d),w)),t.flags&512&&t.wrap&4&&(t.check=F(t.check,i,d,n)),s-=d,n+=d,t.length-=d),t.length))break t;t.length=0,t.mode=Zi;case Zi:if(t.flags&2048){if(s===0)break t;d=0;do w=i[n+d++],t.head&&w&&t.length<65536&&(t.head.name+=String.fromCharCode(w));while(w&&d<s);if(t.flags&512&&t.wrap&4&&(t.check=F(t.check,i,d,n)),s-=d,n+=d,w)break t}else t.head&&(t.head.name=null);t.length=0,t.mode=Li;case Li:if(t.flags&4096){if(s===0)break t;d=0;do w=i[n+d++],t.head&&w&&t.length<65536&&(t.head.comment+=String.fromCharCode(w));while(w&&d<s);if(t.flags&512&&t.wrap&4&&(t.check=F(t.check,i,d,n)),s-=d,n+=d,w)break t}else t.head&&(t.head.comment=null);t.mode=ji;case ji:if(t.flags&512){for(;c<16;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(t.wrap&4&&l!==(t.check&65535)){e.msg="header crc mismatch",t.mode=D;break}l=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=et;break;case Ui:for(;c<32;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}e.adler=t.check=tn(l),l=0,c=0,t.mode=we;case we:if(t.havedict===0)return e.next_out=o,e.avail_out=f,e.next_in=n,e.avail_in=s,t.hold=l,t.bits=c,Ur;e.adler=t.check=1,t.mode=et;case et:if(a===Lr||a===ue)break t;case Fe:if(t.last){l>>>=c&7,c-=c&7,t.mode=Ze;break}for(;c<3;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}switch(t.last=l&1,l>>>=1,c-=1,l&3){case 0:t.mode=Ci;break;case 1:if(Xr(t),t.mode=pe,a===ue){l>>>=2,c-=2;break t}break;case 2:t.mode=Hi;break;case 3:e.msg="invalid block type",t.mode=D}l>>>=2,c-=2;break;case Ci:for(l>>>=c&7,c-=c&7;c<32;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if((l&65535)!==(l>>>16^65535)){e.msg="invalid stored block lengths",t.mode=D;break}if(t.length=l&65535,l=0,c=0,t.mode=Be,a===ue)break t;case Be:t.mode=Vi;case Vi:if(d=t.length,d){if(d>s&&(d=s),d>f&&(d=f),d===0)break t;r.set(i.subarray(n,n+d),o),s-=d,n+=d,f-=d,o+=d,t.length-=d;break}t.mode=et;break;case Hi:for(;c<14;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(t.nlen=(l&31)+257,l>>>=5,c-=5,t.ndist=(l&31)+1,l>>>=5,c-=5,t.ncode=(l&15)+4,l>>>=4,c-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=D;break}t.have=0,t.mode=Pi;case Pi:for(;t.have<t.ncode;){for(;c<3;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}t.lens[ct[t.have++]]=l&7,l>>>=3,c-=3}for(;t.have<19;)t.lens[ct[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,S={bits:t.lenbits},A=jt(Zr,t.lens,0,19,t.lencode,0,t.work,S),t.lenbits=S.bits,A){e.msg="invalid code lengths set",t.mode=D;break}t.have=0,t.mode=Ki;case Ki:for(;t.have<t.nlen+t.ndist;){for(;z=t.lencode[l&(1<<t.lenbits)-1],m=z>>>24,x=z>>>16&255,y=z&65535,!(m<=c);){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(y<16)l>>>=m,c-=m,t.lens[t.have++]=y;else{if(y===16){for(k=m+2;c<k;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(l>>>=m,c-=m,t.have===0){e.msg="invalid bit length repeat",t.mode=D;break}w=t.lens[t.have-1],d=3+(l&3),l>>>=2,c-=2}else if(y===17){for(k=m+3;c<k;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}l>>>=m,c-=m,w=0,d=3+(l&7),l>>>=3,c-=3}else{for(k=m+7;c<k;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}l>>>=m,c-=m,w=0,d=11+(l&127),l>>>=7,c-=7}if(t.have+d>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=D;break}for(;d--;)t.lens[t.have++]=w}}if(t.mode===D)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=D;break}if(t.lenbits=9,S={bits:t.lenbits},A=jt(Rn,t.lens,0,t.nlen,t.lencode,0,t.work,S),t.lenbits=S.bits,A){e.msg="invalid literal/lengths set",t.mode=D;break}if(t.distbits=6,t.distcode=t.distdyn,S={bits:t.distbits},A=jt(En,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,S),t.distbits=S.bits,A){e.msg="invalid distances set",t.mode=D;break}if(t.mode=pe,a===ue)break t;case pe:t.mode=_e;case _e:if(s>=6&&f>=258){e.next_out=o,e.avail_out=f,e.next_in=n,e.avail_in=s,t.hold=l,t.bits=c,Dr(e,h),o=e.next_out,r=e.output,f=e.avail_out,n=e.next_in,i=e.input,s=e.avail_in,l=t.hold,c=t.bits,t.mode===et&&(t.back=-1);break}for(t.back=0;z=t.lencode[l&(1<<t.lenbits)-1],m=z>>>24,x=z>>>16&255,y=z&65535,!(m<=c);){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(x&&!(x&240)){for(g=m,E=x,$=y;z=t.lencode[$+((l&(1<<g+E)-1)>>g)],m=z>>>24,x=z>>>16&255,y=z&65535,!(g+m<=c);){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}l>>>=g,c-=g,t.back+=g}if(l>>>=m,c-=m,t.back+=m,t.length=y,x===0){t.mode=qi;break}if(x&32){t.back=-1,t.mode=et;break}if(x&64){e.msg="invalid literal/length code",t.mode=D;break}t.extra=x&15,t.mode=Wi;case Wi:if(t.extra){for(k=t.extra;c<k;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Gi;case Gi:for(;z=t.distcode[l&(1<<t.distbits)-1],m=z>>>24,x=z>>>16&255,y=z&65535,!(m<=c);){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(!(x&240)){for(g=m,E=x,$=y;z=t.distcode[$+((l&(1<<g+E)-1)>>g)],m=z>>>24,x=z>>>16&255,y=z&65535,!(g+m<=c);){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}l>>>=g,c-=g,t.back+=g}if(l>>>=m,c-=m,t.back+=m,x&64){e.msg="invalid distance code",t.mode=D;break}t.offset=y,t.extra=x&15,t.mode=Xi;case Xi:if(t.extra){for(k=t.extra;c<k;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=D;break}t.mode=Yi;case Yi:if(f===0)break t;if(d=h-f,t.offset>d){if(d=t.offset-d,d>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=D;break}d>t.wnext?(d-=t.wnext,_=t.wsize-d):_=t.wnext-d,d>t.length&&(d=t.length),b=t.window}else b=r,_=o-t.offset,d=t.length;d>f&&(d=f),f-=d,t.length-=d;do r[o++]=b[_++];while(--d);t.length===0&&(t.mode=_e);break;case qi:if(f===0)break t;r[o++]=t.length,f--,t.mode=_e;break;case Ze:if(t.wrap){for(;c<32;){if(s===0)break t;s--,l|=i[n++]<<c,c+=8}if(h-=f,e.total_out+=h,t.total+=h,t.wrap&4&&h&&(e.adler=t.check=t.flags?F(t.check,r,h,o-h):Pt(t.check,r,h,o-h)),h=f,t.wrap&4&&(t.flags?l:tn(l))!==t.check){e.msg="incorrect data check",t.mode=D;break}l=0,c=0}t.mode=Ji;case Ji:if(t.wrap&&t.flags){for(;c<32;){if(s===0)break t;s--,l+=i[n++]<<c,c+=8}if(t.wrap&4&&l!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=D;break}l=0,c=0}t.mode=Qi;case Qi:A=jr;break t;case D:A=Tn;break t;case Nn:return An;case Dn:default:return P}return e.next_out=o,e.avail_out=f,e.next_in=n,e.avail_in=s,t.hold=l,t.bits=c,(t.wsize||h!==e.avail_out&&t.mode<D&&(t.mode<Ze||a!==Ni))&&Bn(e,e.output,e.next_out,h-e.avail_out),p-=e.avail_in,h-=e.avail_out,e.total_in+=p,e.total_out+=h,t.total+=h,t.wrap&4&&h&&(e.adler=t.check=t.flags?F(t.check,r,h,e.next_out-h):Pt(t.check,r,h,e.next_out-h)),e.data_type=t.bits+(t.last?64:0)+(t.mode===et?128:0)+(t.mode===pe||t.mode===Be?256:0),(p===0&&h===0||a===Ni)&&A===wt&&(A=Cr),A},qr=e=>{if(zt(e))return P;let a=e.state;return a.window&&(a.window=null),e.state=null,wt},Jr=(e,a)=>{if(zt(e))return P;let t=e.state;return t.wrap&2?(t.head=a,a.done=!1,wt):P},Qr=(e,a)=>{let t=a.length,i,r,n;return zt(e)||(i=e.state,i.wrap!==0&&i.mode!==we)?P:i.mode===we&&(r=1,r=Pt(r,a,t,0),r!==i.check)?Tn:(n=Bn(e,a,t,t),n?(i.mode=Nn,An):(i.havedict=1,wt))},ts=On,es=$n,is=Mn,ns=Gr,as=Fn,rs=Yr,ss=qr,os=Jr,ls=Qr,cs="pako inflate (from Nodeca project)",nt={inflateReset:ts,inflateReset2:es,inflateResetKeep:is,inflateInit:ns,inflateInit2:as,inflate:rs,inflateEnd:ss,inflateGetHeader:os,inflateSetDictionary:ls,inflateInfo:cs};function fs(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var hs=fs,Zn=Object.prototype.toString,{Z_NO_FLUSH:ds,Z_FINISH:us,Z_OK:Gt,Z_STREAM_END:Ue,Z_NEED_DICT:Ce,Z_STREAM_ERROR:ps,Z_DATA_ERROR:nn,Z_MEM_ERROR:_s}=Et;function Jt(e){this.options=xe.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});let a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),a.windowBits>=0&&a.windowBits<16&&!(e&&e.windowBits)&&(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&(a.windowBits&15||(a.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kn,this.strm.avail_out=0;let t=nt.inflateInit2(this.strm,a.windowBits);if(t!==Gt)throw new Error(bt[t]);if(this.header=new hs,nt.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=Wt.string2buf(a.dictionary):Zn.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&(t=nt.inflateSetDictionary(this.strm,a.dictionary),t!==Gt)))throw new Error(bt[t])}Jt.prototype.push=function(e,a){let t=this.strm,i=this.options.chunkSize,r=this.options.dictionary,n,o,s;if(this.ended)return!1;for(a===~~a?o=a:o=a===!0?us:ds,Zn.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),n=nt.inflate(t,o),n===Ce&&r&&(n=nt.inflateSetDictionary(t,r),n===Gt?n=nt.inflate(t,o):n===nn&&(n=Ce));t.avail_in>0&&n===Ue&&t.state.wrap>0&&e[t.next_in]!==0;)nt.inflateReset(t),n=nt.inflate(t,o);switch(n){case ps:case nn:case Ce:case _s:return this.onEnd(n),this.ended=!0,!1}if(s=t.avail_out,t.next_out&&(t.avail_out===0||n===Ue))if(this.options.to==="string"){let f=Wt.utf8border(t.output,t.next_out),l=t.next_out-f,c=Wt.buf2string(t.output,f);t.next_out=l,t.avail_out=i-l,l&&t.output.set(t.output.subarray(f,f+l),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(n===Gt&&s===0)){if(n===Ue)return n=nt.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Jt.prototype.onData=function(e){this.chunks.push(e)};Jt.prototype.onEnd=function(e){e===Gt&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=xe.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ai(e,a){let t=new Jt(a);if(t.push(e),t.err)throw t.msg||bt[t.err];return t.result}function gs(e,a){return a=a||{},a.raw=!0,ai(e,a)}var bs=Jt,ms=ai,ws=gs,zs=ai,xs=Et,ys={Inflate:bs,inflate:ms,inflateRaw:ws,ungzip:zs,constants:xs},{Deflate:Rs,deflate:Ss,deflateRaw:Es,gzip:Ts}=Ar,{Inflate:As,inflate:vs,inflateRaw:Ns,ungzip:Ds}=ys;var Ln=Ss;var jn=vs;var Cn=(()=>{class e{event(t,i){ui.production&&gtag("event",t,{event_category:i})}static \u0275fac=function(i){return new(i||e)};static \u0275prov=xt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Vn=(()=>{class e{http=K(fi);store=K(re);translateSvc=K(fe);cacheData={};cacheHash={};cacheI18n={};initialize(){Mt([this.store.select(tt.selectModId),this.translateSvc.lang$]).subscribe(([t])=>{this.requestData(t).subscribe()})}requestData(t){let i,r,n;this.cacheData[t]||(this.cacheData[t]=this.http.get(`data/${t}/data.json`).pipe(J(h=>i=h),ne()));let o=this.cacheData[t];this.cacheHash[t]||(this.cacheHash[t]=this.http.get(`data/${t}/hash.json`).pipe(J(h=>r=h),ne()));let s=this.cacheHash[t],f=this.translateSvc.currentLang,l=`${t}-${f}`,c=f==="en",p;return c?p=Ie(null):(this.cacheI18n[l]||(this.cacheI18n[l]=this.http.get(`data/${t}/i18n/${f}.json`).pipe(oi(()=>(console.warn(`No localization file found for ${l}`),Ie(null))),J(h=>n=h??void 0),ne())),p=this.cacheI18n[l]),Mt([o,s,p]).pipe(J(()=>{(i||r||n)&&this.store.dispatch(oe.loadMod({id:t,i18nId:l,data:i,hash:r,i18n:n}))}))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=xt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var M="?",j="=",v="_",W="~",N="*",Nt="1",Hn="0",U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-.",Se=U.length,ks=U.split("").reduce((e,a,t)=>(e[a]=t,e),{}),Is=75,u=function(e){return e.Version="v",e.Mod="b",e.Objectives="p",e.RecipeObjectives="q",e.Items="i",e.Recipes="r",e.Machines="f",e.Modules="m",e.Beacons="e",e.Settings="s",e.Zip="z",e}(u||{}),O=function(e){return e.Version0="0",e.Version1="1",e.Version2="2",e.Version3="3",e.Version4="4",e.Version5="5",e.Version6="6",e.Version7="7",e.Version8="8",e.Version9="9",e.Version10="10",e}(O||{}),ve=function(e){return e.ExpensiveDeprecation="The expensive setting has been removed. Please use or request an expensive data set instead.",e.LimitStepDeprecation="Limit steps have been replaced by limit objectives. Results may differ if using multiple objectives as limits apply to all objectives.",e}(ve||{}),so=(()=>{class e{router=K(di);analyticsSvc=K(Cn);store=K(re);translateSvc=K(fe);contentSvc=K(mi);dataSvc=K(Vn);zip;zipConfig=ci(this.empty);base64codes;version=O.Version10;zipTail={bare:`&${u.Version}=${this.version}`,hash:`&${u.Version}${this.version}`};first=!0;ready$=new ke;fixV8ExcludedRecipes$=new ke;get empty(){return{bare:"",hash:""}}get emptyRecipeSettingsInfo(){return{idMap:{},list:[]}}get emptyMachineSettings(){return{moduleMap:{},beaconMap:{}}}constructor(){this.base64codes=new Uint8Array(256);for(let i=0;i<256;i++)this.base64codes[i]=255;for(let i=0;i<U.length;i++)this.base64codes[U.charCodeAt(i)]=i;this.base64codes[95]=0,this.fixV8ExcludedRecipes$.pipe(ae(()=>this.store.select(tt.selectMod).pipe(ie(i=>i?.defaults),_i(),ft())),ae(()=>Mt({recipesRaw:this.store.select(ce.recipesState),recipesState:this.store.select(ce.selectRecipesState)}).pipe(ft())),J(({recipesRaw:i,recipesState:r})=>{let n=[];for(let o of Object.keys(r))r[o].excluded&&!i[o]?.excluded&&n.push({id:o,value:!1,def:!0});this.store.dispatch(ce.setExcludedBatch({values:n}))})).subscribe()}initialize(){this.router.events.subscribe(t=>this.updateState(t)),this.ready$.pipe(ft(),J(()=>this.dataSvc.initialize()),ae(()=>this.store.select(bi.selectZipState)),li(0),J(t=>this.updateUrl(t.objectives,t.itemsState,t.recipesState,t.machinesState,t.settings))).subscribe(),this.store.select(le.selectStates).pipe(ft()).subscribe(t=>this.migrateOldStates(t))}migrateOldStates(t){if(Object.keys(t).every(r=>le.initialState.states[r]!=null))return;let i=Dt({},t);for(let r of Object.keys(i)){let n=i[r];if(typeof n!="string")continue;let o=this.getGameFromState(n);i=ee(Dt({},i),{[o]:ee(Dt({},i[o]),{[r]:n})}),delete i[r]}this.store.dispatch(le.setStates({states:i}))}getGameFromState(t){let i=this.getModIdFromState(t);return this.getGameFromModId(i)}getModIdFromState(t){if(t.startsWith("z=")){let i=t.match("z=(.+?)(&|$)");if(i==null)return;let r=i[1],o=this.inflateSafe(r).match("(&|^)b(.*?)(&|$)");if(o==null)return;let s=o[2];return this.parseNString(s,ut.modHash)}else{let i=t.match("s=(.+?)(&|$)");return i?.[1]}}getGameFromModId(t){return t==null?Re.Factorio:ut.mods.find(i=>i.id===t)?.game??Re.Factorio}updateUrl(t,i,r,n,o){this.zipState(t,i,r,n,o).subscribe(s=>{this.zip=this.getHash(s);let f=this.router.url.split("#"),l=`${f[0].split("?")[0]}?${this.zip}${f[1]&&`#${f[1]}`||""}`;this.router.navigateByUrl(l),!l.startsWith("/?")&&!l.startsWith("/wizard")&&(gi.routerState=l)})}zipState(t,i,r,n,o){return this.store.select(oe.selectHash).pipe(ie(s=>s[o.modId]),si(s=>s!=null),ft(),ie(s=>{let f=this.zipModulesBeacons(t,r,n,s),l=Object.keys(t.entities).map(p=>t.entities[p]);this.zipObjectives(f,l,s);let c=this.zipDiffString(o.modId,tt.initialState.modId);return c.length&&(f.config.hash+=`&${u.Mod}${this.getId(ut.modHash.indexOf(c))}`),this.zipItems(f,i,s),this.zipRecipes(f,r,s),this.zipMachines(f,n,s),this.zipSettings(f,o,s),this.zipConfig.set(f.config),f}))}stepHref(t,i,r){if(r==null)return null;let n;if(t.itemId!=null&&t.items!=null?n=[{id:"0",targetId:t.itemId,value:t.items,unit:Ot.Items,type:Q.Output}]:t.recipeId!=null&&t.machines!=null&&(n=[{id:"0",targetId:t.recipeId,value:t.machines,unit:Ot.Machines,type:Q.Output}]),n==null)return null;let o={objectives:this.empty,config:i,objectiveSettings:this.emptyMachineSettings,recipeSettings:this.emptyMachineSettings,machineSettings:this.emptyMachineSettings};return this.zipObjectives(o,n,r),"list?"+this.getHash(o)}getHash(t){let i=t.objectives.bare+t.config.bare+this.zipTail.bare;i.startsWith("&")&&(i=i.substring(1));let r=t.objectives.hash+t.config.hash+this.zipTail.hash,n=`z=${this.bytesToBase64(Ln(r))}&${u.Version}=${this.version}`;return i.length<Math.max(n.length,Is)?i:n}getParams(t){let i=t.split("&"),r=i[0][1]==="="?2:1;return i.reduce((o,s)=>(o[s[0]]=s.substring(r),o),{})}updateState(t){try{if(t instanceof hi){let[i,...r]=t.urlAfterRedirects.split("#"),n=r.join("#"),[o,...s]=i.split("?"),f=s.join("?");if(!f.length&&n.length>1&&n[1]==="="&&(f=n),f&&this.zip!==f){let l=f,c=!0,p=new URLSearchParams(l).get(u.Zip);if(p!=null){let b=p.replace(/\+/g,"-").replace(/\//g,".").replace(/=/g,"_");l=this.inflateSafe(b),c=!1}l=l.replace(/,/g,v).replace(/\+/g,W),l=l.replace(/\*n\*/g,`*${M}*`).replace(/\*e\*/g,`*${j}*`);let h=this.getParams(l),d=[];({params:h,warnings:d,isBare:c}=this.migrate(h,c)),this.displayWarnings(d);let _={};if(c){let b=this.unzipModules(h),z=this.unzipBeacons(h,b);h[u.Objectives]&&(_.objectivesState=this.unzipObjectives(h,b,z)),h[u.Items]&&(_.itemsState=this.unzipItems(h)),h[u.Recipes]&&(_.recipesState=this.unzipRecipes(h,b,z)),h[u.Machines]&&(_.machinesState=this.unzipMachines(h,b,z)),h[u.Settings]&&(_.settingsState=this.unzipSettings(h)),this.dispatch(l,_)}else{let b=this.parseNString(h[u.Mod],ut.modHash);this.dataSvc.requestData(b||tt.initialState.modId).subscribe(([z,m])=>{let x=this.unzipModules(h,m),y=this.unzipBeacons(h,x,m);h[u.Objectives]&&(_.objectivesState=this.unzipObjectives(h,x,y,m)),h[u.Items]&&(_.itemsState=this.unzipItems(h,m)),h[u.Recipes]&&(_.recipesState=this.unzipRecipes(h,x,y,m)),h[u.Machines]&&(_.machinesState=this.unzipMachines(h,x,y,m)),h[u.Settings]&&(_.settingsState=this.unzipSettings(h,m)),b!=null&&(_.settingsState=ee(Dt({},_.settingsState),{modId:b})),this.dispatch(l,_)})}}else this.ready$.next()}}catch(i){throw console.error(i),new Error("RouterService failed to parse url")}}dispatch(t,i){this.zip=t,this.store.dispatch(pi.load({partial:i})),this.ready$.next()}migrate(t,i){let r=[],n=t[u.Version]??O.Version0;this.analyticsSvc.event("unzip_version",n),(i||n===O.Version0)&&Object.keys(t).forEach(s=>{t[s]=decodeURIComponent(t[s])});let o={params:t,warnings:r,isBare:i};switch(n){case O.Version0:return this.migrateV0(o);case O.Version1:return this.migrateV1(o);case O.Version2:return this.migrateV2(o);case O.Version3:return this.migrateV3(o);case O.Version4:return this.migrateV4(o);case O.Version5:return this.migrateV5(o);case O.Version6:return this.migrateV6(o);case O.Version7:return this.migrateV7(o);case O.Version8:return this.migrateV8(o);case O.Version9:return this.migrateV9(o);default:return{params:t,warnings:r,isBare:i}}}migrateV0(t){let{params:i}=t;if(i[u.Settings]){let n=i[u.Settings].split(N),o=this.parseString(n[0]);o=o&&ut.modHash[ut.modHashV0.indexOf(o)],o=o??M;let s=this.parseNumber(n[6])??tt.initialState.displayRate,f=this.zipDiffDisplayRate(s,tt.initialState.displayRate);i[u.Settings]=this.zipFields([o,f,i[u.Mod],n[1],n[3],n[4],n[5],n[7],n[8],n[10],n[9],n[2],n[11],n[12]])}else i[u.Mod]&&(i[u.Settings]=this.zipFields([M,M,i[u.Mod]]));return i[u.Version]=O.Version1,this.migrateV1(t)}migrateV1(t){let{params:i,warnings:r}=t;if(i[u.Settings]){let o=i[u.Settings].split(N),s=11;if(o.length>s){let f=o.splice(s,1);this.parseBool(f[0])&&r.push(ve.ExpensiveDeprecation)}i[u.Settings]=this.zipFields(o)}return i[u.Version]=O.Version4,this.migrateV4(t)}migrateV2(t){let{params:i}=t;if(i[u.Recipes]){let n=i[u.Recipes].split(v),o=[],s=3;for(let f of n){let l=f.split(N);if(l.length>s){let c=this.parseNNumber(l[s])?.toString();l[s]=this.zipTruthyString(c)}o.push(this.zipFields(l))}i[u.Recipes]=o.join(v)}if(i[u.Machines]){let n=i[u.Machines].split(v),o=[],s=2;for(let f of n){let l=f.split(N);if(l.length>s){let c=this.parseNNumber(l[s])?.toString();l[s]=this.zipTruthyString(c)}o.push(this.zipFields(l))}i[u.Machines]=o.join(v)}return i[u.Version]=O.Version3,this.migrateV3(t)}migrateV3(t){let{params:i,warnings:r}=t;if(i[u.Settings]){let o=i[u.Settings].split(N),s=10;if(o.length>s){let f=o.splice(s,1);this.parseBool(f[0])&&r.push(ve.ExpensiveDeprecation)}i[u.Settings]=this.zipFields(o)}return i[u.Version]=O.Version5,this.migrateV5(t)}migrateInlineBeaconsSection(t,i,r,n){if(t[i]){let s=t[i].split(v),f=[];for(let l of s.map(c=>c.split(N))){let c=r+1,p=c+1,h=p+3;if(l.length>r){let d,_,b;l.length>h&&(b=l.splice(h,1)[0]),l.length>p&&(d=l.splice(p,1)[0]),l.length>c&&(_=l.splice(c,1)[0]);let z=l[r];l[r]=this.zipTruthyArray([n.length]),n.push(this.zipFields([z,this.zipTruthyString(_),this.zipTruthyString(d),this.zipTruthyString(b)]))}f.push(this.zipFields(l))}t[i]=f.join(v)}}migrateInlineBeacons(t){let i=[];return this.migrateInlineBeaconsSection(t.params,u.RecipeObjectives,4,i),this.migrateInlineBeaconsSection(t.params,u.Recipes,3,i),i.length&&(t.params[u.Beacons]=i.join(v)),t}migrateV4(t){return t=this.migrateInlineBeacons(t),t.params[u.Version]=O.Version6,this.migrateV6(t)}migrateV5(t){return t=this.migrateInlineBeacons(t),t.params[u.Version]=O.Version7,this.migrateV7(t)}migrateInsertField(t,i,r){if(t[i]){let n=t[i].split(v);for(let o=0;o<n.length;o++){let s=n[o].split(N);s.length>r&&(s.splice(r,0,""),n[o]=this.zipFields(s))}t[i]=n.join(v)}}migrateDeleteField(t,i,r){if(t[i]){let n=t[i].split(v);for(let o=0;o<n.length;o++){let s=n[o].split(N);s.length>r&&(s.splice(r,1),n[o]=this.zipFields(s))}t[i]=n.join(v)}}migrateMoveUpField(t,i,r){if(t[i]!=null){let n=t[i];for(t.splice(i,1),t.length>r&&t.splice(r,0,"");t.length<=r;)t.push("");t[r]=n}}migrateToV8(t){let{params:i,isBare:r}=t,n=!1;if(this.migrateInsertField(i,u.RecipeObjectives,2),i[u.Objectives]){let o=i[u.Objectives].split(v),s=[...o];for(let f=0;f<o.length;f++){let c=o[f].split(N);if(c[2]==="3")if(r){let p=i[u.RecipeObjectives]?i[u.RecipeObjectives].split(v):[];if(c.length>3){let h=[c[3],c[1],Q.Limit.toString()],d=[c[0],"1",Q.Maximize.toString()];p.push(this.zipFields(d)),p.push(this.zipFields(h)),n=!0}else p.push(this.zipFields([c[0],c[1]]));s.splice(f,1),i[u.RecipeObjectives]=p.join(v)}else c[2]="0",s[f]=this.zipFields(c);else if(c.length>3){let p=[c[3],c[1],c[2],Q.Limit.toString()],h=[c[0],"1","",Q.Maximize.toString()];s[f]=this.zipFields(h),s.push(this.zipFields(p)),n=!0}}n&&t.warnings.push(ve.LimitStepDeprecation),i[u.Objectives]=s.join(v)}if(this.migrateDeleteField(i,u.Items,4),this.migrateInsertField(i,u.Recipes,1),i[u.Settings]){let o=i[u.Settings].split(N),s=r?1:0;if(o.length>2+s){let f=this.parseArray(o[2+s]);if(f){let l=i[u.Recipes],c=l?l.split(v):[];for(let p of f){let h=!1;for(let d=0;d<c.length;d++){let _=c[d].split(N);_[0]===p&&(h=!0,_[1]=Nt,c[d]=this.zipFields(_))}h||c.push(this.zipFields([p,Nt]))}i[u.Recipes]=c.join(v),this.fixV8ExcludedRecipes$.next()}o.splice(2+s,1)}o.splice(s,0,""),this.migrateMoveUpField(o,16+s,20+s),this.migrateMoveUpField(o,15+s,19+s),this.migrateMoveUpField(o,14+s,18+s),this.migrateMoveUpField(o,13+s,17+s),i[u.Settings]=this.zipFields(o)}return i[u.Version]=O.Version8,t}migrateV6(t){return t.isBare=!0,this.migrateV8(this.migrateToV8(t))}migrateV7(t){return t.isBare=!1,this.migrateV8(this.migrateToV8(t))}migrateV8(t){let{params:i}=t;if(i[u.RecipeObjectives]){let r=[];i[u.Objectives]&&(r=i[u.Objectives].split(v));let n=i[u.RecipeObjectives].split(v);for(let o=0;o<n.length;o++){let s=n[o].split(N),f=this.zipFields([s[0],s[1],"3",s[2],s[3],s[4],s[5],s[6],s[7]]);r.push(f)}i[u.RecipeObjectives]="",i[u.Objectives]=r.join(v)}return this.migrateV9(t)}migrateInlineModulesSection(t,i,r,n){if(t[i]){let s=t[i].split(v),f=[];for(let l of s.map(c=>c.split(N))){if(l.length>r){let c=l[r],p=this.parseArray(c);if(p==null)continue;let h=new Map;for(let _ of p){let b=h.get(_)??0;h.set(_,b+1)}let d=Array.from(h.keys()).map((_,b)=>n.length+b);l[r]=this.zipTruthyArray(d);for(let _ of h.keys())n.push(this.zipFields([ht(h.get(_)?.toString(),""),_]))}f.push(this.zipFields(l))}t[i]=f.join(v)}}migrateV9(t){let{params:i}=t,r=[];if(this.migrateInlineModulesSection(t.params,u.Beacons,1,r),this.migrateInlineModulesSection(t.params,u.Recipes,3,r),this.migrateInlineModulesSection(t.params,u.Objectives,5,r),t.params[u.Machines]){let o=i[u.Machines].split(v),s=[],f=t.params[u.Beacons]?t.params[u.Beacons].split(v):[],l=2,c=l+1,p=c+1;o.map(h=>h.split(N)).forEach((h,d)=>{if(d===0&&h[0]===Nt&&(h[0]=j),this.migrateMoveUpField(h,5,6),h[0]!==j&&h[0]!==""&&h.length>1){let _=h[1];if(_){let b=_.split(W)[0];h[1]=this.zipTruthyArray([r.length]),r.push(this.zipFields(["",b]))}}if(h.length>2){let _,b;if(h.length>p&&(_=h.splice(p,1)[0]),h.length>c){let m=h.splice(c,1)[0];if(m){let x=m.split(W)[0];b=[r.length],r.push(this.zipFields(["",x]))}}let z=h[l];h[l]=this.zipTruthyArray([f.length]),f.push(this.zipFields([z,this.zipTruthyArray(b),this.zipTruthyString(_)]))}s.push(this.zipFields(h))}),f.length&&(t.params[u.Beacons]=f.join(v)),t.params[u.Machines]=s.join(v)}if(r.length&&(t.params[u.Modules]=r.join(v)),i[u.Settings]){let n=i[u.Settings].split(N),o=t.isBare?5:4;if(n.length>o){let s=n.splice(o,1)[0];if(i[u.Machines]){let f=i[u.Machines].split(v).map(c=>c.split(N)),l=f.find(c=>c[0]===j||c[0]==="");if(l){for(;l.length<4;)l.push("");l[3]=s}else f.unshift(["","","",s]);i[u.Machines]=f.map(c=>this.zipFields(c)).join(v)}else i[u.Machines]=["","","",s].join(N);i[u.Settings]=n.join(N)}}return i[u.Version]=O.Version10,t}displayWarnings(t){this.translateSvc.multi(["app.migrationWarning","OK"]).pipe(ft()).subscribe(([i,r])=>{for(let n of t)this.contentSvc.confirm({message:n,header:i,acceptLabel:r,rejectVisible:!1})})}zipModulesBeacons(t,i,r,n){let o=this.emptyRecipeSettingsInfo,s=this.emptyRecipeSettingsInfo,f=this.zipMachineSettings(t.entities,o,s,n),l=this.zipMachineSettings(i,o,s,n),c=this.zipMachineSettings(r.entities,o,s,n);if(r.beacons){let d=this.beaconModuleMap(r.beacons,o,n);c.beaconMap[""]=this.zipBeaconArray(r.beacons,d,s,n)}let p=this.empty;return[[u.Modules,o.list],[u.Beacons,s.list]].forEach(([d,_])=>{let b=this.zipList(_);b.bare.length&&(p.bare+=`&${d}=${b.bare}`,p.hash+=`&${d}${b.hash}`)}),{objectives:this.empty,config:p,objectiveSettings:f,recipeSettings:l,machineSettings:c}}zipMachineSettings(t,i,r,n){let o=this.emptyMachineSettings;for(let s of Object.keys(t)){let f=t[s];if(f.modules!=null&&(o.moduleMap[s]=this.zipModuleArray(f.modules,i,n)),f.beacons!=null){let l=this.beaconModuleMap(f.beacons,i,n);o.beaconMap[s]=this.zipBeaconArray(f.beacons,l,r,n)}}return o}beaconModuleMap(t,i,r){return t.map(n=>{if(n.modules!=null)return this.zipModuleArray(n.modules,i,r)})}zipModuleArray(t,i,r){return t.map(n=>{let o=this.zipTruthyString(n.count?.toString()),s={bare:this.zipFields([o,this.zipTruthyString(n.id)]),hash:this.zipFields([o,this.zipTruthyNString(n.id,r.modules)])};return i.idMap[s.bare]==null&&(i.idMap[s.bare]=i.list.length,i.list.push(s)),i.idMap[s.bare]})}unzipModules(t,i){return t[u.Modules]?t[u.Modules].split(v).map(n=>{let o=n.split(N),s=0,f={count:this.parseRational(this.parseString(o[s++])),id:this.parseString(o[s++],i?.modules)};return this.deleteEmptyKeys(f),f}):[]}zipBeaconArray(t,i,r,n){return t.map((o,s)=>{let f=this.zipTruthyString(o.count?.toString()),l=this.zipTruthyArray(i[s]),c=this.zipTruthyString(o.total?.toString()),p={bare:this.zipFields([f,l,this.zipTruthyString(o.id),c]),hash:this.zipFields([f,l,this.zipTruthyNString(o.id,n.beacons),c])};return r.idMap[p.bare]==null&&(r.idMap[p.bare]=r.list.length,r.list.push(p)),r.idMap[p.bare]})}unzipBeacons(t,i,r){return t[u.Beacons]?t[u.Beacons].split(v).map(o=>{let s=o.split(N),f=0,l={count:this.parseRational(this.parseString(s[f++])),modules:this.parseArray(s[f++])?.map(c=>ht(i[Number(c)],{})),id:this.parseString(s[f++],r?.beacons),total:this.parseRational(this.parseString(s[f++]))};return this.deleteEmptyKeys(l),l}):[]}zipObjectives(t,i,r){let n=this.zipList(i.map(o=>{let s=this.zipDiffString(o.value.toString(),"1"),f=this.zipDiffNumber(o.unit,Ot.Items),l=this.zipDiffNumber(o.type,Q.Output),c=this.zipTruthyArray(t.objectiveSettings.moduleMap[o.id]),p=this.zipTruthyArray(t.objectiveSettings.beaconMap[o.id]),h=this.zipTruthyNumber(o.overclock),d=this.zipTruthyBool(o.checked);return{bare:this.zipFields([o.targetId,s,f,l,this.zipTruthyString(o.machineId),c,p,h,d,this.zipTruthyString(o.fuelId)]),hash:this.zipFields([this.zipTruthyNString(o.targetId,Ee(o)?r.recipes:r.items),s,f,l,this.zipTruthyNString(o.machineId,r.machines),c,p,h,d,this.zipTruthyNString(o.fuelId,r.fuels)])}}));n.bare.length&&(t.objectives.bare+=`${u.Objectives}=${n.bare}`,t.objectives.hash+=`${u.Objectives}${n.hash}`)}unzipObjectives(t,i,r,n){let o=t[u.Objectives].split(v),s=[],f={},l=1;for(let c of o){let p=c.split(N),h=0,d=l.toString(),_={id:l.toString(),targetId:p[h++],value:ht(this.parseRational(p[h++]),se.one),unit:this.parseNumber(p[h++])??Ot.Items,type:this.parseNumber(p[h++])??Q.Output,machineId:this.parseString(p[h++],n?.machines),modules:this.parseArray(p[h++])?.map(b=>i[Number(b)]??{}),beacons:this.parseArray(p[h++])?.map(b=>r[Number(b)]??{}),overclock:this.parseRational(p[h++]),checked:this.parseBool(p[h++]),fuelId:this.parseString(p[h++],n?.fuels)};n&&(_.targetId=ht(this.parseNString(_.targetId,Ee(_)?n.recipes:n.items),"")),this.deleteEmptyKeys(_),s.push(d),f[d]=_,l++}return{ids:s,index:l,entities:f}}zipItems(t,i,r){let n=this.zipList(Object.keys(i).map(o=>{let s=i[o],f=this.zipTruthyBool(s.excluded),l=this.zipTruthyBool(s.checked);return{bare:this.zipFields([o,f,this.zipTruthyString(s.beltId),this.zipTruthyString(s.wagonId),l]),hash:this.zipFields([this.zipTruthyNString(o,r.items),f,this.zipTruthyNString(s.beltId,r.belts),this.zipTruthyNString(s.wagonId,r.wagons),l])}}));n.bare.length&&(t.config.bare+=`&${u.Items}=${n.bare}`,t.config.hash+=`&${u.Items}${n.hash}`)}unzipItems(t,i){let r=t[u.Items].split(v),n={};for(let o of r){let s=o.split(N),f=0,l=ht(this.parseString(s[f++],i?.items),""),c={excluded:this.parseBool(s[f++]),beltId:this.parseString(s[f++],i?.belts),wagonId:this.parseString(s[f++],i?.wagons),checked:this.parseBool(s[f++])};this.deleteEmptyKeys(c),n[l]=c}return n}zipRecipes(t,i,r){let n=this.zipList(Object.keys(i).map(o=>{let s=i[o],f=this.zipTruthyBool(s.excluded),l=this.zipTruthyArray(t.recipeSettings.moduleMap[o]),c=this.zipTruthyArray(t.recipeSettings.beaconMap[o]),p=this.zipTruthyNumber(s.overclock),h=this.zipTruthyNumber(s.cost),d=this.zipTruthyBool(s.checked);return{bare:this.zipFields([o,f,this.zipTruthyString(s.machineId),l,c,p,h,d,this.zipTruthyString(s.fuelId)]),hash:this.zipFields([this.zipTruthyNString(o,r.recipes),f,this.zipTruthyNString(s.machineId,r.machines),l,c,p,h,d,this.zipTruthyNString(s.fuelId,r.fuels)])}}));n.bare.length&&(t.config.bare+=`&${u.Recipes}=${n.bare}`,t.config.hash+=`&${u.Recipes}${n.hash}`)}unzipRecipes(t,i,r,n){let o=t[u.Recipes].split(v),s={};for(let f of o){let l=f.split(N),c=0,p=this.parseString(l[c++],n?.recipes)??"",h={excluded:this.parseBool(l[c++]),machineId:this.parseString(l[c++],n?.machines),modules:this.parseArray(l[c++])?.map(d=>i[Number(d)]??{}),beacons:this.parseArray(l[c++])?.map(d=>r[Number(d)]??{}),overclock:this.parseRational(l[c++]),cost:this.parseRational(l[c++]),checked:this.parseBool(l[c++]),fuelId:this.parseString(l[c++],n?.fuels)};this.deleteEmptyKeys(h),s[p]=h}return s}zipMachines(t,i,r){let n=i.ids?j:"",o=this.zipTruthyArray(t.machineSettings.beaconMap[""]),s=this.zipTruthyNumber(i.overclock),f=[{bare:this.zipFields([n,this.zipTruthyArray(i.moduleRankIds),o,this.zipTruthyArray(i.fuelRankIds),s]),hash:this.zipFields([n,this.zipTruthyNArray(i.moduleRankIds,r.modules),o,this.zipTruthyNArray(i.fuelRankIds,r.fuels),s])}];(i.ids??Object.keys(i.entities)).forEach(p=>{let h=i.entities[p]??{},d=this.zipTruthyArray(t.machineSettings.moduleMap[p]),_=this.zipTruthyArray(t.machineSettings.beaconMap[p]),b=this.zipTruthyNumber(h.overclock);f.push({bare:this.zipFields([p,d,_,this.zipTruthyString(h.fuelId),b]),hash:this.zipFields([this.zipTruthyNString(p,r.machines),d,_,this.zipTruthyNString(h.fuelId,r.fuels),b])})});let c=this.zipList(f);c.bare.length&&(t.config.bare+=`&${u.Machines}=${c.bare}`,t.config.hash+=`&${u.Machines}${c.hash}`)}unzipMachines(t,i,r,n){let o=t[u.Machines].split(v),s={entities:{}},f;for(let l=0;l<o.length;l++){let p=o[l].split(N),h=0,d=p[h++];l===0&&d===j&&(f=[],d=""),d&&n&&(d=ht(this.parseNString(d,n.machines),"")),d&&f&&f.push(d);let _=p[h++],b=this.parseArray(p[h++])?.map(x=>r[Number(x)]??{}),z=p[h++],m=this.parseRational(p[h++]);if(d){let x={modules:this.parseArray(_)?.map(y=>i[Number(y)]??{}),beacons:b,fuelId:this.parseString(z,n?.fuels),overclock:m};this.deleteEmptyKeys(x),Object.keys(x).length&&(s.entities[d]=x)}else{let x=this.parseArray(_,n?.modules),y=this.parseArray(z,n?.fuels);f!=null&&(s.ids=f),x!=null&&(s.moduleRankIds=x),b!=null&&(s.beacons=b),y!=null&&(s.fuelRankIds=y),m!=null&&(s.overclock=m)}}return s}zipSettings(t,i,r){let n=tt.initialState,o=this.zipDiffDisplayRate(i.displayRate,n.displayRate),s=this.zipDiffNumber(i.preset,n.preset),f=this.zipDiffNumber(i.inserterCapacity,n.inserterCapacity),l=this.zipDiffNumber(i.inserterTarget,n.inserterTarget),c=this.zipDiffRational(i.beaconReceivers,n.beaconReceivers),p=this.zipDiffBool(i.netProductionOnly,n.netProductionOnly),h=this.zipDiffRational(i.costs.factor,n.costs.factor),d=this.zipDiffRational(i.costs.machine,n.costs.machine),_=this.zipDiffRational(i.costs.unproduceable,n.costs.unproduceable),b=this.zipDiffRational(i.costs.excluded,n.costs.excluded),z=this.zipDiffRational(i.costs.surplus,n.costs.surplus),m=this.zipDiffRational(i.costs.maximize,n.costs.maximize),x=this.zipDiffBool(i.surplusMachinesOutput,n.surplusMachinesOutput),y=this.zipDiffRational(i.costs.footprint,n.costs.footprint),g={bare:this.zipFields([this.zipDiffString(i.modId,n.modId),this.zipDiffNullableArray(i.researchedTechnologyIds,n.researchedTechnologyIds),o,s,this.zipDiffString(i.beltId,n.beltId),this.zipDiffRational(i.flowRate,n.flowRate),this.zipDiffRational(i.miningBonus,n.miningBonus),this.zipDiffRational(i.researchBonus,n.researchBonus),f,l,this.zipDiffString(i.cargoWagonId,n.cargoWagonId),this.zipDiffString(i.fluidWagonId,n.fluidWagonId),this.zipDiffString(i.pipeId,n.pipeId),c,this.zipDiffString(i.proliferatorSprayId,n.proliferatorSprayId),p,this.zipDiffNumber(i.maximizeType,n.maximizeType),h,d,_,b,z,m,x,y]),hash:this.zipFields([this.zipDiffNullableNArray(i.researchedTechnologyIds,n.researchedTechnologyIds,r.technologies),o,s,this.zipDiffNString(i.beltId,n.beltId,r.belts),this.zipDiffNRational(i.flowRate,n.flowRate),this.zipDiffNRational(i.miningBonus,n.miningBonus),this.zipDiffNRational(i.researchBonus,n.researchBonus),f,l,this.zipDiffNString(i.cargoWagonId,n.cargoWagonId,r.wagons),this.zipDiffNString(i.fluidWagonId,n.fluidWagonId,r.wagons),this.zipDiffNString(i.pipeId,n.pipeId,r.belts),c,this.zipDiffNString(i.proliferatorSprayId,n.proliferatorSprayId,r.modules),p,this.zipDiffNNumber(i.maximizeType,n.maximizeType),h,d,_,b,z,m,x,y])};g.bare.length&&(t.config.bare+=`&${u.Settings}=${encodeURIComponent(g.bare)}`,t.config.hash+=`&${u.Settings}${g.hash}`)}unzipSettings(t,i){let n=t[u.Settings].split(N),o=0,s={modId:i==null?this.parseString(n[o++]):void 0,researchedTechnologyIds:this.parseNullableArray(n[o++],i?.technologies),displayRate:this.parseDisplayRate(n[o++]),preset:this.parseNumber(n[o++]),beltId:this.parseString(n[o++],i?.belts),flowRate:this.parseRational(n[o++],i!=null),miningBonus:this.parseRational(n[o++],i!=null),researchBonus:this.parseRational(n[o++],i!=null),inserterCapacity:this.parseNumber(n[o++]),inserterTarget:this.parseNumber(n[o++]),cargoWagonId:this.parseString(n[o++],i?.wagons),fluidWagonId:this.parseString(n[o++],i?.wagons),pipeId:this.parseString(n[o++],i?.belts),beaconReceivers:this.parseRational(n[o++]),proliferatorSprayId:this.parseString(n[o++],i?.modules),netProductionOnly:this.parseBool(n[o++]),maximizeType:this.parseNumber(n[o++],i!=null),costs:{factor:this.parseRational(n[o++]),machine:this.parseRational(n[o++]),unproduceable:this.parseRational(n[o++]),excluded:this.parseRational(n[o++]),surplus:this.parseRational(n[o++]),maximize:this.parseRational(n[o++])},surplusMachinesOutput:this.parseBool(n[o++])};return s.costs.footprint=this.parseRational(n[o++]),this.deleteEmptyKeys(s),s.costs&&this.deleteEmptyKeys(s.costs),s}zipList(t){return{bare:encodeURIComponent(t.map(i=>i.bare).join(v)),hash:t.map(i=>i.hash).join(v)}}zipFields(t){return t.join(N).replace(/\**$/,"")}zipTruthyString(t){return t??""}zipTruthyNumber(t){return t==null?"":t.toString()}zipTruthyBool(t){return t==null?"":t?Nt:Hn}zipTruthyArray(t){return t==null?"":t.length?t.join(W):j}zipTruthyNString(t,i){return t==null?"":this.getId(i.indexOf(t))}zipTruthyNArray(t,i){return t==null?"":t.length?t.map(r=>this.getId(i.indexOf(r))).join(W):j}zipDiffString(t,i){return t===i?"":t??M}zipDiffNumber(t,i){return t===i?"":t==null?M:t.toString()}zipDiffNRational(t,i){return this.zipDiffNNumber(t?.toNumber(),i?.toNumber())}zipDiffRational(t,i){return(t==null?i==null:i!=null&&t.eq(i))?"":t==null?M:t.toString()}zipDiffDisplayRate(t,i){if(t===i)return"";switch(t){case dt.PerSecond:return"0";case dt.PerMinute:return"1";case dt.PerHour:return"2";default:return M}}zipDiffBool(t,i){return t===i?"":t==null?M:t?Nt:Hn}zipDiffNullableArray(t,i){let r=t!=null?t.length>0?[...t].sort().join(W):j:M,n=i!=null?i.length>0?[...i].sort().join(W):j:M;return r===n?"":r}zipDiffNString(t,i,r){return t===i?"":t==null?M:this.getId(r.indexOf(t))}zipDiffNNumber(t,i){return t===i?"":t==null?M:this.getId(t)}zipDiffNullableNArray(t,i,r){let n=t!=null?t.length>0?t.map(s=>this.getId(r.indexOf(s))).sort().join(W):j:M,o=i!=null?i.length>0?i.map(s=>this.getId(r.indexOf(s))).sort().join(W):j:M;return n===o?"":n}parseString(t,i){if(i!=null)return this.parseNString(t,i);if(!(!t?.length||t===M))return t}parseBool(t){if(!(!t?.length||t===M))return t===Nt}parseNumber(t,i=!1){if(i)return this.parseNNumber(t);if(!(!t?.length||t===M))return Number(t)}parseRational(t,i=!1){if(i)return se(this.parseNNumber(t));if(!(!t?.length||t===M))return se(t)}parseDisplayRate(t){if(!(!t?.length||t===M))switch(t){case"0":return dt.PerSecond;case"1":return dt.PerMinute;case"2":return dt.PerHour;default:return}}parseArray(t,i){if(i)return this.parseNArray(t,i);if(!(!t?.length||t===M))return t===j?[]:t.split(W)}parseNullableArray(t,i){if(i)return this.parseNullableNArray(t,i);if(t?.length)return t===M?null:t===j?[]:t.split(W)}parseNString(t,i){let r=this.parseString(t);return r==null?r:i[this.getN(r)]}parseNNumber(t){if(!(!t?.length||t===M))return this.getN(t)}parseNArray(t,i){let r=this.parseArray(t);return r==null?r:r.map(n=>i[this.getN(n)])}parseNullableNArray(t,i){let r=this.parseNullableArray(t);return r==null?r:r.map(n=>i[this.getN(n)])}getId(t){return t/Se>=1?this.getId(Math.floor(t/Se))+this.getId(t%Se):U[t]}getN(t){let i=ks[t[0]];return t.length>1?(t=t.substring(1),i*Math.pow(Se,t.length)+this.getN(t)):i}getBase64Code(t){if(t>=this.base64codes.length)throw new Error("Unable to parse base64 string.");let i=this.base64codes[t];if(i===255)throw new Error("Unable to parse base64 string.");return i}bytesToBase64(t){let i="",r,n=t.length;for(r=2;r<n;r+=3)i+=U[t[r-2]>>2],i+=U[(t[r-2]&3)<<4|t[r-1]>>4],i+=U[(t[r-1]&15)<<2|t[r]>>6],i+=U[t[r]&63];return r===n+1&&(i+=U[t[r-2]>>2],i+=U[(t[r-2]&3)<<4],i+="__"),r===n&&(i+=U[t[r-2]>>2],i+=U[(t[r-2]&3)<<4|t[r-1]>>4],i+=U[(t[r-1]&15)<<2],i+="_"),i}inflateSafe(t){try{return this.inflate(t)}catch{console.warn("Router failed to parse url, checking for missing trailing characters...")}try{return this.inflateMend(t,"-")}catch{}try{return this.inflateMend(t,".")}catch{}return this.inflateMend(t,"_")}inflateMend(t,i){let r=this.inflate(t+i);if(!r)throw new Error("Failed to parse, generated empty string");return console.warn(`Router mended url by appending '${i}'`),r}inflate(t){return jn(this.base64ToBytes(t),{to:"string"})}base64ToBytes(t){if(t.length%4!==0)throw new Error("Unable to parse base64 string.");let i=t.indexOf("_");if(i!==-1&&i<t.length-2)throw new Error("Unable to parse base64 string.");let r=t.endsWith("__")?2:t.endsWith("_")?1:0,n=t.length,o=new Uint8Array(3*(n/4)),s;for(let f=0,l=0;f<n;f+=4,l+=3)s=this.getBase64Code(t.charCodeAt(f))<<18|this.getBase64Code(t.charCodeAt(f+1))<<12|this.getBase64Code(t.charCodeAt(f+2))<<6|this.getBase64Code(t.charCodeAt(f+3)),o[l]=s>>16,o[l+1]=s>>8&255,o[l+2]=s&255;return o.subarray(0,o.length-r)}deleteEmptyKeys(t){Object.keys(t).filter(i=>t[i]===void 0).forEach(i=>delete t[i])}static \u0275fac=function(i){return new(i||e)};static \u0275prov=xt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();export{Cn as a,Vn as b,so as c};
