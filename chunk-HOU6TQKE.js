import{a as Ue,b as We,c as ze,d as qe,e as Ht,g as Xe,h as Qe}from"./chunk-WRVXDDBD.js";import{a as Pe}from"./chunk-FEXYBCBM.js";import{b as kt}from"./chunk-BZJTALL7.js";import{a as je,b as De,c as Le,d as Ne,e as Ae,f as He,g as Dt}from"./chunk-SQPSMKDH.js";import{a as Rt,b as Pt}from"./chunk-72M5DBVA.js";import{b as Me,f as Fe,g as Ve,t as Re}from"./chunk-OHICTJP6.js";import{b as $t,c as Lt,d as Nt,e as Je,f as Ge,g as Ke,i as At}from"./chunk-6CZXYCWS.js";import{a as $e,b as jt}from"./chunk-ZRXVUBZD.js";import{f as Ft,g as Vt}from"./chunk-2WXIZ6PR.js";import{e as st,f as rt,h as ct,i as Mt,j as Ot}from"./chunk-4X5MC2QX.js";import{B as pt,n as it,y as ot,z as at}from"./chunk-VS6CH5KG.js";import{a as Bt,b as Oe,c as _t}from"./chunk-YH3U6NNS.js";import{$ as B,Ab as M,Ad as ke,Ba as r,D as le,E as pe,Ea as m,Ec as h,Fb as fe,Fd as Et,Ga as tt,Gc as S,Ha as de,Hd as K,Ia as O,Ib as xe,Ja as d,Ka as St,Kb as Xt,Kc as Y,La as me,Ma as N,Na as A,Nb as ge,Nc as bt,O as _e,Oa as _,Pa as s,Pc as we,Qa as C,Rc as G,S as R,T as Z,Ta as j,Tc as lt,Ua as F,Va as y,Vb as Se,W as D,Wa as a,Wb as ve,Xb as he,Zc as Tt,_ as E,ba as xt,bb as ue,cb as Ce,d as ie,db as I,eb as v,fb as w,fc as Ie,fd as Qt,gb as P,ha as se,ia as Jt,ib as vt,ic as be,jb as ht,kb as It,ld as Yt,m as oe,ma as re,mb as et,md as Ee,nb as Q,od as Be,pb as U,qa as p,qb as Kt,qc as Te,qd as yt,rc as ye,rd as wt,ud as W,v as ae,vb as nt,wb as c,wd as Ct,xa as Gt,xb as f,ya as ce,yb as T,za as gt,zb as ut}from"./chunk-VVQSH3YX.js";import{f as xn,h as gn,j as ne}from"./chunk-TWZW5B45.js";var Ye=xn((Zt,te)=>{"use strict";(function(e,o){typeof define=="function"&&define.amd?define([],o):typeof Zt<"u"?o():(o(),e.FileSaver={})})(Zt,function(){"use strict";function e(x,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\uFEFF",x],{type:x.type}):x}function o(x,g,k){var b=new XMLHttpRequest;b.open("GET",x),b.responseType="blob",b.onload=function(){u(b.response,g,k)},b.onerror=function(){console.error("could not download file")},b.send()}function t(x){var g=new XMLHttpRequest;g.open("HEAD",x,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function n(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(g)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(x,g,k){var b=i.URL||i.webkitURL,V=document.createElement("a");g=g||x.name||"download",V.download=g,V.rel="noopener",typeof x=="string"?(V.href=x,V.origin===location.origin?n(V):t(V.href)?o(x,g,k):n(V,V.target="_blank")):(V.href=b.createObjectURL(x),setTimeout(function(){b.revokeObjectURL(V.href)},4e4),setTimeout(function(){n(V)},0))}:"msSaveOrOpenBlob"in navigator?function(x,g,k){if(g=g||x.name||"download",typeof x!="string")navigator.msSaveOrOpenBlob(e(x,k),g);else if(t(x))o(x,g,k);else{var b=document.createElement("a");b.href=x,b.target="_blank",setTimeout(function(){n(b)})}}:function(x,g,k,b){if(b=b||open("","_blank"),b&&(b.document.title=b.document.body.innerText="downloading..."),typeof x=="string")return o(x,g,k);var V=x.type==="application/octet-stream",$=/constructor/i.test(i.HTMLElement)||i.safari,z=/CriOS\/[\d]+/.test(navigator.userAgent);if((z||V&&$||l)&&typeof FileReader<"u"){var L=new FileReader;L.onloadend=function(){var mt=L.result;mt=z?mt:mt.replace(/^data:[^;]*;/,"data:attachment/file;"),b?b.location.href=mt:location=mt,b=null},L.readAsDataURL(x)}else{var X=i.URL||i.webkitURL,qt=X.createObjectURL(x);b?b.location=qt:location.href=qt,b=null,setTimeout(function(){X.revokeObjectURL(qt)},4e4)}});i.saveAs=u.saveAs=u,typeof te<"u"&&(te.exports=u)})});var ee=gn(Ye());var Sn="text/csv;charset=UTF-8",vn=".csv",hn="text/json;charset=UTF-8",In=".json",bn=["Item","Items","Surplus","Inputs","Outputs","Targets","Belts","Belt","Wagons","Wagon","Recipe","Machines","Machine","Modules","Beacons","Power","Pollution"],Ze=(()=>{class e{constructor(){this.itemsSvc=R(Bt),this.recipeSvc=R(Et),this.recipesSvc=R(_t),this.settingsSvc=R(K),this.itemsState=this.itemsSvc.settings,this.recipesState=this.recipesSvc.settings,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset}stepsToCsv(t){let n=t.map(u=>this.stepToJson(u,t)),i=bn.filter(u=>n.some(x=>x[u]!=null)),l=n.map(u=>i.map(x=>u[x]).join(","));l.unshift(i.join(",")),l.unshift(`"${window.location.href}"`),this.saveAsCsv(l.join(`\r
`),"factoriolab_list")}flowToJson(t){this.saveAsJson(JSON.stringify(t),"factoriolab_flow")}saveAsCsv(t,n){(0,ee.saveAs)(new Blob([t],{type:Sn}),n+vn)}saveAsJson(t,n){(0,ee.saveAs)(new Blob([t],{type:hn}),n+In)}stepToJson(t,n){let i=this.columnsState(),l=this.itemsState(),u=this.recipesState(),x=this.data(),g={};if(t.itemId!=null){g.Item=t.itemId;let k=l[t.itemId];t.items!=null&&(g.Items="="+t.items.sub(t.surplus??S.zero).toString()),t.surplus!=null&&(g.Surplus="="+t.surplus.toString()),i.belts.show&&(t.belts!=null&&(g.Belts="="+t.belts.toString()),g.Belt=k.beltId),i.wagons.show&&(t.wagons!=null&&(g.Wagons="="+t.wagons.toString()),g.Wagon=k.wagonId)}if(t.recipeId!=null){g.Recipe=t.recipeId;let k=x.adjustedRecipe[t.recipeId],b=u[t.recipeId],V=Object.keys(k.in).map($=>{let z=n.find(L=>L.itemId===$);return[$,z?.parents?.[t.id]?.toString()??""]}).filter($=>$[1]).map($=>`${$[0]}:${$[1]}`).join(",");if(V&&(g.Inputs=`"${V}"`),b.machineId!=null){let $=x.machineEntities[b.machineId],z=this.recipeSvc.allowsModules(k,$);i.machines.show&&(t.machines!=null&&(g.Machines="="+t.machines.toString()),g.Machine=b.machineId,z&&b.modules!=null&&(g.Modules=`"${b.modules.filter(bt("count","id")).map(L=>`${L.count.toString()} ${L.id}`).join(",")}"`)),i.beacons.show&&z&&(g.Beacons=`"${Y(b.beacons?.map(L=>`${Y(L.count?.toString(),"")} ${Y(L.id,"")} (${Y(L.modules?.filter(bt("count","id")).map(X=>`${X.count.toString()} ${X.id}`).join(","),"")})`).join(","),"")}"`),i.power.show&&t.power!=null&&(g.Power="="+t.power.toString()),i.pollution.show&&t.pollution!=null&&(g.Pollution="="+t.pollution.toString())}}if(t.outputs!=null){let k=t.outputs,b=Object.keys(k).map(V=>`${V}:${k[V].toString()}`).join(",");g.Outputs=`"${b}"`}if(t.parents!=null){let k=t.parents,b=Object.keys(k).map(V=>n.find($=>$.id===V)).filter(we).filter(bt("recipeId")).map(V=>`${V.recipeId}:${k[V.id].toString()}`).join(",");g.Targets=`"${b}"`}return g}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=_e({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var tn=(()=>{class e{transform(t){return t}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"asStep",type:e,pure:!0,standalone:!0})}}return e})();var en={[Ct.Chest]:{[W.Capacity0]:[{id:h.Inserter,value:S(.83)},{id:h.LongHandedInserter,value:S(1.2)},{id:h.FastInserter,value:S(2.31)},{id:h.StackInserter,value:S(4.62)}],[W.Capacity2]:[{id:h.Inserter,value:S(1.67)},{id:h.LongHandedInserter,value:S(2.4)},{id:h.FastInserter,value:S(4.62)},{id:h.StackInserter,value:S(9.23)}],[W.Capacity7]:[{id:h.Inserter,value:S(2.5)},{id:h.LongHandedInserter,value:S(3.6)},{id:h.FastInserter,value:S(6.92)},{id:h.StackInserter,value:S(27.69)}]},[Ct.ExpressTransportBelt]:{[W.Capacity0]:[{id:h.Inserter,value:S(.83)},{id:h.LongHandedInserter,value:S(1.2)},{id:h.FastInserter,value:S(2.31)},{id:h.StackInserter,value:S(4.44)}],[W.Capacity2]:[{id:h.Inserter,value:S(1.64)},{id:h.LongHandedInserter,value:S(2.35)},{id:h.FastInserter,value:S(4.44)},{id:h.StackInserter,value:S(7.74)}],[W.Capacity7]:[{id:h.Inserter,value:S(2.43)},{id:h.LongHandedInserter,value:S(3.46)},{id:h.FastInserter,value:S(6.43)},{id:h.StackInserter,value:S(13.85)}]},[Ct.FastTransportBelt]:{[W.Capacity0]:[{id:h.Inserter,value:S(.83)},{id:h.LongHandedInserter,value:S(1.2)},{id:h.FastInserter,value:S(2.31)},{id:h.StackInserter,value:S(4.44)}],[W.Capacity2]:[{id:h.Inserter,value:S(1.64)},{id:h.LongHandedInserter,value:S(2.35)},{id:h.FastInserter,value:S(4.44)},{id:h.StackInserter,value:S(7.06)}],[W.Capacity7]:[{id:h.Inserter,value:S(2.37)},{id:h.LongHandedInserter,value:S(3.33)},{id:h.FastInserter,value:S(6)},{id:h.StackInserter,value:S(10.91)}]},[Ct.TransportBelt]:{[W.Capacity0]:[{id:h.Inserter,value:S(.83)},{id:h.LongHandedInserter,value:S(1.2)},{id:h.FastInserter,value:S(2.31)},{id:h.StackInserter,value:S(4.44)}],[W.Capacity2]:[{id:h.Inserter,value:S(1.64)},{id:h.LongHandedInserter,value:S(2.35)},{id:h.FastInserter,value:S(4.44)},{id:h.StackInserter,value:S(5.71)}],[W.Capacity7]:[{id:h.Inserter,value:S(2.25)},{id:h.LongHandedInserter,value:S(3.1)},{id:h.FastInserter,value:S(5.29)},{id:h.StackInserter,value:S(6.79)}]}};var nn=(()=>{class e{transform(t,n){if(t!=null){let i=en[n.inserterTarget][n.inserterCapacity]?.find(l=>l.value.gt(t)||l.id===h.StackInserter);return i==null?null:{id:i.id,value:t.div(i.value)}}return null}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"inserterSpeed",type:e,pure:!0,standalone:!0})}}return e})();var on=(()=>{class e{transform(t){return t==null?"":" ".repeat(4-t.length)+t}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"leftPad",type:e,pure:!0,standalone:!0})}}return e})();var q=(()=>{class e{static transform(t,n){if(n==null)return t.toFraction();if(n===-2)return Math.round(t.mul(S(100n)).toNumber()).toString();let l=t.toPrecision(n).toString();if(n>0){let u=S(1,Math.pow(10,n));t.gt(S.zero)&&t.lt(u)&&(l=`<${l}`);let x=l.split(".");if(x.length>1){if(x[1].length<n){let g=n-x[1].length;return l+"0".repeat(g)}}else return t.isInteger()?l+" ".repeat(n+1):l+"."+"0".repeat(n)}return l}transform(t,n){return e.transform(t,n)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"rate",type:e,pure:!0,standalone:!0})}}return e})();var an=(()=>{class e{transform(t,n,i){return i===h.Pumpjack?`${q.transform(t.mul(S(100n)),n!=null?Math.max(n-2,0):n)}%`:q.transform(t,n)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"machineRate",type:e,pure:!0,standalone:!0})}}return e})();var ln=(()=>{class e{transform(t,n){return t==null?!1:n!==Tt.DysonSphereProgram||t!==h.MiningMachine}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"machineShow",type:e,pure:!0,standalone:!0})}}return e})();var pn=(()=>{class e{transform(t,n){return n!==Tt.CaptainOfIndustry||t!==h.MineControlTower}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"machineShowRate",type:e,pure:!0,standalone:!0})}}return e})();var _n=(()=>{class e{transform(t,n,i=!1){if(t==null)return[];let l=t.map(u=>({label:n[u].name,value:u}));return i&&l.unshift({label:"None",value:h.Module}),l}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"options",type:e,pure:!0,standalone:!0})}}return e})();var sn=(()=>{class e{transform(t,n,i){switch(i){case Qt.GW:return`${q.transform(t.div(S(1000000n)),n)} GW`;case Qt.MW:return`${q.transform(t.div(S(1000n)),n)} MW`;default:return`${q.transform(t,n)} kW`}}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"power",type:e,pure:!0,standalone:!0})}}return e})();var rn=(()=>{class e{constructor(){this.recipesSvc=R(_t),this.routerSvc=R(kt),this.data=this.recipesSvc.adjustedDataset}transform(t,n){return ne(this,null,function*(){let i=t;if(i.recipeId){let l=this.data().adjustedRecipe[i.recipeId];l.isTechnology&&l.productivity&&t.items&&(i=G(t,{items:t.items.div(l.productivity)}))}return this.routerSvc.stepHref(i,n,this.data().hash)})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"stepHref",type:e,pure:!0,standalone:!0})}}return e})();var ft=(()=>{class e{static transform(t){return t.itemId??t.recipeObjectiveId??t.recipeId??t.id}transform(t){return e.transform(t)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"stepId",type:e,pure:!0,standalone:!0})}}return e})();function wn(e,o){if(e&1&&(_(0,"div",13),C(1,"i"),c(2,"iconSmClass"),s()),e&2){let t=o.$implicit;p(),O(f(2,2,t.value))}}function En(e,o){if(e&1&&C(0,"lab-tooltip",16),e&2){let t=a().$implicit,n=a(3);m("id",t.value)("type",n.type)}}function Bn(e,o){if(e&1&&(_(0,"div",14),C(1,"i"),c(2,"iconSmClass"),_(3,"div",15),v(4),s(),r(5,En,1,2,"ng-template",null,0,M),s()),e&2){let t=o.$implicit,n=I(6);m("pTooltip",n),p(),O(f(2,4,t.value)),p(3),P(" ",t.label," ")}}function kn(e,o){if(e&1&&C(0,"lab-tooltip",16),e&2){let t=a(),n=a(2);m("id",t)("type",n.type)}}function Mn(e,o){if(e&1){let t=F();_(0,"p-dropdown",10),y("onChange",function(i){E(t);let l=a(2);return B(l.setBelt(i.value))}),r(1,wn,3,4,"ng-template",11)(2,Bn,7,6,"ng-template",12)(3,kn,1,2,"ng-template",null,0,M),s()}if(e&2){let t=I(4),n=a(2);m("pTooltip",t)("ngModel",o)("options",n.type()==="belt"?n.options().belts:n.options().pipes)}}function On(e,o){if(e&1){let t=F();_(0,"lab-input-number",8),c(1,"translate"),y("setValue",function(i){E(t);let l=a();return B(l.setStack(i))}),s(),r(2,Mn,5,3,"p-dropdown",9)}if(e&2){let t,n,i=o,l=a();m("pTooltip",f(1,5,"beltOverlay.stackTooltip"))("value",(t=i==null?null:i.stack)!==null&&t!==void 0?t:l.rational.one)("minimum",l.rational.one)("maximum",l.maximum),p(2),d((n=i.beltId)?2:-1,n)}}var un=(()=>{class e extends He{constructor(){super(...arguments),this.settingsSvc=R(K),this.setValue=se(),this.settings=Gt(void 0),this.type=Gt("belt"),this.options=this.settingsSvc.options,this.rational=S,this.maximum=S(4n)}show(t,n,i){this.settings.set(G(n)),this.type.set(i),this._show(t)}setStack(t){this.settings.update(n=>G(n,{stack:t}))}setBelt(t){this.settings.update(n=>G(n,{beltId:t}))}save(){let t=this.settings();t!=null&&this.setValue.emit(t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=xt(e)))(i||e)}})()}static{this.\u0275cmp=Z({type:e,selectors:[["lab-belt-overlay"]],outputs:{setValue:"setValue"},standalone:!0,features:[gt,et],decls:10,vars:7,consts:[["tooltip",""],["appendTo","body",3,"onHide"],[1,"d-flex","flex-column","gap-2"],[1,"d-flex","flex-column"],[1,"p-inputgroup"],[1,"d-flex","gap-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined","p-button-sm","flex-grow-1",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-sm","p-button-secondary","flex-grow-1",3,"click","label"],["width","3rem","tooltipPosition","top",3,"setValue","pTooltip","value","minimum","maximum"],["labDropdownBase","icon",3,"pTooltip","ngModel","options"],["labDropdownBase","icon",3,"onChange","pTooltip","ngModel","options"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"d-flex"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],[3,"id","type"]],template:function(n,i){if(n&1&&(_(0,"p-overlayPanel",1),y("onHide",function(){return i.onHide()}),_(1,"div",2)(2,"div",3)(3,"div",4),r(4,On,3,7),s()(),_(5,"div",5)(6,"button",6),c(7,"translate"),y("click",function(){return i.hide()}),s(),_(8,"button",7),c(9,"translate"),y("click",function(){return i.hide(!0)}),s()()()()),n&2){let l;p(4),d((l=i.settings())?4:-1,l),p(2),m("label",f(7,3,"ok")),p(2),m("label",f(9,5,"cancel"))}},dependencies:[ct,st,rt,at,ot,it,Vt,Ft,Ne,Le,Ot,Mt,Ht,jt,Pe,Dt,pt],encapsulation:2,changeDetection:0})}}return e})();var Ut=class e{static{this.value=S(1n,3n)}transform(o){return o==null?e.value.toFraction():e.value.toPrecision(o).toString()}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275pipe=D({name:"precisionExample",type:e,pure:!0,standalone:!0})}};var Pn=()=>({width:"400px"}),jn=()=>({"400px":"100vw"});function Dn(e,o){e&1&&(_(0,"tr")(1,"th"),v(2),c(3,"translate"),s(),_(4,"th"),v(5),c(6,"translate"),s(),_(7,"th"),v(8),c(9,"translate"),s(),_(10,"th"),v(11),c(12,"translate"),s()()),e&2&&(p(2),w(f(3,4,"columns.visibility")),p(3),w(f(6,6,"columns.decimals")),p(3),w(f(9,8,"columns.fractions")),p(3),w(f(12,10,"columns.example")))}function $n(e,o){if(e&1){let t=F();_(0,"td")(1,"p-inputNumber",7),It("ngModelChange",function(i){E(t);let l=a().$implicit,u=a();return ht(u.editValue[l.value].precision,i)||(u.editValue[l.value].precision=i),B(i)}),s()(),_(2,"td",8)(3,"p-checkbox",9),y("onChange",function(i){E(t);let l=a().$implicit,u=a();return B(u.changeFraction(i.checked,l.value))}),s()(),_(4,"td"),v(5),c(6,"precisionExample"),s()}if(e&2){let t=a().$implicit,n=a();p(),m("min",0)("size",1)("showButtons",!0)("disabled",!n.editValue[t.value].show),vt("ngModel",n.editValue[t.value].precision),p(2),m("ngModel",n.editValue[t.value].precision==null)("binary",!0)("disabled",!n.editValue[t.value].show),p(2),P(" ",f(6,9,n.editValue[t.value].precision)," ")}}function Ln(e,o){e&1&&(_(0,"td",6)(1,"div",10),v(2),c(3,"translate"),s()()),e&2&&(p(2),w(f(3,1,"columns.notApplicable")))}function Nn(e,o){if(e&1){let t=F();_(0,"tr")(1,"td")(2,"p-checkbox",5),c(3,"translate"),It("ngModelChange",function(i){let l=E(t).$implicit,u=a();return ht(u.editValue[l.value].show,i)||(u.editValue[l.value].show=i),B(i)}),s()(),r(4,$n,7,11)(5,Ln,4,3,"td",6),s()}if(e&2){let t=o.$implicit,n=a();p(2),vt("ngModel",n.editValue[t.value].show),m("binary",!0)("label",f(3,5,t.label))("disabled",t.disabled),p(2),d(n.columnsInf[t.value].hasPrecision?4:5)}}function An(e,o){if(e&1){let t=F();_(0,"button",14),c(1,"translate"),y("click",function(){E(t);let i=a(2);return B(i.reset())}),s()}e&2&&m("label",f(1,1,"reset"))}function Hn(e,o){if(e&1){let t=F();r(0,An,2,3,"button",11),_(1,"button",12),c(2,"translate"),y("click",function(){E(t);let i=a();return B(i.hide())}),s(),_(3,"button",13),c(4,"translate"),y("click",function(){E(t);let i=a();return B(i.hide(!0))}),s()}if(e&2){let t=a();d(t.modified?0:-1),p(),m("label",f(2,3,"ok")),p(2),m("label",f(4,5,"cancel"))}}var Cn=(()=>{class e extends Ae{constructor(){super(...arguments),this.preferencesSvc=R(wt),this.settingsSvc=R(K),this.columnOptions=this.settingsSvc.columnOptions,this.editValue=Ee,this.columnsInf=Yt}get modified(){return Object.keys(this.editValue).some(t=>this.editValue[t].precision!==yt.columns[t].precision||this.editValue[t].show!==yt.columns[t].show)}initEdit(t){this.editValue=Object.keys(t).filter(n=>Yt[n]!=null).reduce((n,i)=>(n[i]=G(t[i]),n),{})}open(t){this.initEdit(t),this.show()}changeFraction(t,n){this.editValue[n].precision=t?null:1}reset(){this.initEdit(yt.columns)}save(){let t=this.editValue;this.preferencesSvc.apply({columns:t})}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=xt(e)))(i||e)}})()}static{this.\u0275cmp=Z({type:e,selectors:[["lab-columns"]],standalone:!0,features:[gt,et],decls:6,vars:15,consts:[[3,"visibleChange","onHide","visible","modal","dismissableMask","draggable","resizable","focusOnShow","breakpoints","header"],["responsiveLayout","scroll","styleClass","p-datatable-sm",3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"ngModelChange","ngModel","binary","label","disabled"],["colspan","3",1,"text-center"],["styleClass","w-100","inputStyleClass","text-end",1,"w-100",3,"ngModelChange","min","size","showButtons","disabled","ngModel"],[1,"text-center"],[3,"onChange","ngModel","binary","disabled"],[1,"p-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-secondary",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"click","label"]],template:function(n,i){n&1&&(_(0,"p-dialog",0),c(1,"translate"),It("visibleChange",function(u){return ht(i.visible,u)||(i.visible=u),u}),y("onHide",function(){return i.onHide()}),_(2,"p-table",1),r(3,Dn,13,12,"ng-template",2)(4,Nn,6,7,"ng-template",3),s(),r(5,Hn,5,7,"ng-template",4),s()),n&2&&(de(Q(13,Pn)),vt("visible",i.visible),m("modal",!0)("dismissableMask",!0)("draggable",!1)("resizable",!1)("focusOnShow",!1)("breakpoints",Q(14,jn))("header",f(1,11,"columns.header")),p(2),m("value",i.columnOptions()))},dependencies:[ct,st,rt,at,ot,it,Pt,Rt,De,je,Lt,$t,At,Nt,Ut,pt],styles:["th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{width:115px}[_nghost-%COMP%]     .p-dialog-content{padding-bottom:1rem}"],changeDetection:0})}}return e})();var Un=["stepsTable"],Wt=(e,o)=>o.id,J=(e,o)=>o.key,Wn=()=>[25,50,100,1e3],fn=()=>[],zn=(e,o,t,n,i,l,u,x,g,k,b,V,$)=>({items:e,itemId:o,belts:t,beltId:n,wagons:i,wagonId:l,machines:u,machineId:x,recipeId:g,recipeObjectiveId:k,percent:b,percentOnDest:!0,destId:V,inputs:$}),qn=(e,o,t,n,i,l,u,x,g,k,b,V,$,z)=>({items:e,itemId:o,belts:t,beltId:n,wagons:i,wagonId:l,machines:u,machineId:x,recipeId:g,recipeObjectiveId:k,percent:b,destId:V,destRecipeObjectiveId:$,destIsRecipe:!0,outputs:z}),zt=(e,o)=>({step:e,percent:o}),Jn=(e,o)=>({items:e,itemId:o}),Gn=(e,o,t,n,i,l,u,x,g,k,b,V,$)=>({items:e,itemId:o,belts:t,beltId:n,wagons:i,wagonId:l,machines:u,machineId:x,recipeId:g,recipeObjectiveId:k,percent:b,destId:V,destRecipeObjectiveId:$,destIsRecipe:!0}),Kn=(e,o,t,n,i,l,u,x,g)=>({items:e,itemId:o,belts:t,beltId:n,wagons:i,wagonId:l,percent:u,destId:x,destRecipeObjectiveId:g,destIsRecipe:!0}),Xn=(e,o,t,n,i,l,u,x,g,k,b,V,$)=>({items:e,itemId:o,belts:t,beltId:n,wagons:i,wagonId:l,machines:u,machineId:x,recipeId:g,recipeObjectiveId:k,percent:b,percentOnDest:!0,destId:V,destRecipeObjectiveId:$}),dt=(e,o)=>({value:e,itemId:o}),Qn=(e,o)=>({columnSettings:e,totals:o,type:"belt"}),Yn=(e,o)=>({columnSettings:e,totals:o}),Zn=(e,o,t)=>({columnSettings:e,totals:o,modulesTotals:t,type:"machine"}),ti=(e,o,t)=>({columnSettings:e,totals:o,modulesTotals:t,type:"beacon"});function ei(e,o){if(e&1){let t=F();_(0,"button",35),c(1,"translate"),y("click",function(){E(t);let i=a(2);return B(i.exportSvc.stepsToCsv(i.steps()))}),s()}e&2&&m("label",f(1,1,"steps.downloadAsCsv"))}function ni(e,o){if(e&1){let t=F();_(0,"button",38),c(1,"translate"),y("click",function(){E(t);let i=a(3);return B(i.resetChecked())}),s()}e&2&&m("pTooltip",f(1,1,"steps.checkedUndoTooltip"))}function ii(e,o){if(e&1&&(_(0,"th")(1,"div",36),C(2,"i",37),r(3,ni,2,3,"button",27),s()()),e&2){let t=a(2);p(3),d(t.settings().checkedItemIds.size||t.settings().checkedRecipeIds.size||t.settings().checkedObjectiveIds.size?3:-1)}}function oi(e,o){e&1&&(_(0,"th"),v(1),c(2,"translate"),s()),e&2&&(p(),w(f(2,1,"options.column.tree")))}function ai(e,o){e&1&&C(0,"p-sortIcon",26)}function li(e,o){if(e&1){let t=F();_(0,"button",38),c(1,"translate"),y("click",function(i){E(t);let l=a(2);return B(l.resetExcludedItems(i))}),s()}e&2&&m("pTooltip",f(1,1,"steps.itemsUndoTooltip"))}function pi(e,o){e&1&&C(0,"p-sortIcon",39)}function _i(e,o){if(e&1){let t=F();_(0,"button",38),c(1,"translate"),y("click",function(i){E(t);let l=a(3);return B(l.resetBelts(i))}),s()}e&2&&m("pTooltip",f(1,1,"steps.beltsUndoTooltip"))}function si(e,o){if(e&1&&(_(0,"th",28)(1,"div",25)(2,"span"),v(3),c(4,"translate"),s(),r(5,pi,1,0,"p-sortIcon",39)(6,_i,2,3,"button",27),s()()),e&2){let t=a(2);p(3),w(f(4,3,"options.column.belts")),p(2),d(t.focus()?-1:5),p(),d(t.itemsModified().belts?6:-1)}}function ri(e,o){e&1&&C(0,"p-sortIcon",40)}function ci(e,o){if(e&1){let t=F();_(0,"button",38),c(1,"translate"),y("click",function(i){E(t);let l=a(3);return B(l.resetWagons(i))}),s()}e&2&&m("pTooltip",f(1,1,"steps.wagonsUndoTooltip"))}function di(e,o){if(e&1&&(_(0,"th",29)(1,"div",25)(2,"span"),v(3),c(4,"translate"),s(),r(5,ri,1,0,"p-sortIcon",40)(6,ci,2,3,"button",27),s()()),e&2){let t=a(2);p(3),w(f(4,3,t.dispRateInfo().wagonsLabel)),p(2),d(t.focus()?-1:5),p(),d(t.itemsModified().wagons?6:-1)}}function mi(e,o){e&1&&C(0,"p-sortIcon",31)}function ui(e,o){if(e&1){let t=F();_(0,"button",38),c(1,"translate"),y("click",function(i){E(t);let l=a(2);return B(l.resetMachines(i))}),s()}e&2&&m("pTooltip",f(1,1,"steps.machinesUndoTooltip"))}function Ci(e,o){if(e&1){let t=F();_(0,"button",38),c(1,"translate"),y("click",function(){E(t);let i=a(3);return B(i.resetBeacons())}),s()}e&2&&m("pTooltip",f(1,1,"steps.beaconsUndoTooltip"))}function fi(e,o){if(e&1&&(_(0,"th",32)(1,"div",25)(2,"span"),v(3),c(4,"translate"),s(),r(5,Ci,2,3,"button",27),s()()),e&2){let t=a(2);p(3),w(f(4,2,"options.column.beacons")),p(2),d(t.recipesModified().beacons?5:-1)}}function xi(e,o){e&1&&C(0,"p-sortIcon",42)}function gi(e,o){if(e&1&&(_(0,"th",33)(1,"div",41)(2,"span"),v(3),c(4,"translate"),s(),r(5,xi,1,0,"p-sortIcon",42),s()()),e&2){let t=a(2);p(3),w(f(4,2,"options.column.power")),p(2),d(t.focus()?-1:5)}}function Si(e,o){e&1&&C(0,"p-sortIcon",43)}function vi(e,o){if(e&1&&(_(0,"th",34)(1,"div",41)(2,"span"),v(3),c(4,"translate"),s(),r(5,Si,1,0,"p-sortIcon",43),s()()),e&2){let t=a(2);p(3),w(f(4,2,t.dispRateInfo().pollutionLabel)),p(2),d(t.focus()?-1:5)}}function hi(e,o){e&1&&C(0,"th")}function Ii(e,o){if(e&1){let t=F();_(0,"tr")(1,"td",19)(2,"div",20)(3,"button",21),c(4,"translate"),y("click",function(){E(t);let i=a(),l=I(14);return B(l.open(i.columnsState()))}),s(),r(5,ei,2,3,"button",22),s()()(),_(6,"tr",23),C(7,"th"),r(8,ii,4,1,"th")(9,oi,3,3,"th"),_(10,"th",24)(11,"div",25)(12,"span"),v(13),c(14,"translate"),s(),r(15,ai,1,0,"p-sortIcon",26)(16,li,2,3,"button",27),s()(),r(17,si,7,5,"th",28)(18,di,7,5,"th",29),_(19,"th",30)(20,"div",25)(21,"span"),v(22),c(23,"translate"),s(),r(24,mi,1,0,"p-sortIcon",31)(25,ui,2,3,"button",27),s()(),r(26,fi,6,4,"th",32)(27,gi,6,4,"th",33)(28,vi,6,4,"th",34)(29,hi,1,0,"th"),s()}if(e&2){let t=a();p(3),m("label",f(4,16,"steps.columnSettings")),p(2),d(t.steps().length?5:-1),p(3),d(!t.focus()&&t.columnsState().checkbox.show?8:-1),p(),d(!t.focus()&&t.columnsState().tree.show?9:-1),p(4),w(f(14,18,t.dispRateInfo().itemsLabel)),p(2),d(t.focus()?-1:15),p(),d(t.settings().excludedItemIds.size?16:-1),p(),d(t.columnsState().belts.show?17:-1),p(),d(t.columnsState().wagons.show?18:-1),p(4),w(f(23,20,"options.column.machines")),p(2),d(t.focus()?-1:24),p(),d(t.recipesModified().machines?25:-1),p(),d(t.columnsState().beacons.show?26:-1),p(),d(t.columnsState().power.show?27:-1),p(),d(t.columnsState().pollution.show?28:-1),p(),d(t.columnsState().link.show?29:-1)}}function bi(e,o){if(e&1&&C(0,"div",45),e&2){let t=o.$implicit,n=a();m("id","step_"+n.id+"_"+t.label)}}function Ti(e,o){if(e&1){let t=F();_(0,"td",48)(1,"div",53)(2,"p-checkbox",54),y("onChange",function(i){E(t);let l=a(),u=a(2);return B(u.changeStepChecked(l,i.checked))}),s()()()}if(e&2){let t=a();p(2),m("binary",!0)("ngModel",t.checked)}}function yi(e,o){if(e&1&&C(0,"div",61),e&2){let t=o.$implicit,n=o.$index,i=o.$count;tt("trail",t)("last",n===i-1)}}function wi(e,o){if(e&1&&(N(0,yi,1,4,"div",60,St),C(2,"div",56)),e&2){let t=a(2),n=a(2);A(n.stepTree()[t.id])}}function Ei(e,o){if(e&1&&C(0,"lab-tooltip",64),e&2){let t=a(3);m("id",t.itemId)}}function Bi(e,o){if(e&1){let t=F();_(0,"button",62),c(1,"iconSmClass"),y("click",function(){E(t);let i=a(2),l=a(2);return B(l.changeItemExcluded(i.itemId,!l.settings().excludedItemIds.has(i.itemId)))}),C(2,"i",63),r(3,Ei,1,1,"ng-template",null,5,M),s()}if(e&2){let t=I(4),n=a(2),i=a(2);tt("hover-active",i.settings().excludedItemIds.has(n.itemId)),m("icon",f(1,4,n.itemId))("pTooltip",t)}}function ki(e,o){if(e&1&&(_(0,"span"),v(1),s()),e&2){let t=a(3);p(),P("#",t.recipeObjectiveId,"")}}function Mi(e,o){if(e&1&&C(0,"lab-tooltip",66),e&2){let t=a(4);m("id",t.recipeId)}}function Oi(e,o){if(e&1&&r(0,Mi,1,1,"lab-tooltip",66),e&2){let t=a(3);d(t.recipeId?0:-1)}}function Fi(e,o){if(e&1&&(_(0,"i",65),c(1,"iconSmClass"),r(2,ki,2,1,"span")(3,Oi,1,1,"ng-template",null,5,M),s()),e&2){let t=I(4),n=a(2);O(T(1,4,n.recipeId,"recipe")),m("pTooltip",t),p(2),d(n.recipeObjectiveId!=null?2:-1)}}function Vi(e,o){if(e&1&&(_(0,"td",49)(1,"div",55),r(2,wi,3,0,"div",56),_(3,"div",57),r(4,Bi,5,6,"button",58)(5,Fi,5,7,"i",59),s()()()),e&2){let t,n=a(),i=a(2),l=I(1);p(2),d(!l.sortField&&((t=i.stepTree()[n.id])!=null&&t.length)?2:-1),p(2),d(n.itemId&&n.recipeObjectiveId==null?4:5)}}function Ri(e,o){if(e&1&&(_(0,"span",68),v(1),c(2,"rate"),s()),e&2){let t=a(2),n=a(2);p(),P("(+",T(2,1,t.surplus,n.columnsState().items.precision),") ")}}function Pi(e,o){if(e&1&&C(0,"lab-tooltip",64),e&2){let t=a(3);m("id",t.itemId)}}function ji(e,o){if(e&1){let t=F();_(0,"button",62),c(1,"iconSmClass"),y("click",function(){E(t);let i=a(2),l=a(2);return B(l.changeItemExcluded(i.itemId,!l.settings().excludedItemIds.has(i.itemId)))}),C(2,"i",63),r(3,Pi,1,1,"ng-template",null,5,M),s()}if(e&2){let t=I(4),n=a(2),i=a(2);tt("hover-active",i.settings().excludedItemIds.has(n.itemId)),m("icon",f(1,4,n.itemId))("pTooltip",t)}}function Di(e,o){if(e&1&&(_(0,"td",67),r(1,Ri,3,4,"span",68),_(2,"span",68),v(3),c(4,"rate"),s()(),_(5,"td",69)(6,"div",25)(7,"span",70),v(8),s(),r(9,ji,5,6,"button",58),s()()),e&2){let t,n=a(),i=a(2);p(),d(n.surplus&&n.surplus.nonzero()?1:-1),p(2),w(T(4,4,n.items.sub((t=n.surplus)!==null&&t!==void 0?t:i.rational.zero),i.columnsState().items.precision)),p(5),w(i.data().itemEntities[n.itemId].name),p(),d(!i.preferences().hideDuplicateIcons||!i.columnsState().tree.show?9:-1)}}function $i(e,o){e&1&&C(0,"td",32)}function Li(e,o){if(e&1&&(_(0,"span"),v(1),s()),e&2){let t=a(4);p(),w(t.stack)}}function Ni(e,o){if(e&1){let t=F();_(0,"button",72),y("click",function(i){E(t);let l=I(6),u=a(),x=a(2);return B(l.show(i,x,u))}),_(1,"i",73),c(2,"iconSmClass"),r(3,Li,2,1,"span"),s(),C(4,"i",74),s(),_(5,"lab-belt-overlay",75,6),y("setValue",function(i){E(t);let l=a(3),u=a(2),x=a(2);return B(x.changeBelts(u,i,l.defaultBeltId))}),s()}if(e&2){let t=a(2),n=a(),i=a(4);p(),O(f(2,3,t)),p(2),d(n.stack!=null&&n.stack.gt(i.rational.one)?3:-1)}}function Ai(e,o){if(e&1&&(_(0,"div",46),C(1,"i"),c(2,"iconSmClass"),s()),e&2){let t=a().$implicit;p(),O(f(2,2,t.value))}}function Hi(e,o){if(e&1&&r(0,Ai,3,4,"div",46),e&2){let t=o.$implicit;d(t?0:-1)}}function Ui(e,o){if(e&1&&C(0,"lab-tooltip",81),e&2){let t=a().$implicit,n=a(2);m("id",t.value)("type",n)}}function Wi(e,o){if(e&1&&(_(0,"div",79),C(1,"i"),c(2,"iconSmClass"),_(3,"div",80),v(4),s(),r(5,Ui,1,2,"ng-template",null,5,M),s()),e&2){let t=o.$implicit,n=I(6);m("pTooltip",n),p(),O(f(2,4,t.value)),p(3),P(" ",t.label," ")}}function zi(e,o){if(e&1&&C(0,"lab-tooltip",81),e&2){let t=a(2),n=a();m("id",n)("type",t)}}function qi(e,o){if(e&1){let t=F();_(0,"p-dropdown",76),y("onChange",function(i){E(t);let l=a(3),u=a(2),x=a(2);return B(x.itemsSvc.updateEntityField(u.itemId,"beltId",i.value,l.defaultBeltId))}),r(1,Hi,1,1,"ng-template",77)(2,Wi,7,6,"ng-template",78)(3,zi,1,2,"ng-template",null,5,M),s()}if(e&2){let t=I(4),n=a(),i=a(),l=a(5);m("pTooltip",t)("ngModel",i)("options",n==="belt"?l.options().belts:l.options().pipes)}}function Ji(e,o){if(e&1&&r(0,Ni,7,5)(1,qi,5,3,"p-dropdown",71),e&2){let t=a(6);d(t.data().flags.has("beltStack")?0:1)}}function Gi(e,o){if(e&1&&C(0,"lab-tooltip",82),e&2){let t=a(2);m("id",t)}}function Ki(e,o){if(e&1&&(_(0,"i",65),c(1,"iconClass"),r(2,Gi,1,1,"ng-template",null,5,M),s()),e&2){let t=I(3),n=a();O(f(1,3,n)),m("pTooltip",t)}}function Xi(e,o){if(e&1&&(_(0,"td",67)(1,"span",68),v(2),c(3,"rate"),s()(),_(4,"td",69)(5,"div",25),r(6,Ji,2,1)(7,Ki,4,5,"i",59),s()()),e&2){let t,n=o,i=a(3),l=a(2);p(2),w(T(3,2,i.belts,l.columnsState().belts.precision)),p(4),d((t=l.data().beltIds.includes(n)?"belt":l.data().pipeIds.includes(n)?"pipe":null)?6:7,t)}}function Qi(e,o){if(e&1&&r(0,Xi,8,5),e&2){let t;d((t=o.beltId)?0:-1,t)}}function Yi(e,o){e&1&&C(0,"td",32)}function Zi(e,o){if(e&1&&r(0,Qi,1,1)(1,Yi,1,0,"td",32),e&2){let t,n=a(),i=a(2);d((t=n.itemId&&n.belts&&i.itemsState()[n.itemId])?0:1,t)}}function to(e,o){if(e&1&&(_(0,"div",46),C(1,"i"),c(2,"iconSmClass"),s()),e&2){let t=a().$implicit;p(),O(f(2,2,t.value))}}function eo(e,o){if(e&1&&r(0,to,3,4,"div",46),e&2){let t=o.$implicit;d(t?0:-1)}}function no(e,o){if(e&1&&C(0,"lab-tooltip",81),e&2){let t=a().$implicit,n=a();m("id",t.value)("type",n)}}function io(e,o){if(e&1&&(_(0,"div",79),C(1,"i"),c(2,"iconSmClass"),_(3,"div",80),v(4),s(),r(5,no,1,2,"ng-template",null,5,M),s()),e&2){let t=o.$implicit,n=I(6);m("pTooltip",n),p(),O(f(2,4,t.value)),p(3),P(" ",t.label," ")}}function oo(e,o){if(e&1&&C(0,"lab-tooltip",81),e&2){let t=a(),n=a();m("id",n)("type",t)}}function ao(e,o){if(e&1){let t=F();_(0,"p-dropdown",76),y("onChange",function(i){E(t);let l=a(4),u=a(2);return B(u.itemsSvc.updateEntityField(l.itemId,"wagonId",i.value,u.itemsState()[l.itemId].defaultWagonId))}),r(1,eo,1,1,"ng-template",77)(2,io,7,6,"ng-template",78)(3,oo,1,2,"ng-template",null,5,M),s()}if(e&2){let t=I(4),n=a(),i=a(5);m("pTooltip",t)("ngModel",n)("options",o==="cargo-wagon"?i.options().cargoWagons:i.options().fluidWagons)}}function lo(e,o){if(e&1&&(_(0,"td",67)(1,"span",68),v(2),c(3,"rate"),s()(),_(4,"td",69)(5,"div",25),r(6,ao,5,3,"p-dropdown",71),s()()),e&2){let t,n=o,i=a(3),l=a(2);p(2),w(T(3,2,i.wagons,l.columnsState().wagons.precision)),p(4),d((t=l.data().cargoWagonIds.includes(n)?"cargo-wagon":l.data().fluidWagonIds.includes(n)?"fluid-wagon":null)?6:-1,t)}}function po(e,o){if(e&1&&r(0,lo,7,5),e&2){let t,n=a(2),i=a(2);d((t=i.itemsState()[n.itemId].wagonId)?0:-1,t)}}function _o(e,o){e&1&&C(0,"td",32)}function so(e,o){if(e&1&&r(0,po,1,1)(1,_o,1,0,"td",32),e&2){let t=a();d(t.itemId&&t.wagons?0:1)}}function ro(e,o){if(e&1&&(_(0,"span",68),v(1),c(2,"machineRate"),s()),e&2){let t=a(),n=a(),i=a(2);p(),w(ut(2,1,n.machines,i.columnsState().machines.precision,t))}}function co(e,o){if(e&1&&(_(0,"span"),v(1),s()),e&2){let t=a(4);p(),P("#",t.recipeObjectiveId,"")}}function mo(e,o){if(e&1&&C(0,"lab-tooltip",66),e&2){let t=a(4);m("id",t.recipeId)}}function uo(e,o){if(e&1){let t=F();_(0,"button",86),y("click",function(){E(t);let i=a(3),l=a(2);return B(l.objectivesSvc.add({targetId:i.recipeId,unit:l.ObjectiveUnit.Machines}))}),_(1,"span",73),c(2,"iconSmClass"),r(3,co,2,1,"span"),s(),C(4,"i",87),r(5,mo,1,1,"ng-template",null,5,M),s()}if(e&2){let t=I(6),n=a(3);m("pTooltip",t),p(),O(T(2,4,n.recipeId,"recipe")),p(2),d(n.recipeObjectiveId?3:-1)}}function Co(e,o){if(e&1&&(_(0,"div",46),C(1,"i"),c(2,"iconSmClass"),s()),e&2){let t=a().$implicit;p(),O(f(2,2,t.value))}}function fo(e,o){if(e&1&&r(0,Co,3,4,"div",46),e&2){let t=o.$implicit;d(t?0:-1)}}function xo(e,o){if(e&1&&C(0,"lab-tooltip",89),e&2){let t=a().$implicit;m("id",t.value)}}function go(e,o){if(e&1&&(_(0,"div",79),C(1,"i"),c(2,"iconSmClass"),_(3,"div",80),v(4),s(),r(5,xo,1,1,"ng-template",null,5,M),s()),e&2){let t=o.$implicit,n=I(6);m("pTooltip",n),p(),O(f(2,4,t.value)),p(3),P(" ",t.label," ")}}function So(e,o){if(e&1&&C(0,"lab-tooltip",89),e&2){let t=a(3);m("id",t)}}function vo(e,o){if(e&1){let t=F();_(0,"p-dropdown",88),c(1,"options"),y("onChange",function(i){E(t);let l=a(3),u=a(2);return B(l.recipeObjectiveId?u.objectivesSvc.updateEntityField(l.recipeObjectiveId,"machineId",i.value,l.recipeSettings.defaultMachineId):u.recipesSvc.updateEntityField(l.recipeId,"machineId",i.value,l.recipeSettings.defaultMachineId))}),r(2,fo,1,1,"ng-template",77)(3,go,7,6,"ng-template",78)(4,So,1,1,"ng-template",null,5,M),s()}if(e&2){let t=I(5),n=a(2),i=a(),l=a(2);m("pTooltip",t)("options",T(1,3,i.recipe.producers,l.data().itemEntities))("ngModel",n)}}function ho(e,o){if(e&1){let t=F();_(0,"p-inputNumber",90,7),c(2,"translate"),y("onBlur",function(){let i;E(t);let l=I(1),u=a(3),x=a(2);return B(u.recipeObjectiveId?x.objectivesSvc.updateEntityField(u.recipeObjectiveId,"overclock",x.rational((i=l.value)!==null&&i!==void 0?i:100),u.recipeSettings.defaultOverclock):x.recipesSvc.updateEntityField(u.recipeId,"overclock",x.rational((i=l.value)!==null&&i!==void 0?i:100),u.recipeSettings.defaultOverclock))}),s()}if(e&2){let t=a(3);m("min",1)("max",250)("step",10)("maxFractionDigits",2)("size",3)("pTooltip",f(2,7,"steps.overclockTooltip"))("ngModel",t.recipeSettings.overclock)}}function Io(e,o){if(e&1&&C(0,"lab-tooltip",92),e&2){let t=a(2);m("id",t)}}function bo(e,o){if(e&1&&(_(0,"div",25)(1,"i",91),c(2,"iconSmClass"),r(3,Io,1,1,"ng-template",null,5,M),s()()),e&2){let t=I(4),n=a();p(),O(f(2,3,n)),m("pTooltip",t)}}function To(e,o){if(e&1&&(_(0,"div",46),C(1,"i"),c(2,"iconSmClass"),s()),e&2){let t=o.$implicit;p(),O(f(2,2,t.value))}}function yo(e,o){if(e&1&&C(0,"lab-tooltip",92),e&2){let t=a().$implicit;m("id",t.value)}}function wo(e,o){if(e&1&&(_(0,"div",79),C(1,"i"),c(2,"iconSmClass"),_(3,"div",80),v(4),s(),r(5,yo,1,1,"ng-template",null,5,M),s()),e&2){let t=o.$implicit,n=I(6);m("pTooltip",n),p(),O(f(2,4,t.value)),p(3),P(" ",t.label," ")}}function Eo(e,o){if(e&1&&C(0,"lab-tooltip",92),e&2){let t=a(2);m("id",t)}}function Bo(e,o){if(e&1){let t=F();_(0,"p-dropdown",76),y("onChange",function(i){E(t);let l=a(4),u=a(2);return B(l.recipeObjectiveId?u.objectivesSvc.updateEntityField(l.recipeObjectiveId,"fuelId",i.value,l.recipeSettings.fuelId):u.recipesSvc.updateEntityField(l.recipeId,"fuelId",i.value,l.recipeSettings.defaultFuelId))}),r(1,To,3,4,"ng-template",77)(2,wo,7,6,"ng-template",78)(3,Eo,1,1,"ng-template",null,5,M),s()}if(e&2){let t,n=I(4),i=a(),l=a(3);m("pTooltip",n)("ngModel",i)("options",(t=l.recipeSettings.fuelOptions)!==null&&t!==void 0?t:Q(3,fn))}}function ko(e,o){if(e&1&&r(0,bo,5,5,"div",25)(1,Bo,5,4,"p-dropdown",71),e&2){let t=a(3);d(t.recipe.isBurn?0:t.recipeSettings.machineId?1:-1)}}function Mo(e,o){if(e&1&&(_(0,"div",46),C(1,"i"),c(2,"iconSmClass"),s()),e&2){let t=o.$implicit;p(),O(f(2,2,t.value))}}function Oo(e,o){if(e&1&&C(0,"lab-tooltip",95),e&2){let t=a().$implicit;m("id",t.value)}}function Fo(e,o){if(e&1&&(_(0,"div",79),C(1,"i"),c(2,"iconSmClass"),_(3,"div",80),v(4),s(),r(5,Oo,1,1,"ng-template",null,5,M),s()),e&2){let t=o.$implicit,n=I(6);m("pTooltip",t.value!=="module"?n:void 0),p(),O(f(2,4,t.value)),p(3),P(" ",t.label," ")}}function Vo(e,o){if(e&1){let t=F();_(0,"p-dropdown",94),c(1,"translate"),y("onChange",function(i){E(t);let l=a(5),u=a(2);return B(u.changeModulesBeacons(l,{modules:[{id:i.value,count:u.rational.one}]}))}),r(2,Mo,3,4,"ng-template",77)(3,Fo,7,6,"ng-template",78),s()}if(e&2){let t,n=a(2),i=a(3);m("pTooltip",f(1,3,"settings.modifierTooltip"))("ngModel",n[0].id)("options",(t=i.recipeSettings.moduleOptions)!==null&&t!==void 0?t:Q(5,fn))}}function Ro(e,o){if(e&1&&(_(0,"i",73),c(1,"iconSmClass"),_(2,"span"),v(3),s()()),e&2){let t=o.$implicit;O(f(1,3,t.id)),p(3),w(t.count)}}function Po(e,o){if(e&1&&C(0,"lab-tooltip",95),e&2){let t=a().$implicit;m("id",t.id)}}function jo(e,o){if(e&1&&r(0,Po,1,1,"lab-tooltip",95),e&2){let t=o.$implicit;d(t.id?0:-1)}}function Do(e,o){if(e&1&&N(0,jo,1,1,null,null,Wt),e&2){let t=a(3);A(t)}}function $o(e,o){if(e&1){let t=F();_(0,"button",96),y("click",function(i){E(t);let l=I(5),u=a(),x=a(),g=a(3);return B(l.show(i,x,u,g.recipeId))}),N(1,Ro,4,5,"i",97,Wt),C(3,"i",74),s(),_(4,"lab-modules-overlay",75,8),y("setValue",function(i){E(t);let l=a(5),u=a(2);return B(u.changeModulesBeacons(l,{modules:i}))}),s(),r(6,Do,2,0,"ng-template",null,5,M)}if(e&2){let t=I(7),n=a(2);m("pTooltip",t),p(),A(n)}}function Lo(e,o){if(e&1&&r(0,Vo,4,6,"p-dropdown",93)(1,$o,8,1),e&2){let t=o;d(t.modules!==!0&&(t.modules!=null&&t.modules.isOne())?0:t.modules!=null?1:-1)}}function No(e,o){if(e&1&&r(0,Lo,2,1),e&2){let t,n=a(2),i=a(3);d((t=i.data().machineEntities[n])?0:-1,t)}}function Ao(e,o){if(e&1&&(_(0,"div",25)(1,"span",70),v(2),s(),r(3,uo,7,7,"button",83)(4,vo,6,6,"p-dropdown",84),c(5,"machineShow"),r(6,ho,3,9,"p-inputNumber",85)(7,ko,2,1)(8,No,1,1),s()),e&2){let t,n,i=a(),l=a(),u=a(2);p(2),w(l.recipe.name),p(),d(!u.preferences().hideDuplicateIcons||l.itemId!=null&&l.itemId!==l.recipeId?3:-1),p(),d(T(5,6,i,u.data().game)?4:-1),p(2),d(u.data().flags.has("overclock")?6:-1),p(),d((t=l.recipeSettings==null?null:l.recipeSettings.fuelId)?7:-1,t),p(),d((n=l.recipeSettings==null?null:l.recipeSettings.modules)?8:-1,n)}}function Ho(e,o){if(e&1&&(_(0,"td",67),r(1,ro,3,5,"span",68),c(2,"machineShowRate"),s(),_(3,"td",69),r(4,Ao,9,9,"div",25),s()),e&2){let t=a(),n=a(2);p(),d(t.machines&&t.machines.nonzero()&&T(2,2,o,n.data().game)?1:-1),p(3),d(t.recipeId&&t.recipe&&t.recipeSettings?4:-1)}}function Uo(e,o){e&1&&C(0,"td",32)}function Wo(e,o){if(e&1&&(_(0,"i",100),c(1,"iconSmClass"),_(2,"span"),v(3),s()()),e&2){let t=a().$implicit;O(f(1,3,t.id)),p(3),w(t.total)}}function zo(e,o){if(e&1&&(_(0,"i",73),c(1,"iconSmClass"),_(2,"span"),v(3),s()()),e&2){let t=o.$implicit;O(f(1,3,t.id)),p(3),w(t.count)}}function qo(e,o){if(e&1&&(_(0,"div",46)(1,"i",73),c(2,"iconSmClass"),_(3,"span"),v(4),s()(),r(5,Wo,4,5,"i",99),N(6,zo,4,5,"i",97,Wt),s()),e&2){let t=o.$implicit;p(),O(f(2,4,t.id)),p(3),w(t.count),p(),d(t.total?5:-1),p(),A(t.modules)}}function Jo(e,o){e&1&&C(0,"lab-tooltip",101),e&2&&m("id",o)}function Go(e,o){if(e&1&&r(0,Jo,1,1,"lab-tooltip",101),e&2){let t,n=a(3);d((t=n.recipeSettings.beacons==null||n.recipeSettings.beacons[0]==null?null:n.recipeSettings.beacons[0].id)?0:-1,t)}}function Ko(e,o){if(e&1){let t=F();_(0,"button",98),y("click",function(i){E(t);let l=I(5),u=a(2);return B(l.show(i,u.recipeSettings.beacons))}),N(1,qo,8,6,"div",46,St),C(3,"i",74),s(),_(4,"lab-beacons-overlay",75,9),y("setValue",function(i){E(t);let l=a(2),u=a(2);return B(u.changeModulesBeacons(l,{beacons:i}))}),s(),r(6,Go,1,1,"ng-template",null,5,M)}if(e&2){let t=I(7),n=a(2);m("pTooltip",t),p(),A(n.recipeSettings.beacons)}}function Xo(e,o){if(e&1&&(_(0,"td",50),r(1,Ko,8,1),s()),e&2){let t=a();p(),d(t.recipeId&&t.recipeSettings&&t.recipeSettings.beacons?1:-1)}}function Qo(e,o){if(e&1&&(_(0,"span",68),v(1),c(2,"power"),s()),e&2){let t=a(2),n=a(2);p(),w(ut(2,1,t.power,n.columnsState().power.precision,n.effectivePowerUnit()))}}function Yo(e,o){if(e&1&&(_(0,"td",51),r(1,Qo,3,5,"span",68),s()),e&2){let t=a();p(),d(t.power&&t.power.nonzero()?1:-1)}}function Zo(e,o){if(e&1&&(_(0,"span",68),v(1),c(2,"rate"),s()),e&2){let t=a(2),n=a(2);p(),w(T(2,1,t.pollution,n.columnsState().pollution.precision))}}function ta(e,o){if(e&1&&(_(0,"td",51),r(1,Zo,3,4,"span",68),s()),e&2){let t=a();p(),d(t.pollution&&t.pollution.nonzero()?1:-1)}}function ea(e,o){if(e&1){let t=F();_(0,"button",105),c(1,"translate"),y("click",function(){E(t);let i=a(2),l=a(2);return B(l.resetStep(i))}),s()}e&2&&m("pTooltip",f(1,1,"steps.stepUndoTooltip"))}function na(e,o){if(e&1&&(_(0,"td",52)(1,"div",46)(2,"a",102),c(3,"stepHref"),c(4,"async"),C(5,"button",103),c(6,"translate"),s(),r(7,ea,2,3,"button",104),s()()),e&2){let t=a(),n=a(2);p(2),m("queryParams",f(4,6,T(3,3,t,n.routerSvc.zipConfig()))),p(3),m("pTooltip",f(6,8,"steps.openNewTabTooltip")),p(2),d(t.recipeId&&n.stepsModified().recipes[t.recipeId]||t.itemId&&n.stepsModified().items[t.itemId]||t.recipeObjectiveId&&n.stepsModified().objectives[t.recipeObjectiveId]?7:-1)}}function ia(e,o){if(e&1){let t=F();_(0,"tr")(1,"td",44),C(2,"div",45),N(3,bi,1,1,"div",45,Wt),_(5,"div",46)(6,"button",47),c(7,"translate"),y("click",function(){let i=E(t),l=a().expanded,u=a();return B(u.expandRow(i,l))}),s()()(),r(8,Ti,3,2,"td",48)(9,Vi,6,2,"td",49)(10,Di,10,7)(11,$i,1,0,"td",32)(12,Zi,2,1)(13,so,2,1)(14,Ho,5,5)(15,Uo,1,0,"td",32)(16,Xo,2,1,"td",50)(17,Yo,2,1,"td",51)(18,ta,2,1,"td",51)(19,na,8,10,"td",52),s()}if(e&2){let t,n=o,i=a().expanded,l=a();p(2),m("id","step_"+n.id),p(),A(l.stepDetails()[n.id].tabs),p(3),tt("fa-rotate-90",i),m("pTooltip",f(7,15,i?"steps.hideDetails":"steps.showDetails"))("pRowToggler",n),p(2),d(!l.focus()&&l.columnsState().checkbox.show?8:-1),p(),d(!l.focus()&&l.columnsState().tree.show?9:-1),p(),d(n.itemId&&n.items?10:11),p(2),d(l.columnsState().belts.show?12:-1),p(),d(l.columnsState().wagons.show?13:-1),p(),d((t=n.recipeSettings==null?null:n.recipeSettings.machineId)?14:15,t),p(2),d(l.columnsState().beacons.show?16:-1),p(),d(l.columnsState().power.show?17:-1),p(),d(l.columnsState().pollution.show?18:-1),p(),d(l.columnsState().link.show?19:-1)}}function oa(e,o){if(e&1&&(r(0,ia,20,17,"tr"),c(1,"asStep")),e&2){let t,n=o.$implicit;d((t=f(1,1,n))?0:-1,t)}}function aa(e,o){if(e&1&&(_(0,"a",111),C(1,"span",112),_(2,"span",113),v(3),c(4,"translate"),s()()),e&2){let t=o.$implicit,n=a(3);m("id",t.id),p(),O(n.stepDetailIcon[t.label]),p(2),w(f(4,4,"options.stepDetailTab."+t.label))}}function la(e,o){e&1&&j(0)}function pa(e,o){if(e&1&&(_(0,"tr",106),r(1,la,1,0,"ng-container",114),_(2,"td",115),v(3),c(4,"translate"),s()()),e&2){a(4);let t=I(9);p(),m("ngTemplateOutlet",t),p(2),P(" ",f(4,2,"steps.sources")," ")}}function _a(e,o){e&1&&j(0)}function sa(e,o){if(e&1&&r(0,_a,1,0,"ng-container",116),e&2){let t=a().$implicit,n=a(2),i=a(2),l=I(11);m("ngTemplateOutlet",l)("ngTemplateOutletContext",nt(2,zn,[n.items==null?null:n.items.mul(t.value),n.itemId,n.belts==null?null:n.belts.mul(t.value),i.itemsState()[n.itemId].beltId,n.wagons==null?null:n.wagons.mul(t.value),i.itemsState()[n.itemId].wagonId,t.step==null?null:t.step.machines,t.step==null||t.step.recipeSettings==null?null:t.step.recipeSettings.machineId,t.step==null?null:t.step.recipeId,t.step==null?null:t.step.recipeObjectiveId,t.value,n.itemId,t.inputs]))}}function ra(e,o){if(e&1&&r(0,sa,1,16,"ng-container"),e&2){let t=a(2);d(t.itemId?0:-1)}}function ca(e,o){e&1&&j(0)}function da(e,o){if(e&1&&(_(0,"tr",106),r(1,ca,1,0,"ng-container",114),_(2,"td",115),v(3),c(4,"translate"),s()()),e&2){a(4);let t=I(9);p(),m("ngTemplateOutlet",t),p(2),P(" ",f(4,2,"steps.destinations")," ")}}function ma(e,o){e&1&&j(0)}function ua(e,o){if(e&1&&r(0,ma,1,0,"ng-container",116),e&2){let t,n=a().$implicit,i=a(2),l=a(2),u=I(11);m("ngTemplateOutlet",u)("ngTemplateOutletContext",nt(2,qn,[i.items==null?null:i.items.mul(n.value),i.itemId,i.belts==null?null:i.belts.mul(n.value),l.itemsState()[i.itemId].beltId,i.wagons==null?null:i.wagons.mul(n.value),l.itemsState()[i.itemId].wagonId,l.stepDetails()[i.id].outputs.length===1?i.machines==null?null:i.machines.mul(n.value):null,l.stepDetails()[i.id].outputs.length===1?i.recipeSettings==null?null:i.recipeSettings.machineId:null,i.recipeId,i.recipeObjectiveId,n.value,(t=l.stepById()[n.key])==null?null:t.recipeId,(t=l.stepById()[n.key])==null?null:t.recipeObjectiveId,n.key===""]))}}function Ca(e,o){if(e&1&&r(0,ua,1,17,"ng-container"),e&2){let t=a(2);d(t.itemId?0:-1)}}function fa(e,o){if(e&1&&(r(0,pa,5,4,"tr",106),N(1,ra,1,1,null,null,St),r(3,da,5,4,"tr",106),N(4,Ca,1,1,null,null,J),c(6,"keyvalue")),e&2){let t=a(),n=a(2);d(n.stepDetails()[t.id].outputs.length?0:-1),p(),A(n.stepDetails()[t.id].outputs),p(2),d(t.parents?3:-1),p(),A(T(6,2,t.parents,n.trackSvc.sortByValue))}}function xa(e,o){e&1&&j(0)}function ga(e,o){e&1&&j(0)}function Sa(e,o){if(e&1&&r(0,ga,1,0,"ng-container",116),e&2){let t=a(),n=a().$implicit,i=a(4);a(2);let l=I(11);m("ngTemplateOutlet",l)("ngTemplateOutletContext",U(2,Jn,t.step.items.mul(t.percent).div(i.recipe.productivity),n.key))}}function va(e,o){if(e&1&&r(0,Sa,1,5,"ng-container"),e&2){let t=o;d(t.step&&t.percent&&t.step.items?0:-1)}}function ha(e,o){if(e&1&&r(0,va,1,1),e&2){let t,n=o.$implicit,i=a(4),l=a(2);d((t=U(1,zt,l.stepByItemEntities()[n.key],i.outputs==null?null:i.outputs[n.key]))?0:-1,t)}}function Ia(e,o){if(e&1&&(_(0,"tr",106),r(1,xa,1,0,"ng-container",114),_(2,"td",115),v(3),c(4,"translate"),s()(),N(5,ha,1,4,null,null,J),c(7,"keyvalue")),e&2){let t=a(3),n=a(2),i=I(9);p(),m("ngTemplateOutlet",i),p(2),P(" ",f(4,2,"steps.depletion")," "),p(2),A(T(7,4,t.outputs,n.trackSvc.sortByValue))}}function ba(e,o){e&1&&j(0)}function Ta(e,o){e&1&&j(0)}function ya(e,o){if(e&1&&r(0,Ta,1,0,"ng-container",116),e&2){let t=o,n=a(2),i=a().$implicit,l=a(4),u=a(2),x=I(11);m("ngTemplateOutlet",x)("ngTemplateOutletContext",nt(2,Gn,[n.step.items==null?null:n.step.items.mul(n.percent),i.key,n.step.belts==null?null:n.step.belts.mul(n.percent),u.itemsState()[n.step.itemId].beltId,n.step.wagons==null?null:n.step.wagons.mul(n.percent),u.itemsState()[n.step.itemId].wagonId,t.step==null?null:t.step.machines,t.step==null||t.step.recipeSettings==null?null:t.step.recipeSettings.machineId,t.step==null?null:t.step.recipeId,t.step==null?null:t.step.recipeObjectiveId,n.percent,l.recipeId,l.recipeObjectiveId]))}}function wa(e,o){e&1&&j(0)}function Ea(e,o){if(e&1&&r(0,wa,1,0,"ng-container",116),e&2){let t=a(2),n=a().$implicit,i=a(4),l=a(2),u=I(11);m("ngTemplateOutlet",u)("ngTemplateOutletContext",nt(2,Kn,[t.step.items==null?null:t.step.items.mul(t.percent),n.key,t.step.belts==null?null:t.step.belts.mul(t.percent),l.itemsState()[t.step.itemId].beltId,t.step.wagons==null?null:t.step.wagons.mul(t.percent),l.itemsState()[t.step.itemId].wagonId,t.percent,i.recipeId,i.recipeObjectiveId]))}}function Ba(e,o){if(e&1&&r(0,ya,1,16,"ng-container")(1,Ea,1,12,"ng-container"),e&2){let t,n=a(),i=a(7);d((t=i.stepDetails()[n.step.id].outputs.length===1&&i.stepDetails()[n.step.id].outputs[0])?0:1,t)}}function ka(e,o){if(e&1&&r(0,Ba,2,1),e&2){let t=o;d(t.step.itemId&&t.percent?0:-1)}}function Ma(e,o){if(e&1&&r(0,ka,1,1),e&2){let t,n=o.$implicit,i=a(4),l=a(2);d((t=U(1,zt,l.stepByItemEntities()[n.key],(t=l.stepByItemEntities()[n.key].parents)==null?null:t[i.id]))?0:-1,t)}}function Oa(e,o){if(e&1&&(_(0,"tr",106),r(1,ba,1,0,"ng-container",114),_(2,"td",115),v(3),c(4,"translate"),s()(),N(5,Ma,1,4,null,null,J),c(7,"keyvalue")),e&2){let t=a(3),n=a(2),i=I(9);p(),m("ngTemplateOutlet",i),p(2),P(" ",f(4,2,"steps.inputs")," "),p(2),A(T(7,4,t.recipe.in,n.trackSvc.sortByValue))}}function Fa(e,o){e&1&&j(0)}function Va(e,o){e&1&&j(0)}function Ra(e,o){e&1&&j(0)}function Pa(e,o){e&1&&j(0)}function ja(e,o){if(e&1&&r(0,Pa,1,0,"ng-container",116),e&2){let t=a(),n=a().$implicit,i=a(3),l=a(2),u=I(11);m("ngTemplateOutlet",u)("ngTemplateOutletContext",nt(2,Xn,[t.step.items==null?null:t.step.items.mul(t.percent),n.key,t.step.belts==null?null:t.step.belts.mul(t.percent),l.itemsState()[t.step.itemId].beltId,t.step.wagons==null?null:t.step.wagons.mul(t.percent),l.itemsState()[t.step.itemId].wagonId,i.machines,i.recipeSettings==null?null:i.recipeSettings.machineId,i.recipeId,i.recipeObjectiveId,t.percent,n.key,i.recipeObjectiveId]))}}function Da(e,o){if(e&1&&r(0,ja,1,16,"ng-container"),e&2){let t=o;d(t.step.itemId&&t.percent?0:-1)}}function $a(e,o){if(e&1&&r(0,Da,1,1),e&2){let t,n=o.$implicit,i=a(3),l=a(2);d((t=U(1,zt,l.stepByItemEntities()[n.key],i.outputs==null?null:i.outputs[n.key]))?0:-1,t)}}function La(e,o){if(e&1&&(r(0,Ia,8,7)(1,Oa,8,7),c(2,"keyvalue"),_(3,"tr",106),r(4,Fa,1,0,"ng-container",114),_(5,"td",115),v(6),c(7,"translate"),s()(),_(8,"tr",106),r(9,Va,1,0,"ng-container",114),_(10,"td",117)(11,"span",68),v(12),c(13,"rate"),s()(),_(14,"td",118)(15,"div",46),C(16,"i",119),s()(),C(17,"td",19),s(),_(18,"tr",106),r(19,Ra,1,0,"ng-container",114),_(20,"td",115),v(21),c(22,"translate"),s()(),N(23,$a,1,4,null,null,J),c(25,"keyvalue")),e&2){let t=a(2),n=a(2),i=I(9);d(n.data().flags.has("miningDepletion")&&t.recipe.isMining?0:-1),p(),d(f(2,8,t.recipe.in).length?1:-1),p(3),m("ngTemplateOutlet",i),p(2),P(" ",f(7,10,"steps.time")," "),p(3),m("ngTemplateOutlet",i),p(3),w(T(13,12,t.recipe.time,n.columnsState().items.precision)),p(7),m("ngTemplateOutlet",i),p(2),P(" ",f(22,15,"steps.outputs")," "),p(2),A(T(25,17,t.recipe.out,n.trackSvc.sortByValue))}}function Na(e,o){if(e&1&&r(0,La,26,20),e&2){let t=a();d(t.recipe?0:-1)}}function Aa(e,o){e&1&&j(0)}function Ha(e,o){if(e&1&&(r(0,Aa,1,0,"ng-container",116),c(1,"rate")),e&2){let t=a(2),n=a().$implicit;a();let i=I(28),l=a(2),u=a(2);m("ngTemplateOutlet",i)("ngTemplateOutletContext",U(5,dt,T(1,2,t.step.items.mul(t.percent).div(l.machines),u.columnsState().items.precision),n.key))}}function Ua(e,o){e&1&&j(0)}function Wa(e,o){if(e&1&&(r(0,Ua,1,0,"ng-container",116),c(1,"rate")),e&2){let t=a(4);a(2);let n=I(28),i=a(2),l=a(2);m("ngTemplateOutlet",n)("ngTemplateOutletContext",U(5,dt,T(1,2,t.step.belts.mul(t.percent).div(i.machines),l.columnsState().belts.precision),o))}}function za(e,o){if(e&1&&r(0,Wa,2,8,"ng-container"),e&2){let t,n=a(4).$implicit,i=a(5);d((t=i.itemsState()[n.key].beltId)?0:-1,t)}}function qa(e,o){if(e&1&&(_(0,"td"),r(1,za,1,1),s()),e&2){let t=a(2);p(),d(t.step.belts?1:-1)}}function Ja(e,o){e&1&&j(0)}function Ga(e,o){if(e&1&&(r(0,Ja,1,0,"ng-container",116),c(1,"rate")),e&2){let t=o;a(6);let n=I(28);m("ngTemplateOutlet",n)("ngTemplateOutletContext",U(5,dt,T(1,2,t.value,1),t.id))}}function Ka(e,o){if(e&1&&(r(0,Ga,2,8,"ng-container"),c(1,"inserterSpeed")),e&2){let t,n=a(3),i=a(4),l=a(2);d((t=T(1,1,n.step.items.mul(n.percent).div(i.machines).div(l.dispRateInfo().value),l.settings()))?0:-1,t)}}function Xa(e,o){if(e&1&&(_(0,"td"),r(1,Ka,2,4),s()),e&2){let t=a(2),n=a().$implicit,i=a(5);p(),d(i.itemsState()[n.key].beltId!==i.ItemId.Pipe&&t.step.items?1:-1)}}function Qa(e,o){if(e&1&&(_(0,"tr")(1,"td"),r(2,Ha,2,8,"ng-container"),s(),r(3,qa,2,1,"td")(4,Xa,2,1,"td"),s()),e&2){let t=a(),n=a(6);p(2),d(t.step.items?2:-1),p(),d(n.columnsState().belts.show?3:-1),p(),d(n.data().flags.has("inserterEstimation")?4:-1)}}function Ya(e,o){e&1&&r(0,Qa,5,3,"tr"),e&2&&d(o.percent?0:-1)}function Za(e,o){if(e&1&&r(0,Ya,1,1),e&2){let t,n=o.$implicit,i=a(3),l=a(2);d((t=U(1,zt,l.stepByItemEntities()[n.key],(t=l.stepByItemEntities()[n.key].parents)==null?null:t[i.id]))?0:-1,t)}}function tl(e,o){e&1&&C(0,"i",122)}function el(e,o){if(e&1&&C(0,"lab-tooltip",66),e&2){let t=a(4);m("id",t.recipeId)}}function nl(e,o){if(e&1&&C(0,"lab-tooltip",89),e&2){let t=a();m("id",t)}}function il(e,o){if(e&1&&(_(0,"div",25)(1,"i",65),c(2,"iconClass"),r(3,el,1,1,"ng-template",null,5,M),s(),_(5,"i",65),c(6,"iconClass"),r(7,nl,1,1,"ng-template",null,5,M),s()()),e&2){let t=I(4),n=a(3);p(),O(T(2,6,n.recipeId,"recipe")),m("pTooltip",t),p(4),O(f(6,9,o)),m("pTooltip",t)}}function ol(e,o){e&1&&j(0)}function al(e,o){if(e&1&&(r(0,ol,1,0,"ng-container",116),c(1,"rate")),e&2){let t=o;a(5);let n=I(28);m("ngTemplateOutlet",n)("ngTemplateOutletContext",U(5,dt,T(1,2,t.value,1),t.id))}}function ll(e,o){if(e&1&&(r(0,al,2,8,"ng-container"),c(1,"inserterSpeed")),e&2){let t,n=a(2),i=a(6);d((t=T(1,1,n,i.settings()))?0:-1,t)}}function pl(e,o){if(e&1&&(_(0,"td"),r(1,ll,2,4),s()),e&2){let t=a(2).$implicit,n=a(5);p(),d(n.itemsState()[t.key].beltId!==n.ItemId.Pipe?1:-1)}}function _l(e,o){e&1&&j(0)}function sl(e,o){if(e&1&&(r(0,_l,1,0,"ng-container",116),c(1,"rate")),e&2){let t=o,n=a(2);a(2);let i=I(28),l=a(4);m("ngTemplateOutlet",i)("ngTemplateOutletContext",U(5,dt,T(1,2,n.div(l.beltSpeed()[t]),l.columnsState().belts.precision),t))}}function rl(e,o){if(e&1&&(_(0,"td"),r(1,sl,2,8,"ng-container"),s()),e&2){let t,n=a(2).$implicit,i=a(5);p(),d((t=i.itemsState()[n.key].beltId)?1:-1,t)}}function cl(e,o){e&1&&j(0)}function dl(e,o){if(e&1&&(_(0,"tr"),r(1,pl,2,1,"td")(2,rl,2,1,"td"),_(3,"td"),r(4,cl,1,0,"ng-container",116),c(5,"rate"),s()()),e&2){let t=a().$implicit;a();let n=I(28),i=a(4);p(),d(i.data().flags.has("inserterEstimation")?1:-1),p(),d(i.columnsState().belts.show?2:-1),p(2),m("ngTemplateOutlet",n)("ngTemplateOutletContext",U(7,dt,T(5,4,o.mul(i.dispRateInfo().value),i.columnsState().items.precision),t.key))}}function ml(e,o){if(e&1&&r(0,dl,6,10,"tr"),e&2){let t,n=o.$implicit,i=a(3);d((t=n.value.div(i.recipe.time))?0:-1,t)}}function ul(e,o){if(e&1&&C(0,"lab-tooltip",64),e&2){let t=a().itemId;m("id",t)}}function Cl(e,o){if(e&1&&(_(0,"div",41)(1,"span",68),v(2),s(),_(3,"i",65),c(4,"iconClass"),r(5,ul,1,1,"ng-template",null,5,M),s()()),e&2){let t=o.value,n=o.itemId,i=I(6);p(2),w(t),p(),O(f(4,4,n)),m("pTooltip",i)}}function fl(e,o){if(e&1&&(_(0,"div",25)(1,"table",121),N(2,Za,1,4,null,null,J),c(4,"keyvalue"),s(),r(5,tl,1,0,"i",122),c(6,"keyvalue"),_(7,"table",121)(8,"tr")(9,"td",117)(10,"span",68),v(11),c(12,"rate"),s()(),_(13,"td"),r(14,il,9,11,"div",25),s()(),_(15,"tr")(16,"td",117)(17,"span",68),v(18),c(19,"rate"),s()(),_(20,"td"),C(21,"i",119),s()()(),C(22,"i",122),_(23,"table",121),N(24,ml,1,1,null,null,J),c(26,"keyvalue"),s(),r(27,Cl,7,6,"ng-template",null,11,M),s()),e&2){let t,n=a(2),i=a(2);p(2),A(T(4,4,n.recipe.in,i.trackSvc.sortByValue)),p(3),d(f(6,7,n.recipe.in).length?5:-1),p(6),w(T(12,9,i.rational.one,i.columnsState().machines.precision)),p(3),d((t=n.recipeSettings==null?null:n.recipeSettings.machineId)?14:-1,t),p(4),w(T(19,12,i.dispRateInfo().value,i.columnsState().machines.precision)),p(6),A(T(26,15,n.recipe.out,i.trackSvc.sortByValue))}}function xl(e,o){e&1&&(C(0,"small",120),c(1,"translate")),e&2&&m("innerHTML",f(1,1,"steps.inserterCountInfo"),re)}function gl(e,o){if(e&1&&(_(0,"tr",106),C(1,"td"),_(2,"td",19),r(3,fl,29,18,"div",25)(4,xl,2,3,"small",120),s()()),e&2){let t=a(),n=a(2);p(3),d(t.recipeId&&t.recipe&&t.machines?3:-1),p(),d(n.data().flags.has("inserterEstimation")?4:-1)}}function Sl(e,o){if(e&1&&C(0,"lab-tooltip",66),e&2){let t=a().$implicit;m("id",t)}}function vl(e,o){if(e&1){let t=F();_(0,"button",128),c(1,"iconSmClass"),y("click",function(){let i=E(t).$implicit,l=a(5);return B(l.changeRecipesExcluded([i],!l.settings().excludedRecipeIds.has(i)))}),C(2,"i",63),r(3,Sl,1,1,"ng-template",null,5,M),s()}if(e&2){let t=o.$implicit,n=I(4),i=a(5);tt("hover-active",i.settings().excludedRecipeIds.has(t)),m("icon",T(1,4,t,"recipe"))("pTooltip",n)}}function hl(e,o){if(e&1){let t=F();_(0,"tr",106),C(1,"td"),_(2,"td",19)(3,"div")(4,"div",123),v(5),c(6,"translate"),s(),_(7,"div",124)(8,"small"),v(9),c(10,"translate"),s()(),_(11,"p-checkbox",125),c(12,"translate"),y("onChange",function(){let i=E(t),l=a(4);return B(l.changeRecipesExcluded(i.recipeIds,i.allRecipesIncluded))}),s()()()(),_(13,"tr",106),C(14,"td"),_(15,"td",19)(16,"div",126),N(17,vl,5,7,"button",127,me),s()()()}if(e&2){let t=o;p(5),P(" ",f(6,5,"steps.includedRecipes")," "),p(4),w(f(10,7,"steps.includedRecipesInfo")),p(2),m("ngModel",t.allRecipesIncluded)("binary",!0)("label",f(12,9,"picker.includeAll")),p(6),A(t.recipeIds)}}function Il(e,o){if(e&1&&r(0,hl,19,11),e&2){let t,n=a(),i=a(2);d((t=n.itemId&&i.stepDetails()[n.id])?0:-1,t)}}function bl(e,o){if(e&1){let t=F();_(0,"tr",106)(1,"td",107)(2,"a",108),C(3,"button",109),s()(),_(4,"td",19)(5,"p-tabMenu",110,10),c(7,"stepId"),y("activeItemChange",function(i){let l=E(t),u=a(2);return B(u.setActiveItem(l,i))}),r(8,aa,5,6,"ng-template",78),s()()(),r(9,fa,7,5)(10,Na,1,1)(11,gl,5,2,"tr",106)(12,Il,1,1)}if(e&2){let t,n=o,i=I(6),l=a(2);p(2),m("relativeTo",l.route)("fragment",n.id),p(3),m("model",l.stepDetails()[n.id].tabs)("activeItem",l.activeItem[f(7,5,n)]),p(4),d((t=i.activeItem==null?null:i.activeItem.label)===l.StepDetailTab.Item?9:t===l.StepDetailTab.Recipe?10:t===l.StepDetailTab.Machine?11:t===l.StepDetailTab.Recipes?12:-1)}}function Tl(e,o){if(e&1&&(r(0,bl,13,7),c(1,"asStep")),e&2){let t,n=o.$implicit;d((t=f(1,1,n))?0:-1,t)}}function yl(e,o){e&1&&(_(0,"tr")(1,"td",19)(2,"div",53)(3,"span"),v(4),c(5,"translate"),s()()()()),e&2&&(p(4),w(f(5,1,"steps.emptyMessage")))}function wl(e,o){if(e&1&&r(0,yl,6,3,"tr"),e&2){let t=a();d(t.focus()?0:-1)}}function El(e,o){e&1&&C(0,"td",32)}function Bl(e,o){e&1&&C(0,"td")}function kl(e,o){e&1&&C(0,"td")}function Ml(e,o){if(e&1&&r(0,Bl,1,0,"td")(1,kl,1,0,"td"),e&2){let t=a(2);d(t.columnsState().checkbox.show?0:-1),p(),d(t.columnsState().tree.show?1:-1)}}function Ol(e,o){if(e&1&&(C(0,"td"),r(1,Ml,2,2)),e&2){let t=a();p(),d(t.focus()?-1:1)}}function Fl(e,o){e&1&&j(0)}function Vl(e,o){if(e&1&&C(0,"lab-tooltip",64),e&2){let t=a(2).itemId;m("id",t)}}function Rl(e,o){if(e&1&&C(0,"lab-tooltip",132),e&2){let t=a(3).beltId;m("id",t)}}function Pl(e,o){if(e&1&&(_(0,"td",117)(1,"span",68),v(2),c(3,"rate"),s()(),_(4,"td",118)(5,"div",46)(6,"i",65),c(7,"iconClass"),r(8,Rl,1,1,"ng-template",null,5,M),s()()()),e&2){let t=I(9),n=a(2),i=n.belts,l=n.beltId,u=a();p(2),w(T(3,4,i,u.columnsState().belts.precision)),p(4),O(f(7,7,l)),m("pTooltip",t)}}function jl(e,o){if(e&1&&C(0,"lab-tooltip",133),e&2){let t=a(4).wagonId;m("id",t)}}function Dl(e,o){if(e&1&&(_(0,"i",65),c(1,"iconClass"),r(2,jl,1,1,"ng-template",null,5,M),s()),e&2){let t=I(3),n=a(3).wagonId;O(f(1,3,n)),m("pTooltip",t)}}function $l(e,o){if(e&1&&C(0,"lab-tooltip",134),e&2){let t=a(4).wagonId;m("id",t)}}function Ll(e,o){if(e&1&&(_(0,"i",65),c(1,"iconClass"),r(2,$l,1,1,"ng-template",null,5,M),s()),e&2){let t=I(3),n=a(3).wagonId;O(f(1,3,n)),m("pTooltip",t)}}function Nl(e,o){if(e&1&&(_(0,"td",117)(1,"span",68),v(2),c(3,"rate"),s()(),_(4,"td",118)(5,"div",46),r(6,Dl,4,5,"i",59)(7,Ll,4,5,"i",59),s()()),e&2){let t=a(2),n=t.wagons,i=t.wagonId,l=a();p(2),w(T(3,2,n,l.columnsState().wagons.precision)),p(4),d(l.data().cargoWagonIds.includes(i)?6:7)}}function Al(e,o){if(e&1&&(_(0,"span",68),v(1),c(2,"machineRate"),s()),e&2){let t=a(2),n=t.machines,i=t.machineId,l=a();p(),w(ut(2,1,n,l.columnsState().machines.precision,i))}}function Hl(e,o){e&1&&(_(0,"div",130),v(1),c(2,"translate"),s()),e&2&&(p(),P(" ",f(2,1,"steps.inputs")," "))}function Ul(e,o){if(e&1&&(_(0,"span"),v(1),s()),e&2){let t=a(3).recipeObjectiveId;p(),P("#",t,"")}}function Wl(e,o){if(e&1&&C(0,"lab-tooltip",66),e&2){let t=a(3).recipeId;m("id",t)}}function zl(e,o){if(e&1&&C(0,"lab-tooltip",89),e&2){let t=a(3).machineId;m("id",t)}}function ql(e,o){if(e&1&&(_(0,"i",65),c(1,"iconClass"),r(2,Ul,2,1,"span")(3,Wl,1,1,"ng-template",null,5,M),s(),_(5,"i",65),c(6,"iconClass"),r(7,zl,1,1,"ng-template",null,5,M),s()),e&2){let t=I(4),n=a(2),i=n.machineId,l=n.recipeId,u=n.recipeObjectiveId;O(T(1,7,l,"recipe")),m("pTooltip",t),p(2),d(u?2:-1),p(3),O(f(6,10,i)),m("pTooltip",t)}}function Jl(e,o){e&1&&(v(0),c(1,"translate")),e&2&&P(" ",f(1,1,"steps.inputs")," ")}function Gl(e,o){if(e&1&&(_(0,"div",131),r(1,Jl,2,3),s()),e&2){let t=a(2).inputs;p(),d(t?1:-1)}}function Kl(e,o){e&1&&C(0,"i",135)}function Xl(e,o){e&1&&C(0,"i",135)}function Ql(e,o){if(e&1&&(_(0,"span"),v(1),s()),e&2){let t=a(4).destRecipeObjectiveId;p(),P("#",t,"")}}function Yl(e,o){if(e&1&&C(0,"lab-tooltip",81),e&2){let t=a(4),n=t.destId,i=t.destIsRecipe;m("id",n)("type",i?"recipe":"item")}}function Zl(e,o){if(e&1&&(_(0,"i",65),c(1,"iconClass"),r(2,Ql,2,1,"span")(3,Yl,1,2,"ng-template",null,5,M),s()),e&2){let t=I(4),n=a(3),i=n.destId,l=n.destRecipeObjectiveId,u=n.destIsRecipe;O(T(1,4,i,u?"recipe":"item")),m("pTooltip",t),p(2),d(l?2:-1)}}function tp(e,o){e&1&&(_(0,"span"),v(1),c(2,"translate"),s()),e&2&&(p(),P(" ",f(2,1,"steps.outputs")," "))}function ep(e,o){if(e&1&&(r(0,Kl,1,0,"i",135),_(1,"span",68),v(2),c(3,"rate"),c(4,"leftPad"),s(),r(5,Xl,1,0,"i",135)(6,Zl,5,7,"i",59)(7,tp,3,3,"span")),e&2){let t=a(2),n=t.percent,i=t.percentOnDest,l=t.destId,u=t.outputs;d(i?0:-1),p(2),P("",f(4,8,T(3,5,n,-2)),"%"),p(3),d(i?-1:5),p(),d(l?6:-1),p(),d(u?7:-1)}}function np(e,o){if(e&1&&(r(0,Fl,1,0,"ng-container",114),_(1,"td",117)(2,"span",68),v(3),c(4,"rate"),s()(),_(5,"td",118)(6,"div",46)(7,"i",65),c(8,"iconClass"),r(9,Vl,1,1,"ng-template",null,5,M),s()()(),r(11,Pl,10,9)(12,Nl,8,5),_(13,"td",117),r(14,Al,3,5,"span",68),c(15,"machineShowRate"),s(),_(16,"td",129)(17,"div",25),r(18,Hl,3,3,"div",130)(19,ql,9,12),c(20,"machineShow"),r(21,Gl,2,1,"div",131)(22,ep,8,10),s()()),e&2){let t=I(10),n=a(),i=n.items,l=n.itemId,u=n.belts,x=n.beltId,g=n.wagons,k=n.wagonId,b=n.machines,V=n.machineId,$=n.percent,z=n.inputs,L=a(),X=I(9);m("ngTemplateOutlet",X),p(3),w(T(4,11,i,L.columnsState().items.precision)),p(4),O(f(8,14,l)),m("pTooltip",t),p(4),d(L.columnsState().belts.show&&u&&x?11:-1),p(),d(L.columnsState().wagons.show&&g&&k?12:-1),p(2),d(b&&b.nonzero()&&T(15,16,V,L.data().game)?14:-1),p(4),d(z?18:-1),p(),d(T(20,19,V,L.data().game)?19:21),p(3),d($?22:-1)}}function ip(e,o){if(e&1&&(_(0,"tr",106),r(1,np,23,22),s()),e&2){let t=o.itemId;p(),d(t?1:-1)}}function op(e,o){e&1&&C(0,"td")}function ap(e,o){e&1&&C(0,"td")}function lp(e,o){e&1&&j(0)}function pp(e,o){e&1&&j(0)}function _p(e,o){e&1&&j(0)}function sp(e,o){e&1&&j(0)}function rp(e,o){if(e&1&&(_(0,"td",136)(1,"span",68),v(2),c(3,"power"),s()()),e&2){let t=a(3);p(2),w(ut(3,1,t.totals().power,t.columnsState().power.precision,t.effectivePowerUnit()))}}function cp(e,o){if(e&1&&(_(0,"td",136)(1,"span",68),v(2),c(3,"rate"),s()()),e&2){let t=a(3);p(2),w(T(3,1,t.totals().pollution,t.columnsState().pollution.precision))}}function dp(e,o){e&1&&C(0,"td")}function mp(e,o){if(e&1&&(_(0,"tr"),C(1,"td"),r(2,op,1,0,"td")(3,ap,1,0,"td"),_(4,"td",32),v(5),c(6,"translate"),s(),r(7,lp,1,0,"ng-container",116)(8,pp,1,0,"ng-container",116)(9,_p,1,0,"ng-container",116)(10,sp,1,0,"ng-container",116)(11,rp,4,5,"td",136)(12,cp,4,4,"td",136)(13,dp,1,0,"td"),s()),e&2){a();let t=I(2),n=a();p(2),d(n.columnsState().checkbox.show?2:-1),p(),d(n.columnsState().tree.show?3:-1),p(2),P(" ",f(6,14,"steps.total")," "),p(2),m("ngTemplateOutlet",t)("ngTemplateOutletContext",U(16,Qn,n.columnsState().belts,n.totals().belts)),p(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",U(19,Yn,n.columnsState().wagons,n.totals().wagons)),p(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",Kt(22,Zn,n.columnsState().machines,n.totals().machines,n.totals().modules)),p(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",Kt(26,ti,n.columnsState().beacons,n.totals().beacons,n.totals().beaconModules)),p(),d(n.columnsState().power.show?11:-1),p(),d(n.columnsState().pollution.show?12:-1),p(),d(n.columnsState().link.show?13:-1)}}function up(e,o){if(e&1&&(_(0,"div",138)(1,"span",68),v(2),c(3,"rate"),s()()),e&2){let t=o.$implicit,n=a(2).columnSettings;p(2),w(T(3,1,t.value,n.precision))}}function Cp(e,o){if(e&1&&C(0,"lab-tooltip",81),e&2){let t=a(2).$implicit,n=a(2).type;m("id",t.key)("type",n)}}function fp(e,o){if(e&1&&(_(0,"i",143),c(1,"iconClass"),r(2,Cp,1,2,"ng-template",null,5,M),s()),e&2){let t=I(3),n=a().$implicit;O(f(1,3,n.key)),m("pTooltip",t)}}function xp(e,o){if(e&1&&C(0,"lab-tooltip",66),e&2){let t=a(2).$implicit;m("id",t.key)}}function gp(e,o){if(e&1&&(_(0,"i",143),c(1,"iconClass"),r(2,xp,1,1,"ng-template",null,5,M),s()),e&2){let t=I(3),n=a().$implicit;O(T(1,3,n.key,"recipe")),m("pTooltip",t)}}function Sp(e,o){if(e&1&&r(0,fp,4,5,"i",142)(1,gp,4,6,"i",142),e&2){let t=o.$implicit,n=a(4);d(n.data().itemEntities[t.key]?0:1)}}function vp(e,o){if(e&1&&C(0,"lab-tooltip",95),e&2){let t=a().$implicit;m("id",t.key)}}function hp(e,o){if(e&1&&(_(0,"div",144)(1,"span",68),v(2),s()(),_(3,"i",143),c(4,"iconClass"),r(5,vp,1,1,"ng-template",null,5,M),s()),e&2){let t=o.$implicit,n=I(6);p(2),w(t.value),p(),O(T(4,4,t.key,"item")),m("pTooltip",t.key!=="module"?n:void 0)}}function Ip(e,o){if(e&1&&(_(0,"td",137),N(1,up,4,4,"div",138,J),c(3,"keyvalue"),s(),_(4,"td",139)(5,"div",46)(6,"div",140),N(7,Sp,2,1,null,null,J),c(9,"keyvalue"),s(),_(10,"div",141),N(11,hp,7,7,null,null,J),c(13,"keyvalue"),s()()()),e&2){let t=a(),n=t.totals,i=t.modulesTotals,l=a(2);p(),A(T(3,0,n,l.trackSvc.sortByValue)),p(6),A(T(9,3,n,l.trackSvc.sortByValue)),p(4),A(T(13,6,i,l.trackSvc.sortByValue))}}function bp(e,o){if(e&1&&r(0,Ip,14,9),e&2){let t=o.columnSettings;d(t.show?0:-1)}}function Tp(e,o){if(e&1&&r(0,mp,14,30,"tr")(1,bp,1,1,"ng-template",null,12,M),e&2){let t=a();d(t.focus()?-1:0)}}var tr=(()=>{class e{constructor(){this.document=R(ge),this.route=R(Ie),this.ref=R(fe),this.contentSvc=R(Me),this.exportSvc=R(Ze),this.itemsSvc=R(Bt),this.machinesSvc=R(Oe),this.objectivesSvc=R(Re),this.preferencesSvc=R(wt),this.recipeSvc=R(Et),this.recipesSvc=R(_t),this.routerSvc=R(kt),this.settingsSvc=R(K),this.trackSvc=R(qe),this.focus=Jt(!1),this.selectedId=Jt(),this.stepsTable=ce.required("stepsTable"),this.itemsState=this.itemsSvc.settings,this.itemsModified=this.itemsSvc.itemsModified,this.machinesState=this.machinesSvc.settings,this.recipesModified=this.objectivesSvc.recipesModified,this.stepsModified=this.objectivesSvc.stepsModified,this.stepTree=this.objectivesSvc.stepTree,this.stepDetails=this.objectivesSvc.stepDetails,this.stepById=this.objectivesSvc.stepById,this.stepByItemEntities=this.objectivesSvc.stepByItemEntities,this.effectivePowerUnit=this.objectivesSvc.effectivePowerUnit,this.totals=this.objectivesSvc.totals,this.settings=this.settingsSvc.settings,this.dispRateInfo=this.settingsSvc.displayRateInfo,this.beltSpeed=this.settingsSvc.beltSpeed,this.options=this.settingsSvc.options,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset,this.preferences=this.preferencesSvc.state,this._steps=this.objectivesSvc.steps,this.steps=xe(()=>{let t=[...this._steps()];if(!this.focus())return t;let i=this.selectedId();return t.filter(l=>l.id===i)}),this.activeItemsEffect=Xt(()=>{let t=this.steps(),n=this.stepDetails();this.setActiveItems(t,n)}),this.toggleEffect=Xt(()=>{let t=this.focus(),n=this.steps()[0];t&&n&&(this.stepsTable().toggleRow(n),this.expandRow(n,!1))}),this.sortSteps$=new ie(null),this.activeItem={},this.stepDetailTab=Be("stepDetailTab"),this.stepDetailIcon=Ve,this.ItemId=h,this.StepDetailTab=Fe,this.ObjectiveUnit=ke,this.rational=S,oe([this.sortSteps$.pipe(pe()),ye(this._steps)]).pipe(Te()).subscribe(([[t,n],i])=>{this.sortSteps(t,n,i)})}ngOnInit(){this.route.fragment.pipe(le(),ae(t=>t!=null)).subscribe(t=>{this.fragmentId=t})}ngAfterViewInit(){this.loadFragmentId()}loadFragmentId(){if(this.fragmentId)try{let t=this.fragmentId,[n,i,l]=t.split("_"),u=this.steps(),x=this.stepDetails(),g=u.find(b=>b.id===i);if(g==null||!x[g.id].tabs.length)return;this.stepsTable().toggleRow(g),setTimeout(()=>{if(l){let b=this.document.querySelector(`#${t}`);b&&b.click()}else this.document.querySelector(`#${t}`)?.scrollIntoView()},10)}catch{}}sortSteps(t,n,i){if(n?.order==null||n.field==null)return;let l=n.order,u=n.field;if(t!=null&&t.field===u&&t.order!==l&&l===-1&&this.stepsTable!=null){n.data?.sort((x,g)=>i.indexOf(x)-i.indexOf(g)),this.stepsTable().sortOrder=0,this.stepsTable().sortField="",this.stepsTable().reset(),this.sortSteps$.next(null);return}n.data?.sort((x,g)=>(x[u]??S(0n)).sub(g[u]??S(0n)).toNumber()*l)}setActiveItems(t,n){t.forEach(i=>{this.updateActiveItem(i,n,!1)})}expandRow(t,n){n||this.updateActiveItem(t,this.stepDetails(),!0)}updateActiveItem(t,n,i){let l=ft.transform(t),u=this._getActiveItem(t,l,n,i);if(u){let x=ft.transform(t);this.activeItem[x]=u}}_getActiveItem(t,n,i,l){let u=this.activeItem[n],x=i[t.id];if(x==null)return null;if(u!=null){let k=x.tabs.find(b=>b.label===u.label);if(k!=null)return k}if(u==null&&!l)return null;let g=this.stepDetailTab();if(g){let k=x.tabs.find(b=>b.label===g);if(k!=null)return k}return x.tabs[0]}setActiveItem(t,n){if(n==null)return;let i=ft.transform(t);this.activeItem[i]=n,this.stepDetailTab.set(n.label)}resetStep(t){t.itemId&&this.itemsSvc.resetId(t.itemId),t.recipeObjectiveId?this.objectivesSvc.updateEntity(t.recipeObjectiveId,{machineId:void 0,fuelId:void 0,modules:void 0,beacons:void 0,overclock:void 0}):t.recipeId&&this.recipesSvc.resetId(t.recipeId)}changeItemExcluded(t,n){let i=lt(t,n,this.settings().excludedItemIds);this.settingsSvc.apply({excludedItemIds:i})}changeRecipesExcluded(t,n){let i=lt(t,n,this.settings().excludedRecipeIds);this.settingsSvc.updateField("excludedRecipeIds",i,this.settings().defaultExcludedRecipeIds)}changeModulesBeacons(t,n){let i=t.recipeSettings;if(t.recipeId==null||i?.machineId==null)return;let l=t.recipeObjectiveId??t.recipeId,u=t.recipeObjectiveId!=null?this.objectivesSvc.updateEntity.bind(this.objectivesSvc):this.recipesSvc.updateEntity.bind(this.recipesSvc),x=this.data().machineEntities[i.machineId],g=this.machinesState()[i.machineId];n.modules&&(n.modules=this.recipeSvc.dehydrateModules(n.modules,Y(i.moduleOptions,[]),this.settings().moduleRankIds,x.modules,g.modules)),n.beacons&&(n.beacons=this.recipeSvc.dehydrateBeacons(n.beacons,g.beacons)),u(l,n)}changeBelts(t,n,i){t.itemId!=null&&(this.itemsSvc.updateEntityField(t.itemId,"stack",n.stack,S.one),this.itemsSvc.updateEntityField(t.itemId,"beltId",n.beltId,i))}changeStepChecked(t,n){if(t.itemId!=null){let i=lt(t.itemId,n,this.settings().checkedItemIds);this.settingsSvc.apply({checkedItemIds:i})}else if(t.recipeObjectiveId!=null){let i=lt(t.recipeObjectiveId,n,this.settings().checkedObjectiveIds);this.settingsSvc.apply({checkedObjectiveIds:i})}else if(t.recipeId!=null){let i=lt(t.recipeId,n,this.settings().checkedRecipeIds);this.settingsSvc.apply({checkedRecipeIds:i})}}resetChecked(){this.settingsSvc.apply({checkedItemIds:new Set,checkedObjectiveIds:new Set,checkedRecipeIds:new Set})}resetExcludedItems(t){this.settingsSvc.apply({excludedItemIds:new Set}),t.stopImmediatePropagation()}resetBelts(t){this.itemsSvc.resetFields("beltId"),t.stopImmediatePropagation()}resetWagons(t){this.itemsSvc.resetFields("wagonId"),t.stopImmediatePropagation()}resetMachines(t){let n=["machineId","overclock","modules","beacons"];this.objectivesSvc.resetFields(...n),this.recipesSvc.resetFields(...n),t.stopImmediatePropagation()}resetBeacons(){this.objectivesSvc.resetFields("beacons"),this.recipesSvc.resetFields("beacons")}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=Z({type:e,selectors:[["lab-steps"]],viewQuery:function(n,i){n&1&&ue(i.stepsTable,Un,5),n&2&&Ce()},inputs:{focus:[1,"focus"],selectedId:[1,"selectedId"]},standalone:!0,features:[et],decls:15,vars:10,consts:[["stepsTable",""],["emptyCol2",""],["leftPad",""],["detailRow",""],["columnsDlg",""],["tooltip",""],["beltPicker",""],["overclockInput",""],["modulePicker",""],["beaconsOverlay",""],["expandTabMenu",""],["machineValueCell",""],["totalCell",""],["dataKey","id","styleClass","p-datatable-sm",3,"rowsChange","sortFunction","rowTrackBy","value","customSort","rowExpandMode","defaultSortOrder","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],["pTemplate","footer"],["colspan","100"],[1,"d-flex","gap-2","py-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-table-columns",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"label"],[1,"column-header-row"],["colspan","2","pSortableColumn","items"],[1,"d-flex","align-items-center"],["field","items"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"pTooltip"],["colspan","2","pSortableColumn","belts"],["colspan","2","pSortableColumn","wagons"],["colspan","2","pSortableColumn","machines"],["field","machines"],["colspan","2"],["pSortableColumn","power"],["pSortableColumn","pollution"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"click","label"],[1,"d-flex","align-items-center","justify-content-center"],[1,"fa-solid","fa-square-check"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"click","pTooltip"],["field","belts"],["field","wagons"],[1,"d-flex","align-items-center","justify-content-end"],["field","power"],["field","pollution"],[1,"w-0","px-0","px-sm-1"],[1,"fragment",3,"id"],[1,"d-flex"],["pButton","","pRipple","","type","button","icon","fa-solid fa-angle-right",1,"p-button-text","p-button-rounded","transition-ease",3,"click","pTooltip","pRowToggler"],[1,"px-0","px-sm-2"],[1,"overflow-hidden","px-0","px-sm-1","py-0"],["colspan","2",1,"px-0","px-sm-2"],[1,"px-0","px-sm-2","text-end"],[1,"w-0","px-0","ps-sm-1"],[1,"d-flex","justify-content-center"],[3,"onChange","binary","ngModel"],[1,"d-flex","align-items-center","links"],[1,"indent"],[1,"icon"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"hover-active","icon","pTooltip"],[3,"class","pTooltip"],[1,"connect",3,"trail","last"],[1,"connect"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","icon","pTooltip"],[1,"hover-icon","fa-solid","fa-eye-slash"],[3,"id"],[3,"pTooltip"],["type","recipe",3,"id"],[1,"w-0","px-0","px-sm-2","text-end"],[1,"monospace"],[1,"px-0","pe-sm-2"],[1,"find-text"],["labDropdownBase","icon",3,"pTooltip","ngModel","options"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click"],[1,"p-button-icon"],[1,"hover-icon","fa-solid","fa-gear"],[3,"setValue"],["labDropdownBase","icon",3,"onChange","pTooltip","ngModel","options"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],[3,"id","type"],["type","pipe",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"pTooltip"],["labDropdownBase","icon",3,"pTooltip","options","ngModel"],["suffix","%","inputStyleClass","text-end",3,"min","max","step","maxFractionDigits","size","pTooltip","ngModel"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","pTooltip"],[1,"hover-icon","fa-solid","fa-circle-plus"],["labDropdownBase","icon",3,"onChange","pTooltip","options","ngModel"],["type","machine",3,"id"],["suffix","%","inputStyleClass","text-end",3,"onBlur","min","max","step","maxFractionDigits","size","pTooltip","ngModel"],[1,"padded",3,"pTooltip"],["type","fuel",3,"id"],["labDropdownBase","icon","labNoDrag","",3,"pTooltip","ngModel","options"],["labDropdownBase","icon","labNoDrag","",3,"onChange","pTooltip","ngModel","options"],["type","module",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","modules","p-button-text",3,"click","pTooltip"],[1,"p-button-icon",3,"class"],["pButton","","pRipple","","type","button",1,"hover-action","icons","p-button-text","flex-column",3,"click","pTooltip"],[1,"p-button-icon","sum",3,"class"],[1,"p-button-icon","sum"],["type","beacon",3,"id"],["target","_blank","routerLink",".",1,"text-decoration-none",3,"queryParams"],["pButton","","pRipple","","type","button","icon","fa-solid fa-arrow-up-right-from-square","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"click","pTooltip"],[1,"detail"],[1,"px-1"],["routerLink",".","queryParamsHandling","preserve",1,"text-decoration-none",3,"relativeTo","fragment"],["pButton","","pRipple","","type","button","icon","fa-solid fa-link",1,"p-button-text","p-button-rounded"],[3,"activeItemChange","model","activeItem"],[1,"p-menuitem-link",3,"id"],[1,"p-menuitem-icon"],[1,"p-menuitem-text"],[4,"ngTemplateOutlet"],["colspan","100",1,"fw-bold"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-0","text-end"],[1,"ps-0"],[1,"lab-icon","time"],[3,"innerHTML"],[1,"mw-0"],[1,"fa-solid","fa-arrow-right","mx-3"],[1,"fw-bold"],[1,"mb-2"],[3,"onChange","ngModel","binary","label"],[1,"d-flex","flex-wrap"],["pButton","","pRipple","","type","button",1,"p-button-text","hover-action","me-2",3,"hover-active","icon","pTooltip"],["pButton","","pRipple","","type","button",1,"p-button-text","hover-action","me-2",3,"click","icon","pTooltip"],["colspan","100",1,"p-0"],[1,"position-absolute"],[1,"text-center",2,"width","68px"],["type","belt",3,"id"],["type","cargo-wagon",3,"id"],["type","fluid-wagon",3,"id"],[1,"m-1","p-2","fa-solid","fa-arrow-right"],[1,"text-end","inherit"],[1,"w-0","text-end","inherit"],[1,"py-2","icon-height"],[1,"ps-0","inherit"],[1,"d-flex","flex-column","justify-content-center"],[1,"modules-column"],[1,"d-block",3,"class","pTooltip"],[1,"d-block",3,"pTooltip"],[1,"p-2","icon-height","text-end"]],template:function(n,i){if(n&1){let l=F();_(0,"p-table",13,0),y("rowsChange",function(x){return E(l),B(i.preferencesSvc.apply({rows:x}))})("sortFunction",function(x){return E(l),B(i.sortSteps$.next(x))}),r(2,Ii,30,22,"ng-template",14)(3,oa,2,3,"ng-template",15)(4,Tl,2,3,"ng-template",16)(5,wl,1,1,"ng-template",17)(6,El,1,0,"ng-template",null,1,M)(8,Ol,2,1,"ng-template",null,2,M)(10,ip,2,1,"ng-template",null,3,M)(12,Tp,3,1,"ng-template",18),s(),C(13,"lab-columns",null,4)}n&2&&m("rowTrackBy",i.trackSvc.trackStep)("value",i.steps())("customSort",!0)("rowExpandMode",i.focus()?"single":"multiple")("defaultSortOrder",-1)("paginator",!i.focus()&&!i.preferences().disablePaginator)("rows",i.preferences().rows)("rowsPerPageOptions",Q(9,Wn))("showCurrentPageReport",!0)},dependencies:[ve,ct,st,rt,he,Se,be,at,ot,it,Pt,Rt,Vt,Ft,Lt,$t,At,Nt,Je,Ke,Ge,We,Ue,Mt,Ot,tn,Xe,un,Cn,Ht,$e,jt,nn,on,an,ln,pn,Qe,ze,_n,sn,q,rn,ft,Dt,pt],styles:[".links[_ngcontent-%COMP%]{height:50px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{position:relative;margin-left:16px;height:100vh}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%], .links[_ngcontent-%COMP%]   .connect.trail[_ngcontent-%COMP%]{border-left:2px dotted var(--text-color-secondary)}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%]:not(.trail){margin-bottom:50vh;height:50vh}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:24px}@media (max-width: 1199.98px){.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{margin-left:8px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:16px}}.links[_ngcontent-%COMP%]   .indent[_ngcontent-%COMP%]{margin-left:0;border-top:2px dotted var(--text-color-secondary);width:8px}.links[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px}[_nghost-%COMP%]     .p-dropdown:not(:is(:hover,   :focus,   .ng-invalid)), [_nghost-%COMP%]     .p-inputtext:not(:is(:hover,   :focus,   .ng-invalid)){border-color:transparent;background-color:transparent}tr.detail[_ngcontent-%COMP%]{background-color:var(--surface-ground)}[_nghost-%COMP%]     tr.detail .p-tabmenu .p-tabmenu-nav .p-tabmenuitem:not(.p-highlight) .p-menuitem-link{background-color:transparent}.icon-height[_ngcontent-%COMP%]{min-height:32px}.modules-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;margin:auto}.fragment[_ngcontent-%COMP%]{position:absolute;top:-10rem;visibility:hidden}.column-header-row[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{height:48px}"],changeDetection:0})}}return e})();export{Ye as a,Ze as b,tr as c};
