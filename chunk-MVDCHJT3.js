import{a as je,b as $e,c as De,d as Le,e as Ue,g as We,h as ze}from"./chunk-CXO3NNXV.js";import{b as Tt}from"./chunk-LIYVBTC6.js";import{a as Me,b as Oe,e as Ve,g as Pe}from"./chunk-PK75H46N.js";import{a as kt,b as Bt}from"./chunk-WDJGS7TG.js";import{b as he,f as be,g as Te,t as we}from"./chunk-NIC2ROXC.js";import{b as Mt,c as Ot,d as Ft,e as Ae,f as Ne,g as He,i as Rt}from"./chunk-WLDX5FDK.js";import{a as Fe,b as Re}from"./chunk-56NA6XA5.js";import{f as ke,g as Be}from"./chunk-RJLH5CM2.js";import{e as wt,f as yt,h as Et,i as ye,j as Ee}from"./chunk-SJMDSSAM.js";import{B as vt,n as ut,y as ft,z as xt}from"./chunk-B6XZE2SP.js";import{a as bt,b as Ie,c as it}from"./chunk-H55T5MVH.js";import{$ as M,Ab as k,Ba as c,Bd as ve,D as Xt,E as Qt,Ea as m,Ec as I,Fb as pe,Ga as Q,Gc as v,Gd as et,Ha as ie,Ia as O,Ib as _e,Id as nt,Ja as d,Ka as ct,Kb as At,Kc as J,La as oe,Ma as A,Na as N,Nb as se,O as Yt,Oa as _,Oc as gt,Pa as s,Qa as u,Qc as xe,S as $,Sc as St,T as st,Ta as j,Ua as R,Uc as Z,Va as F,Vb as ce,W as D,Wa as a,Wb as re,Xb as de,_ as B,_c as tt,ba as Zt,bb as ae,cb as le,d as qt,db as b,eb as S,fb as E,fc as me,gb as P,gd as Nt,ia as Dt,ib as rt,ic as Ce,jb as dt,kb as mt,m as Jt,ma as te,mb as Ct,md as Ht,nb as X,nd as ge,pb as H,pd as Se,qa as l,qb as Lt,qc as ue,rc as fe,rd as ht,sd as It,v as Kt,vb as Y,vd as W,wb as r,xb as x,xd as pt,ya as ee,yb as T,za as ne,zb as lt}from"./chunk-Z2AYPNVR.js";import{f as pn,h as _n,j as Gt}from"./chunk-TWZW5B45.js";var Ge=pn((Ut,Wt)=>{"use strict";(function(e,i){typeof define=="function"&&define.amd?define([],i):typeof Ut<"u"?i():(i(),e.FileSaver={})})(Ut,function(){"use strict";function e(f,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function i(f,g,w){var h=new XMLHttpRequest;h.open("GET",f),h.responseType="blob",h.onload=function(){C(h.response,g,w)},h.onerror=function(){console.error("could not download file")},h.send()}function t(f){var g=new XMLHttpRequest;g.open("HEAD",f,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function n(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(g)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,p=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),C=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(f,g,w){var h=o.URL||o.webkitURL,y=document.createElement("a");g=g||f.name||"download",y.download=g,y.rel="noopener",typeof f=="string"?(y.href=f,y.origin===location.origin?n(y):t(y.href)?i(f,g,w):n(y,y.target="_blank")):(y.href=h.createObjectURL(f),setTimeout(function(){h.revokeObjectURL(y.href)},4e4),setTimeout(function(){n(y)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,w){if(g=g||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(e(f,w),g);else if(t(f))i(f,g,w);else{var h=document.createElement("a");h.href=f,h.target="_blank",setTimeout(function(){n(h)})}}:function(f,g,w,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof f=="string")return i(f,g,w);var y=f.type==="application/octet-stream",V=/constructor/i.test(o.HTMLElement)||o.safari,z=/CriOS\/[\d]+/.test(navigator.userAgent);if((z||y&&V||p)&&typeof FileReader<"u"){var L=new FileReader;L.onloadend=function(){var at=L.result;at=z?at:at.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=at:location=at,h=null},L.readAsDataURL(f)}else{var K=o.URL||o.webkitURL,$t=K.createObjectURL(f);h?h.location=$t:location.href=$t,h=null,setTimeout(function(){K.revokeObjectURL($t)},4e4)}});o.saveAs=C.saveAs=C,typeof Wt<"u"&&(Wt.exports=C)})});var zt=_n(Ge());var sn="text/csv;charset=UTF-8",cn=".csv",rn="text/json;charset=UTF-8",dn=".json",mn=["Item","Items","Surplus","Inputs","Outputs","Targets","Belts","Belt","Wagons","Wagon","Recipe","Machines","Machine","Modules","Beacons","Power","Pollution"],qe=(()=>{class e{constructor(){this.itemsSvc=$(bt),this.recipesSvc=$(it),this.settingsSvc=$(nt),this.itemsState=this.itemsSvc.itemsState,this.recipesState=this.recipesSvc.recipesState,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset}stepsToCsv(t){let n=t.map(C=>this.stepToJson(C,t)),o=mn.filter(C=>n.some(f=>f[C]!=null)),p=n.map(C=>o.map(f=>C[f]).join(","));p.unshift(o.join(",")),p.unshift(`"${window.location.href}"`),this.saveAsCsv(p.join(`\r
`),"factoriolab_list")}flowToJson(t){this.saveAsJson(JSON.stringify(t),"factoriolab_flow")}saveAsCsv(t,n){(0,zt.saveAs)(new Blob([t],{type:sn}),n+cn)}saveAsJson(t,n){(0,zt.saveAs)(new Blob([t],{type:rn}),n+dn)}stepToJson(t,n){let o=this.columnsState(),p=this.itemsState(),C=this.recipesState(),f=this.data(),g={};if(t.itemId!=null){g.Item=t.itemId;let w=p[t.itemId];t.items!=null&&(g.Items="="+t.items.sub(t.surplus??v.zero).toString()),t.surplus!=null&&(g.Surplus="="+t.surplus.toString()),o.belts.show&&(t.belts!=null&&(g.Belts="="+t.belts.toString()),g.Belt=w.beltId),o.wagons.show&&(t.wagons!=null&&(g.Wagons="="+t.wagons.toString()),g.Wagon=w.wagonId)}if(t.recipeId!=null){g.Recipe=t.recipeId;let w=f.adjustedRecipe[t.recipeId],h=C[t.recipeId],y=Object.keys(w.in).map(V=>{let z=n.find(L=>L.itemId===V);return[V,z?.parents?.[t.id]?.toString()??""]}).filter(V=>V[1]).map(V=>`${V[0]}:${V[1]}`).join(",");if(y&&(g.Inputs=`"${y}"`),h.machineId!=null){let V=f.machineEntities[h.machineId],z=et.allowsModules(w,V);o.machines.show&&(t.machines!=null&&(g.Machines="="+t.machines.toString()),g.Machine=h.machineId,z&&h.modules!=null&&(g.Modules=`"${h.modules.filter(gt("count","id")).map(L=>`${L.count.toString()} ${L.id}`).join(",")}"`)),o.beacons.show&&z&&(g.Beacons=`"${J(h.beacons?.map(L=>`${J(L.count?.toString(),"")} ${J(L.id,"")} (${J(L.modules?.filter(gt("count","id")).map(K=>`${K.count.toString()} ${K.id}`).join(","),"")})`).join(","),"")}"`),o.power.show&&t.power!=null&&(g.Power="="+t.power.toString()),o.pollution.show&&t.pollution!=null&&(g.Pollution="="+t.pollution.toString())}}if(t.outputs!=null){let w=t.outputs,h=Object.keys(w).map(y=>`${y}:${w[y].toString()}`).join(",");g.Outputs=`"${h}"`}if(t.parents!=null){let w=t.parents,h=Object.keys(w).map(y=>n.find(V=>V.id===y)).filter(xe).filter(gt("recipeId")).map(y=>`${y.recipeId}:${w[y.id].toString()}`).join(",");g.Targets=`"${h}"`}return g}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=Yt({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Je=(()=>{class e{transform(t){return t}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"asStep",type:e,pure:!0,standalone:!0})}}return e})();var Ke={[pt.Chest]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.StackInserter,value:v(4.62)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.67)},{id:I.LongHandedInserter,value:v(2.4)},{id:I.FastInserter,value:v(4.62)},{id:I.StackInserter,value:v(9.23)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.5)},{id:I.LongHandedInserter,value:v(3.6)},{id:I.FastInserter,value:v(6.92)},{id:I.StackInserter,value:v(27.69)}]},[pt.ExpressTransportBelt]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.StackInserter,value:v(4.44)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.64)},{id:I.LongHandedInserter,value:v(2.35)},{id:I.FastInserter,value:v(4.44)},{id:I.StackInserter,value:v(7.74)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.43)},{id:I.LongHandedInserter,value:v(3.46)},{id:I.FastInserter,value:v(6.43)},{id:I.StackInserter,value:v(13.85)}]},[pt.FastTransportBelt]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.StackInserter,value:v(4.44)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.64)},{id:I.LongHandedInserter,value:v(2.35)},{id:I.FastInserter,value:v(4.44)},{id:I.StackInserter,value:v(7.06)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.37)},{id:I.LongHandedInserter,value:v(3.33)},{id:I.FastInserter,value:v(6)},{id:I.StackInserter,value:v(10.91)}]},[pt.TransportBelt]:{[W.Capacity0]:[{id:I.Inserter,value:v(.83)},{id:I.LongHandedInserter,value:v(1.2)},{id:I.FastInserter,value:v(2.31)},{id:I.StackInserter,value:v(4.44)}],[W.Capacity2]:[{id:I.Inserter,value:v(1.64)},{id:I.LongHandedInserter,value:v(2.35)},{id:I.FastInserter,value:v(4.44)},{id:I.StackInserter,value:v(5.71)}],[W.Capacity7]:[{id:I.Inserter,value:v(2.25)},{id:I.LongHandedInserter,value:v(3.1)},{id:I.FastInserter,value:v(5.29)},{id:I.StackInserter,value:v(6.79)}]}};var Xe=(()=>{class e{transform(t,n){if(t!=null){let o=Ke[n.inserterTarget][n.inserterCapacity]?.find(p=>p.value.gt(t)||p.id===I.StackInserter);return o==null?null:{id:o.id,value:t.div(o.value)}}return null}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"inserterSpeed",type:e,pure:!0,standalone:!0})}}return e})();var Qe=(()=>{class e{transform(t){return t==null?"":" ".repeat(4-t.length)+t}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"leftPad",type:e,pure:!0,standalone:!0})}}return e})();var G=(()=>{class e{static transform(t,n){if(n==null)return t.toFraction();if(n===-2)return Math.round(t.mul(v(100n)).toNumber()).toString();let p=t.toPrecision(n).toString();if(n>0){let C=v(1,Math.pow(10,n));t.gt(v.zero)&&t.lt(C)&&(p=`<${p}`);let f=p.split(".");if(f.length>1){if(f[1].length<n){let g=n-f[1].length;return p+"0".repeat(g)}}else return t.isInteger()?p+" ".repeat(n+1):p+"."+"0".repeat(n)}return p}transform(t,n){return e.transform(t,n)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"rate",type:e,pure:!0,standalone:!0})}}return e})();var Ye=(()=>{class e{transform(t,n,o){return o===I.Pumpjack?`${G.transform(t.mul(v(100n)),n!=null?Math.max(n-2,0):n)}%`:G.transform(t,n)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"machineRate",type:e,pure:!0,standalone:!0})}}return e})();var Ze=(()=>{class e{transform(t,n){return t==null?!1:n!==tt.DysonSphereProgram||t!==I.MiningMachine}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"machineShow",type:e,pure:!0,standalone:!0})}}return e})();var tn=(()=>{class e{transform(t,n){return n!==tt.CaptainOfIndustry||t!==I.MineControlTower}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"machineShowRate",type:e,pure:!0,standalone:!0})}}return e})();var en=(()=>{class e{transform(t,n,o=!1){if(t==null)return[];let p=t.map(C=>({label:n[C].name,value:C}));return o&&p.unshift({label:"None",value:I.Module}),p}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"options",type:e,pure:!0,standalone:!0})}}return e})();var nn=(()=>{class e{transform(t,n,o){switch(o){case Nt.GW:return`${G.transform(t.div(v(1000000n)),n)} GW`;case Nt.MW:return`${G.transform(t.div(v(1000n)),n)} MW`;default:return`${G.transform(t,n)} kW`}}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"power",type:e,pure:!0,standalone:!0})}}return e})();var on=(()=>{class e{constructor(){this.recipesSvc=$(it),this.routerSvc=$(Tt),this.data=this.recipesSvc.adjustedDataset}transform(t,n){return Gt(this,null,function*(){let o=t;if(o.recipeId){let p=this.data().adjustedRecipe[o.recipeId];p.isTechnology&&p.productivity&&t.items&&(o=St(t,{items:t.items.div(p.productivity)}))}return this.routerSvc.stepHref(o,n,this.data().hash)})}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"stepHref",type:e,pure:!0,standalone:!0})}}return e})();var _t=(()=>{class e{static transform(t){return t.itemId??t.recipeObjectiveId??t.recipeId??t.id}transform(t){return e.transform(t)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=D({name:"stepId",type:e,pure:!0,standalone:!0})}}return e})();var Vt=class e{static{this.value=v(1n,3n)}transform(i){return i==null?e.value.toFraction():e.value.toPrecision(i).toString()}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275pipe=D({name:"precisionExample",type:e,pure:!0,standalone:!0})}};var vn=()=>({width:"400px"}),hn=()=>({"400px":"100vw"});function In(e,i){e&1&&(_(0,"tr")(1,"th"),S(2),r(3,"translate"),s(),_(4,"th"),S(5),r(6,"translate"),s(),_(7,"th"),S(8),r(9,"translate"),s(),_(10,"th"),S(11),r(12,"translate"),s()()),e&2&&(l(2),E(x(3,4,"columns.visibility")),l(3),E(x(6,6,"columns.decimals")),l(3),E(x(9,8,"columns.fractions")),l(3),E(x(12,10,"columns.example")))}function bn(e,i){if(e&1){let t=R();_(0,"td")(1,"p-inputNumber",7),mt("ngModelChange",function(o){B(t);let p=a().$implicit,C=a();return dt(C.editValue[p.value].precision,o)||(C.editValue[p.value].precision=o),M(o)}),s()(),_(2,"td",8)(3,"p-checkbox",9),F("onChange",function(o){B(t);let p=a().$implicit,C=a();return M(C.changeFraction(o.checked,p.value))}),s()(),_(4,"td"),S(5),r(6,"precisionExample"),s()}if(e&2){let t=a().$implicit,n=a();l(),m("min",0)("size",1)("showButtons",!0)("disabled",!n.editValue[t.value].show),rt("ngModel",n.editValue[t.value].precision),l(2),m("ngModel",n.editValue[t.value].precision==null)("binary",!0)("disabled",!n.editValue[t.value].show),l(2),P(" ",x(6,9,n.editValue[t.value].precision)," ")}}function Tn(e,i){e&1&&(_(0,"td",6)(1,"div",10),S(2),r(3,"translate"),s()()),e&2&&(l(2),E(x(3,1,"columns.notApplicable")))}function wn(e,i){if(e&1){let t=R();_(0,"tr")(1,"td")(2,"p-checkbox",5),r(3,"translate"),mt("ngModelChange",function(o){let p=B(t).$implicit,C=a();return dt(C.editValue[p.value].show,o)||(C.editValue[p.value].show=o),M(o)}),s()(),c(4,bn,7,11)(5,Tn,4,3,"td",6),s()}if(e&2){let t=i.$implicit,n=a();l(2),rt("ngModel",n.editValue[t.value].show),m("binary",!0)("label",x(3,5,t.label))("disabled",t.disabled),l(2),d(n.columnsInf[t.value].hasPrecision?4:5)}}function yn(e,i){if(e&1){let t=R();_(0,"button",14),r(1,"translate"),F("click",function(){B(t);let o=a(2);return M(o.reset())}),s()}e&2&&m("label",x(1,1,"reset"))}function En(e,i){if(e&1){let t=R();c(0,yn,2,3,"button",11),_(1,"button",12),r(2,"translate"),F("click",function(){B(t);let o=a();return M(o.hide())}),s(),_(3,"button",13),r(4,"translate"),F("click",function(){B(t);let o=a();return M(o.hide(!0))}),s()}if(e&2){let t=a();d(t.modified?0:-1),l(),m("label",x(2,3,"ok")),l(2),m("label",x(4,5,"cancel"))}}var an=(()=>{class e extends Ve{constructor(){super(...arguments),this.preferencesSvc=$(It),this.settingsSvc=$(nt),this.columnOptions=this.settingsSvc.columnOptions,this.editValue=ge,this.columnsInf=Ht}get modified(){return Object.keys(this.editValue).some(t=>this.editValue[t].precision!==ht.columns[t].precision||this.editValue[t].show!==ht.columns[t].show)}initEdit(t){this.editValue=Object.keys(t).filter(n=>Ht[n]!=null).reduce((n,o)=>(n[o]=St(t[o]),n),{})}open(t){this.initEdit(t),this.show()}changeFraction(t,n){this.editValue[n].precision=t?null:1}reset(){this.initEdit(ht.columns)}save(){let t=this.editValue;this.preferencesSvc.apply({columns:t})}static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=Zt(e)))(o||e)}})()}static{this.\u0275cmp=st({type:e,selectors:[["lab-columns"]],standalone:!0,features:[ne,Ct],decls:6,vars:15,consts:[[3,"visibleChange","onHide","visible","modal","dismissableMask","draggable","resizable","focusOnShow","breakpoints","header"],["responsiveLayout","scroll","styleClass","p-datatable-sm",3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[3,"ngModelChange","ngModel","binary","label","disabled"],["colspan","3",1,"text-center"],["styleClass","w-100","inputStyleClass","text-end",1,"w-100",3,"ngModelChange","min","size","showButtons","disabled","ngModel"],[1,"text-center"],[3,"onChange","ngModel","binary","disabled"],[1,"p-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-check",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-xmark",1,"p-button-outlined","p-button-secondary",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"p-button-outlined",3,"click","label"]],template:function(n,o){n&1&&(_(0,"p-dialog",0),r(1,"translate"),mt("visibleChange",function(C){return dt(o.visible,C)||(o.visible=C),C}),F("onHide",function(){return o.onHide()}),_(2,"p-table",1),c(3,In,13,12,"ng-template",2)(4,wn,6,7,"ng-template",3),s(),c(5,En,5,7,"ng-template",4),s()),n&2&&(ie(X(13,vn)),rt("visible",o.visible),m("modal",!0)("dismissableMask",!0)("draggable",!1)("resizable",!1)("focusOnShow",!1)("breakpoints",X(14,hn))("header",x(1,11,"columns.header")),l(2),m("value",o.columnOptions()))},dependencies:[Et,wt,yt,xt,ft,ut,Bt,kt,Oe,Me,Ot,Mt,Rt,Ft,Vt,vt],styles:["th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{width:115px}[_nghost-%COMP%]     .p-dialog-content{padding-bottom:1rem}"],changeDetection:0})}}return e})();var kn=["stepsTable"],Pt=(e,i)=>i.id,q=(e,i)=>i.key,Bn=()=>[25,50,100,1e3],ln=()=>[],Mn=(e,i,t,n,o,p,C,f,g,w,h,y,V)=>({items:e,itemId:i,belts:t,beltId:n,wagons:o,wagonId:p,machines:C,machineId:f,recipeId:g,recipeObjectiveId:w,percent:h,percentOnDest:!0,destId:y,inputs:V}),On=(e,i,t,n,o,p,C,f,g,w,h,y,V,z)=>({items:e,itemId:i,belts:t,beltId:n,wagons:o,wagonId:p,machines:C,machineId:f,recipeId:g,recipeObjectiveId:w,percent:h,destId:y,destRecipeObjectiveId:V,destIsRecipe:!0,outputs:z}),jt=(e,i)=>({step:e,percent:i}),Fn=(e,i)=>({items:e,itemId:i}),Rn=(e,i,t,n,o,p,C,f,g,w,h,y,V)=>({items:e,itemId:i,belts:t,beltId:n,wagons:o,wagonId:p,machines:C,machineId:f,recipeId:g,recipeObjectiveId:w,percent:h,destId:y,destRecipeObjectiveId:V,destIsRecipe:!0}),Vn=(e,i,t,n,o,p,C,f,g)=>({items:e,itemId:i,belts:t,beltId:n,wagons:o,wagonId:p,percent:C,destId:f,destRecipeObjectiveId:g,destIsRecipe:!0}),Pn=(e,i,t,n,o,p,C,f,g,w,h,y,V)=>({items:e,itemId:i,belts:t,beltId:n,wagons:o,wagonId:p,machines:C,machineId:f,recipeId:g,recipeObjectiveId:w,percent:h,percentOnDest:!0,destId:y,destRecipeObjectiveId:V}),ot=(e,i)=>({value:e,itemId:i}),jn=(e,i)=>({columnSettings:e,totals:i,type:"belt"}),$n=(e,i)=>({columnSettings:e,totals:i}),Dn=(e,i,t)=>({columnSettings:e,totals:i,modulesTotals:t,type:"machine"}),Ln=(e,i,t)=>({columnSettings:e,totals:i,modulesTotals:t,type:"beacon"});function An(e,i){if(e&1){let t=R();_(0,"button",34),r(1,"translate"),F("click",function(){B(t);let o=a(2);return M(o.exportSvc.stepsToCsv(o.steps()))}),s()}e&2&&m("label",x(1,1,"steps.downloadAsCsv"))}function Nn(e,i){if(e&1){let t=R();_(0,"button",37),r(1,"translate"),F("click",function(){B(t);let o=a(3);return M(o.resetChecked())}),s()}e&2&&m("pTooltip",x(1,1,"steps.checkedUndoTooltip"))}function Hn(e,i){if(e&1&&(_(0,"th")(1,"div",35),u(2,"i",36),c(3,Nn,2,3,"button",26),s()()),e&2){let t=a(2);l(3),d(t.settings().checkedItemIds.size||t.settings().checkedRecipeIds.size||t.settings().checkedObjectiveIds.size?3:-1)}}function Un(e,i){e&1&&(_(0,"th"),S(1),r(2,"translate"),s()),e&2&&(l(),E(x(2,1,"options.column.tree")))}function Wn(e,i){e&1&&u(0,"p-sortIcon",25)}function zn(e,i){if(e&1){let t=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(t);let p=a(2);return M(p.resetExcludedItems(o))}),s()}e&2&&m("pTooltip",x(1,1,"steps.itemsUndoTooltip"))}function Gn(e,i){e&1&&u(0,"p-sortIcon",38)}function qn(e,i){if(e&1){let t=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(t);let p=a(3);return M(p.resetBelts(o))}),s()}e&2&&m("pTooltip",x(1,1,"steps.beltsUndoTooltip"))}function Jn(e,i){if(e&1&&(_(0,"th",27)(1,"div",24)(2,"span"),S(3),r(4,"translate"),s(),c(5,Gn,1,0,"p-sortIcon",38)(6,qn,2,3,"button",26),s()()),e&2){let t=a(2);l(3),E(x(4,3,"options.column.belts")),l(2),d(t.focus()?-1:5),l(),d(t.itemsModified().belts?6:-1)}}function Kn(e,i){e&1&&u(0,"p-sortIcon",39)}function Xn(e,i){if(e&1){let t=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(t);let p=a(3);return M(p.resetWagons(o))}),s()}e&2&&m("pTooltip",x(1,1,"steps.wagonsUndoTooltip"))}function Qn(e,i){if(e&1&&(_(0,"th",28)(1,"div",24)(2,"span"),S(3),r(4,"translate"),s(),c(5,Kn,1,0,"p-sortIcon",39)(6,Xn,2,3,"button",26),s()()),e&2){let t=a(2);l(3),E(x(4,3,t.dispRateInfo().wagonsLabel)),l(2),d(t.focus()?-1:5),l(),d(t.itemsModified().wagons?6:-1)}}function Yn(e,i){e&1&&u(0,"p-sortIcon",30)}function Zn(e,i){if(e&1){let t=R();_(0,"button",37),r(1,"translate"),F("click",function(o){B(t);let p=a(2);return M(p.resetMachines(o))}),s()}e&2&&m("pTooltip",x(1,1,"steps.machinesUndoTooltip"))}function ti(e,i){if(e&1){let t=R();_(0,"button",37),r(1,"translate"),F("click",function(){B(t);let o=a(3);return M(o.resetBeacons())}),s()}e&2&&m("pTooltip",x(1,1,"steps.beaconsUndoTooltip"))}function ei(e,i){if(e&1&&(_(0,"th",31)(1,"div",24)(2,"span"),S(3),r(4,"translate"),s(),c(5,ti,2,3,"button",26),s()()),e&2){let t=a(2);l(3),E(x(4,2,"options.column.beacons")),l(2),d(t.recipesModified().beacons?5:-1)}}function ni(e,i){e&1&&u(0,"p-sortIcon",41)}function ii(e,i){if(e&1&&(_(0,"th",32)(1,"div",40)(2,"span"),S(3),r(4,"translate"),s(),c(5,ni,1,0,"p-sortIcon",41),s()()),e&2){let t=a(2);l(3),E(x(4,2,"options.column.power")),l(2),d(t.focus()?-1:5)}}function oi(e,i){e&1&&u(0,"p-sortIcon",42)}function ai(e,i){if(e&1&&(_(0,"th",33)(1,"div",40)(2,"span"),S(3),r(4,"translate"),s(),c(5,oi,1,0,"p-sortIcon",42),s()()),e&2){let t=a(2);l(3),E(x(4,2,t.dispRateInfo().pollutionLabel)),l(2),d(t.focus()?-1:5)}}function li(e,i){e&1&&u(0,"th")}function pi(e,i){if(e&1){let t=R();_(0,"tr")(1,"td",18)(2,"div",19)(3,"button",20),r(4,"translate"),F("click",function(){B(t);let o=a(),p=b(14);return M(p.open(o.columnsState()))}),s(),c(5,An,2,3,"button",21),s()()(),_(6,"tr",22),u(7,"th"),c(8,Hn,4,1,"th")(9,Un,3,3,"th"),_(10,"th",23)(11,"div",24)(12,"span"),S(13),r(14,"translate"),s(),c(15,Wn,1,0,"p-sortIcon",25)(16,zn,2,3,"button",26),s()(),c(17,Jn,7,5,"th",27)(18,Qn,7,5,"th",28),_(19,"th",29)(20,"div",24)(21,"span"),S(22),r(23,"translate"),s(),c(24,Yn,1,0,"p-sortIcon",30)(25,Zn,2,3,"button",26),s()(),c(26,ei,6,4,"th",31)(27,ii,6,4,"th",32)(28,ai,6,4,"th",33)(29,li,1,0,"th"),s()}if(e&2){let t=a();l(3),m("label",x(4,16,"steps.columnSettings")),l(2),d(t.steps().length?5:-1),l(3),d(!t.focus()&&t.columnsState().checkbox.show?8:-1),l(),d(!t.focus()&&t.columnsState().tree.show?9:-1),l(4),E(x(14,18,t.dispRateInfo().itemsLabel)),l(2),d(t.focus()?-1:15),l(),d(t.settings().excludedItemIds.size?16:-1),l(),d(t.columnsState().belts.show?17:-1),l(),d(t.columnsState().wagons.show?18:-1),l(4),E(x(23,20,"options.column.machines")),l(2),d(t.focus()?-1:24),l(),d(t.recipesModified().machines?25:-1),l(),d(t.columnsState().beacons.show?26:-1),l(),d(t.columnsState().power.show?27:-1),l(),d(t.columnsState().pollution.show?28:-1),l(),d(t.columnsState().link.show?29:-1)}}function _i(e,i){if(e&1&&u(0,"div",44),e&2){let t=i.$implicit,n=a();m("id","step_"+n.id+"_"+t.label)}}function si(e,i){if(e&1){let t=R();_(0,"td",47)(1,"div",52)(2,"p-checkbox",53),F("onChange",function(o){B(t);let p=a(),C=a(2);return M(C.changeStepChecked(p,o.checked))}),s()()()}if(e&2){let t=a();l(2),m("binary",!0)("ngModel",t.checked)}}function ci(e,i){if(e&1&&u(0,"div",60),e&2){let t=i.$implicit,n=i.$index,o=i.$count;Q("trail",t)("last",n===o-1)}}function ri(e,i){if(e&1&&(A(0,ci,1,4,"div",59,ct),u(2,"div",55)),e&2){let t=a(2),n=a(2);N(n.stepTree()[t.id])}}function di(e,i){if(e&1&&u(0,"lab-tooltip",63),e&2){let t=a(3);m("id",t.itemId)}}function mi(e,i){if(e&1){let t=R();_(0,"button",61),r(1,"iconSmClass"),F("click",function(){B(t);let o=a(2),p=a(2);return M(p.changeItemExcluded(o.itemId,!p.settings().excludedItemIds.has(o.itemId)))}),u(2,"i",62),c(3,di,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(4),n=a(2),o=a(2);Q("hover-active",o.settings().excludedItemIds.has(n.itemId)),m("icon",x(1,4,n.itemId))("pTooltip",t)}}function Ci(e,i){if(e&1&&(_(0,"span"),S(1),s()),e&2){let t=a(3);l(),P("#",t.recipeObjectiveId,"")}}function ui(e,i){if(e&1&&u(0,"lab-tooltip",65),e&2){let t=a(4);m("id",t.recipeId)}}function fi(e,i){if(e&1&&c(0,ui,1,1,"lab-tooltip",65),e&2){let t=a(3);d(t.recipeId?0:-1)}}function xi(e,i){if(e&1&&(_(0,"i",64),r(1,"iconSmClass"),c(2,Ci,2,1,"span")(3,fi,1,1,"ng-template",null,5,k),s()),e&2){let t=b(4),n=a(2);O(T(1,4,n.recipeId,"recipe")),m("pTooltip",t),l(2),d(n.recipeObjectiveId!=null?2:-1)}}function gi(e,i){if(e&1&&(_(0,"td",48)(1,"div",54),c(2,ri,3,0,"div",55),_(3,"div",56),c(4,mi,5,6,"button",57)(5,xi,5,7,"i",58),s()()()),e&2){let t,n=a(),o=a(2),p=b(1);l(2),d(!p.sortField&&((t=o.stepTree()[n.id])!=null&&t.length)?2:-1),l(2),d(n.itemId&&n.recipeObjectiveId==null?4:5)}}function Si(e,i){if(e&1&&(_(0,"span",67),S(1),r(2,"rate"),s()),e&2){let t=a(2),n=a(2);l(),P("(+",T(2,1,t.surplus,n.columnsState().items.precision),") ")}}function vi(e,i){if(e&1&&u(0,"lab-tooltip",63),e&2){let t=a(3);m("id",t.itemId)}}function hi(e,i){if(e&1){let t=R();_(0,"button",61),r(1,"iconSmClass"),F("click",function(){B(t);let o=a(2),p=a(2);return M(p.changeItemExcluded(o.itemId,!p.settings().excludedItemIds.has(o.itemId)))}),u(2,"i",62),c(3,vi,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(4),n=a(2),o=a(2);Q("hover-active",o.settings().excludedItemIds.has(n.itemId)),m("icon",x(1,4,n.itemId))("pTooltip",t)}}function Ii(e,i){if(e&1&&(_(0,"td",66),c(1,Si,3,4,"span",67),_(2,"span",67),S(3),r(4,"rate"),s()(),_(5,"td",68)(6,"div",24)(7,"span",69),S(8),s(),c(9,hi,5,6,"button",57),s()()),e&2){let t,n=a(),o=a(2);l(),d(n.surplus&&n.surplus.nonzero()?1:-1),l(2),E(T(4,4,n.items.sub((t=n.surplus)!==null&&t!==void 0?t:o.rational.zero),o.columnsState().items.precision)),l(5),E(o.data().itemEntities[n.itemId].name),l(),d(!o.preferences().hideDuplicateIcons||!o.columnsState().tree.show?9:-1)}}function bi(e,i){e&1&&u(0,"td",31)}function Ti(e,i){if(e&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),e&2){let t=a().$implicit;l(),O(x(2,2,t.value))}}function wi(e,i){if(e&1&&c(0,Ti,3,4,"div",45),e&2){let t=i.$implicit;d(t?0:-1)}}function yi(e,i){if(e&1&&u(0,"lab-tooltip",76),e&2){let t=a().$implicit;m("id",t.value)}}function Ei(e,i){if(e&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,yi,1,1,"ng-template",null,5,k),s()),e&2){let t=i.$implicit,n=b(6);m("pTooltip",n),l(),O(x(2,4,t.value)),l(3),P(" ",t.label," ")}}function ki(e,i){if(e&1&&u(0,"lab-tooltip",76),e&2){let t=a(2);m("id",t)}}function Bi(e,i){if(e&1){let t=R();_(0,"p-dropdown",71),F("onChange",function(o){let p=B(t),C=a(4),f=a(2);return M(f.itemsSvc.updateEntityField(C.itemId,"beltId",o.value,p))}),c(1,wi,1,1,"ng-template",72)(2,Ei,7,6,"ng-template",73)(3,ki,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(4),n=a(),o=a(5);m("pTooltip",t)("ngModel",n)("options",o.options().belts)}}function Mi(e,i){if(e&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),e&2){let t=i.$implicit;l(),O(x(2,2,t.value))}}function Oi(e,i){if(e&1&&u(0,"lab-tooltip",77),e&2){let t=a().$implicit;m("id",t.value)}}function Fi(e,i){if(e&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,Oi,1,1,"ng-template",null,5,k),s()),e&2){let t=i.$implicit,n=b(6);m("pTooltip",n),l(),O(x(2,4,t.value)),l(3),P(" ",t.label," ")}}function Ri(e,i){if(e&1&&u(0,"lab-tooltip",77),e&2){let t=a(3);m("id",t)}}function Vi(e,i){if(e&1){let t=R();_(0,"p-dropdown",71),F("onChange",function(o){let p=B(t),C=a(5),f=a(2);return M(f.itemsSvc.updateEntityField(C.itemId,"beltId",o.value,p))}),c(1,Mi,3,4,"ng-template",72)(2,Fi,7,6,"ng-template",73)(3,Ri,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(4),n=a(2),o=a(5);m("pTooltip",t)("ngModel",n)("options",o.options().pipes)}}function Pi(e,i){if(e&1&&u(0,"lab-tooltip",77),e&2){let t=a(3);m("id",t)}}function ji(e,i){if(e&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Pi,1,1,"ng-template",null,5,k),s()),e&2){let t=b(3),n=a(2);O(x(1,3,n)),m("pTooltip",t)}}function $i(e,i){if(e&1&&c(0,Vi,5,3,"p-dropdown",70)(1,ji,4,5,"i",58),e&2){let t,n=a(),o=a(5);d((t=o.data().pipeIds.indexOf(n)!==-1&&o.settings().pipeId)?0:1,t)}}function Di(e,i){if(e&1&&(_(0,"td",66)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",68)(5,"div",24),c(6,Bi,5,3,"p-dropdown",70)(7,$i,2,1),s()()),e&2){let t,n=a(3),o=a(2);l(2),E(T(3,2,n.belts,o.columnsState().belts.precision)),l(4),d((t=o.data().beltIds.indexOf(i)!==-1&&o.settings().beltId)?6:7,t)}}function Li(e,i){if(e&1&&c(0,Di,8,5),e&2){let t,n=a(2),o=a(2);d((t=o.itemsState()[n.itemId].beltId)?0:-1,t)}}function Ai(e,i){e&1&&u(0,"td",31)}function Ni(e,i){if(e&1&&c(0,Li,1,1)(1,Ai,1,0,"td",31),e&2){let t=a();d(t.itemId&&t.belts?0:1)}}function Hi(e,i){if(e&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),e&2){let t=a().$implicit;l(),O(x(2,2,t.value))}}function Ui(e,i){if(e&1&&c(0,Hi,3,4,"div",45),e&2){let t=i.$implicit;d(t?0:-1)}}function Wi(e,i){if(e&1&&u(0,"lab-tooltip",78),e&2){let t=a().$implicit;m("id",t.value)}}function zi(e,i){if(e&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,Wi,1,1,"ng-template",null,5,k),s()),e&2){let t=i.$implicit,n=b(6);m("pTooltip",n),l(),O(x(2,4,t.value)),l(3),P(" ",t.label," ")}}function Gi(e,i){if(e&1&&u(0,"lab-tooltip",78),e&2){let t=a(2);m("id",t)}}function qi(e,i){if(e&1){let t=R();_(0,"p-dropdown",71),F("onChange",function(o){let p=B(t),C=a(4),f=a(2);return M(f.itemsSvc.updateEntityField(C.itemId,"wagonId",o.value,p))}),c(1,Ui,1,1,"ng-template",72)(2,zi,7,6,"ng-template",73)(3,Gi,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(4),n=a(),o=a(5);m("pTooltip",t)("ngModel",n)("options",o.options().cargoWagons)}}function Ji(e,i){if(e&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),e&2){let t=a().$implicit;l(),O(x(2,2,t.value))}}function Ki(e,i){if(e&1&&c(0,Ji,3,4,"div",45),e&2){let t=i.$implicit;d(t?0:-1)}}function Xi(e,i){if(e&1&&u(0,"lab-tooltip",79),e&2){let t=a().$implicit;m("id",t.value)}}function Qi(e,i){if(e&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s()(),c(5,Xi,1,1,"ng-template",null,5,k)),e&2){let t=i.$implicit,n=b(6);m("pTooltip",n),l(),O(x(2,4,t.value)),l(3),P(" ",t.label," ")}}function Yi(e,i){if(e&1&&u(0,"lab-tooltip",79),e&2){let t=a(3);m("id",t)}}function Zi(e,i){if(e&1){let t=R();_(0,"p-dropdown",71),F("onChange",function(o){let p=B(t),C=a(5),f=a(2);return M(f.itemsSvc.updateEntityField(C.itemId,"wagonId",o.value,p))}),c(1,Ki,1,1,"ng-template",72)(2,Qi,7,6,"ng-template",73)(3,Yi,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(4),n=a(2),o=a(5);m("pTooltip",t)("ngModel",n)("options",o.options().fluidWagons)}}function to(e,i){if(e&1&&c(0,Zi,5,3,"p-dropdown",70),e&2){let t,n=a(),o=a(5);d((t=o.data().fluidWagonIds.indexOf(n)!==-1&&o.settings().fluidWagonId)?0:-1,t)}}function eo(e,i){if(e&1&&(_(0,"td",66)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",68)(5,"div",24),c(6,qi,5,3,"p-dropdown",70)(7,to,1,1),s()()),e&2){let t,n=a(3),o=a(2);l(2),E(T(3,2,n.wagons,o.columnsState().wagons.precision)),l(4),d((t=o.data().cargoWagonIds.indexOf(i)!==-1&&o.settings().cargoWagonId)?6:7,t)}}function no(e,i){if(e&1&&c(0,eo,8,5),e&2){let t,n=a(2),o=a(2);d((t=o.itemsState()[n.itemId].wagonId)?0:-1,t)}}function io(e,i){e&1&&u(0,"td",31)}function oo(e,i){if(e&1&&c(0,no,1,1)(1,io,1,0,"td",31),e&2){let t=a();d(t.itemId&&t.wagons?0:1)}}function ao(e,i){if(e&1&&(_(0,"span",67),S(1),r(2,"machineRate"),s()),e&2){let t=a(),n=a(),o=a(2);l(),E(lt(2,1,n.machines,o.columnsState().machines.precision,t))}}function lo(e,i){if(e&1&&(_(0,"span"),S(1),s()),e&2){let t=a(4);l(),P("#",t.recipeObjectiveId,"")}}function po(e,i){if(e&1&&u(0,"lab-tooltip",65),e&2){let t=a(4);m("id",t.recipeId)}}function _o(e,i){if(e&1){let t=R();_(0,"button",83),F("click",function(){B(t);let o=a(3),p=a(2);return M(p.objectivesSvc.add({targetId:o.recipeId,unit:p.ObjectiveUnit.Machines}))}),_(1,"span",84),r(2,"iconSmClass"),c(3,lo,2,1,"span"),s(),u(4,"i",85),c(5,po,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(6),n=a(3);m("pTooltip",t),l(),O(T(2,4,n.recipeId,"recipe")),l(2),d(n.recipeObjectiveId?3:-1)}}function so(e,i){if(e&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),e&2){let t=a().$implicit;l(),O(x(2,2,t.value))}}function co(e,i){if(e&1&&c(0,so,3,4,"div",45),e&2){let t=i.$implicit;d(t?0:-1)}}function ro(e,i){if(e&1&&u(0,"lab-tooltip",87),e&2){let t=a().$implicit;m("id",t.value)}}function mo(e,i){if(e&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,ro,1,1,"ng-template",null,5,k),s()),e&2){let t=i.$implicit,n=b(6);m("pTooltip",n),l(),O(x(2,4,t.value)),l(3),P(" ",t.label," ")}}function Co(e,i){if(e&1&&u(0,"lab-tooltip",87),e&2){let t=a(3);m("id",t)}}function uo(e,i){if(e&1){let t=R();_(0,"p-dropdown",86),r(1,"options"),F("onChange",function(o){B(t);let p=a(3),C=a(2);return M(C.changeRecipeField(p,o.value,"machine"))}),c(2,co,1,1,"ng-template",72)(3,mo,7,6,"ng-template",73)(4,Co,1,1,"ng-template",null,5,k),s()}if(e&2){let t=b(5),n=a(2),o=a(),p=a(2);m("pTooltip",t)("options",T(1,3,o.recipe.producers,p.data().itemEntities))("ngModel",n)}}function fo(e,i){if(e&1){let t=R();_(0,"p-inputNumber",88,6),r(2,"translate"),F("onBlur",function(){let o;B(t);let p=b(1),C=a(3),f=a(2);return M(f.changeRecipeField(C,(o=p.value)!==null&&o!==void 0?o:100,"overclock"))}),s()}if(e&2){let t=a(3);m("min",1)("max",250)("step",10)("maxFractionDigits",2)("size",3)("pTooltip",x(2,7,"steps.overclockTooltip"))("ngModel",t.recipeSettings.overclock)}}function xo(e,i){if(e&1&&u(0,"lab-tooltip",90),e&2){let t=a(2);m("id",t)}}function go(e,i){if(e&1&&(_(0,"div",24)(1,"i",89),r(2,"iconSmClass"),c(3,xo,1,1,"ng-template",null,5,k),s()()),e&2){let t=b(4),n=a();l(),O(x(2,3,n)),m("pTooltip",t)}}function So(e,i){if(e&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),e&2){let t=i.$implicit;l(),O(x(2,2,t.value))}}function vo(e,i){if(e&1&&u(0,"lab-tooltip",90),e&2){let t=a().$implicit;m("id",t.value)}}function ho(e,i){if(e&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,vo,1,1,"ng-template",null,5,k),s()),e&2){let t=i.$implicit,n=b(6);m("pTooltip",n),l(),O(x(2,4,t.value)),l(3),P(" ",t.label," ")}}function Io(e,i){if(e&1&&u(0,"lab-tooltip",90),e&2){let t=a(2);m("id",t)}}function bo(e,i){if(e&1){let t=R();_(0,"p-dropdown",71),F("onChange",function(o){B(t);let p=a(4),C=a(2);return M(C.changeRecipeField(p,o.value,"fuel"))}),c(1,So,3,4,"ng-template",72)(2,ho,7,6,"ng-template",73)(3,Io,1,1,"ng-template",null,5,k),s()}if(e&2){let t,n=b(4),o=a(),p=a(3);m("pTooltip",n)("ngModel",o)("options",(t=p.recipeSettings.fuelOptions)!==null&&t!==void 0?t:X(3,ln))}}function To(e,i){if(e&1&&c(0,go,5,5,"div",24)(1,bo,5,4,"p-dropdown",70),e&2){let t=a(3);d(t.recipe.isBurn?0:t.recipeSettings.machineId?1:-1)}}function wo(e,i){if(e&1&&(_(0,"div",45),u(1,"i"),r(2,"iconSmClass"),s()),e&2){let t=i.$implicit;l(),O(x(2,2,t.value))}}function yo(e,i){if(e&1&&u(0,"lab-tooltip",93),e&2){let t=a().$implicit;m("id",t.value)}}function Eo(e,i){if(e&1&&(_(0,"div",74),u(1,"i"),r(2,"iconSmClass"),_(3,"div",75),S(4),s(),c(5,yo,1,1,"ng-template",null,5,k),s()),e&2){let t=i.$implicit,n=b(6);m("pTooltip",t.value!=="module"?n:void 0),l(),O(x(2,4,t.value)),l(3),P(" ",t.label," ")}}function ko(e,i){if(e&1){let t=R();_(0,"p-dropdown",92),r(1,"translate"),F("onChange",function(o){B(t);let p=a(5),C=a(2);return M(C.changeRecipeField(p,[{id:o.value,count:C.rational.one}],"modules"))}),c(2,wo,3,4,"ng-template",72)(3,Eo,7,6,"ng-template",73),s()}if(e&2){let t,n=a(2),o=a(3);m("pTooltip",x(1,3,"settings.modifierTooltip"))("ngModel",n[0].id)("options",(t=o.recipeSettings.moduleOptions)!==null&&t!==void 0?t:X(5,ln))}}function Bo(e,i){if(e&1&&(_(0,"i",84),r(1,"iconSmClass"),_(2,"span"),S(3),s()()),e&2){let t=i.$implicit;O(x(1,3,t.id)),l(3),E(t.count)}}function Mo(e,i){if(e&1&&u(0,"lab-tooltip",93),e&2){let t=a().$implicit;m("id",t.id)}}function Oo(e,i){if(e&1&&c(0,Mo,1,1,"lab-tooltip",93),e&2){let t=i.$implicit;d(t.id?0:-1)}}function Fo(e,i){if(e&1&&A(0,Oo,1,1,null,null,Pt),e&2){let t=a(3);N(t)}}function Ro(e,i){if(e&1){let t=R();_(0,"button",94),F("click",function(o){B(t);let p=b(5),C=a(),f=a(),g=a(3);return M(p.show(o,f,C,g.recipeId))}),A(1,Bo,4,5,"i",95,Pt),u(3,"i",96),s(),_(4,"lab-modules-overlay",97,7),F("setValue",function(o){B(t);let p=a(5),C=a(2);return M(C.changeRecipeField(p,o,"modules"))}),s(),c(6,Fo,2,0,"ng-template",null,5,k)}if(e&2){let t=b(7),n=a(2);m("pTooltip",t),l(),N(n)}}function Vo(e,i){if(e&1&&c(0,ko,4,6,"p-dropdown",91)(1,Ro,8,1),e&2){let t=i;d(t.modules!==!0&&(t.modules!=null&&t.modules.isOne())?0:t.modules!=null?1:-1)}}function Po(e,i){if(e&1&&c(0,Vo,2,1),e&2){let t,n=a(2),o=a(3);d((t=o.data().machineEntities[n])?0:-1,t)}}function jo(e,i){if(e&1&&(_(0,"div",24)(1,"span",69),S(2),s(),c(3,_o,7,7,"button",80)(4,uo,6,6,"p-dropdown",81),r(5,"machineShow"),c(6,fo,3,9,"p-inputNumber",82)(7,To,2,1)(8,Po,1,1),s()),e&2){let t,n,o=a(),p=a(),C=a(2);l(2),E(p.recipe.name),l(),d(!C.preferences().hideDuplicateIcons||p.itemId!=null&&p.itemId!==p.recipeId?3:-1),l(),d(T(5,6,o,C.data().game)?4:-1),l(2),d(C.data().game===C.Game.Satisfactory?6:-1),l(),d((t=p.recipeSettings==null?null:p.recipeSettings.fuelId)?7:-1,t),l(),d((n=p.recipeSettings==null?null:p.recipeSettings.modules)?8:-1,n)}}function $o(e,i){if(e&1&&(_(0,"td",66),c(1,ao,3,5,"span",67),r(2,"machineShowRate"),s(),_(3,"td",68),c(4,jo,9,9,"div",24),s()),e&2){let t=a(),n=a(2);l(),d(t.machines&&t.machines.nonzero()&&T(2,2,i,n.data().game)?1:-1),l(3),d(t.recipeId&&t.recipe&&t.recipeSettings?4:-1)}}function Do(e,i){e&1&&u(0,"td",31)}function Lo(e,i){if(e&1&&(_(0,"i",100),r(1,"iconSmClass"),_(2,"span"),S(3),s()()),e&2){let t=a().$implicit;O(x(1,3,t.id)),l(3),E(t.total)}}function Ao(e,i){if(e&1&&(_(0,"i",84),r(1,"iconSmClass"),_(2,"span"),S(3),s()()),e&2){let t=i.$implicit;O(x(1,3,t.id)),l(3),E(t.count)}}function No(e,i){if(e&1&&(_(0,"div",45)(1,"i",84),r(2,"iconSmClass"),_(3,"span"),S(4),s()(),c(5,Lo,4,5,"i",99),A(6,Ao,4,5,"i",95,Pt),s()),e&2){let t=i.$implicit;l(),O(x(2,4,t.id)),l(3),E(t.count),l(),d(t.total?5:-1),l(),N(t.modules)}}function Ho(e,i){e&1&&u(0,"lab-tooltip",101),e&2&&m("id",i)}function Uo(e,i){if(e&1&&c(0,Ho,1,1,"lab-tooltip",101),e&2){let t,n=a(3);d((t=n.recipeSettings.beacons==null||n.recipeSettings.beacons[0]==null?null:n.recipeSettings.beacons[0].id)?0:-1,t)}}function Wo(e,i){if(e&1){let t=R();_(0,"button",98),F("click",function(o){B(t);let p=b(5),C=a(2);return M(p.show(o,C.recipeSettings.beacons))}),A(1,No,8,6,"div",45,ct),u(3,"i",96),s(),_(4,"lab-beacons-overlay",97,8),F("setValue",function(o){B(t);let p=a(2),C=a(2);return M(C.changeRecipeField(p,o,"beacons"))}),s(),c(6,Uo,1,1,"ng-template",null,5,k)}if(e&2){let t=b(7),n=a(2);m("pTooltip",t),l(),N(n.recipeSettings.beacons)}}function zo(e,i){if(e&1&&(_(0,"td",49),c(1,Wo,8,1),s()),e&2){let t=a();l(),d(t.recipeId&&t.recipeSettings&&t.recipeSettings.beacons?1:-1)}}function Go(e,i){if(e&1&&(_(0,"span",67),S(1),r(2,"power"),s()),e&2){let t=a(2),n=a(2);l(),E(lt(2,1,t.power,n.columnsState().power.precision,n.effectivePowerUnit()))}}function qo(e,i){if(e&1&&(_(0,"td",50),c(1,Go,3,5,"span",67),s()),e&2){let t=a();l(),d(t.power&&t.power.nonzero()?1:-1)}}function Jo(e,i){if(e&1&&(_(0,"span",67),S(1),r(2,"rate"),s()),e&2){let t=a(2),n=a(2);l(),E(T(2,1,t.pollution,n.columnsState().pollution.precision))}}function Ko(e,i){if(e&1&&(_(0,"td",50),c(1,Jo,3,4,"span",67),s()),e&2){let t=a();l(),d(t.pollution&&t.pollution.nonzero()?1:-1)}}function Xo(e,i){if(e&1){let t=R();_(0,"button",105),r(1,"translate"),F("click",function(){B(t);let o=a(2),p=a(2);return M(p.resetStep(o))}),s()}e&2&&m("pTooltip",x(1,1,"steps.stepUndoTooltip"))}function Qo(e,i){if(e&1&&(_(0,"td",51)(1,"div",45)(2,"a",102),r(3,"stepHref"),r(4,"async"),u(5,"button",103),r(6,"translate"),s(),c(7,Xo,2,3,"button",104),s()()),e&2){let t=a(),n=a(2);l(2),m("queryParams",x(4,6,T(3,3,t,n.routerSvc.zipConfig()))),l(3),m("pTooltip",x(6,8,"steps.openNewTabTooltip")),l(2),d(t.recipeId&&n.stepsModified().recipes[t.recipeId]||t.itemId&&n.stepsModified().items[t.itemId]||t.recipeObjectiveId&&n.stepsModified().objectives[t.recipeObjectiveId]?7:-1)}}function Yo(e,i){if(e&1){let t=R();_(0,"tr")(1,"td",43),u(2,"div",44),A(3,_i,1,1,"div",44,Pt),_(5,"div",45)(6,"button",46),r(7,"translate"),F("click",function(){let o=B(t),p=a().expanded,C=a();return M(C.expandRow(o,p))}),s()()(),c(8,si,3,2,"td",47)(9,gi,6,2,"td",48)(10,Ii,10,7)(11,bi,1,0,"td",31)(12,Ni,2,1)(13,oo,2,1)(14,$o,5,5)(15,Do,1,0,"td",31)(16,zo,2,1,"td",49)(17,qo,2,1,"td",50)(18,Ko,2,1,"td",50)(19,Qo,8,10,"td",51),s()}if(e&2){let t,n=i,o=a().expanded,p=a();l(2),m("id","step_"+n.id),l(),N(p.stepDetails()[n.id].tabs),l(3),Q("fa-rotate-90",o),m("pTooltip",x(7,15,o?"steps.hideDetails":"steps.showDetails"))("pRowToggler",n),l(2),d(!p.focus()&&p.columnsState().checkbox.show?8:-1),l(),d(!p.focus()&&p.columnsState().tree.show?9:-1),l(),d(n.itemId&&n.items?10:11),l(2),d(p.columnsState().belts.show?12:-1),l(),d(p.columnsState().wagons.show?13:-1),l(),d((t=n.recipeSettings==null?null:n.recipeSettings.machineId)?14:15,t),l(2),d(p.columnsState().beacons.show?16:-1),l(),d(p.columnsState().power.show?17:-1),l(),d(p.columnsState().pollution.show?18:-1),l(),d(p.columnsState().link.show?19:-1)}}function Zo(e,i){if(e&1&&(c(0,Yo,20,17,"tr"),r(1,"asStep")),e&2){let t,n=i.$implicit;d((t=x(1,1,n))?0:-1,t)}}function ta(e,i){if(e&1&&(_(0,"a",111),u(1,"span",112),_(2,"span",113),S(3),r(4,"translate"),s()()),e&2){let t=i.$implicit,n=a(3);m("id",t.id),l(),O(n.stepDetailIcon[t.label]),l(2),E(x(4,4,"options.stepDetailTab."+t.label))}}function ea(e,i){e&1&&j(0)}function na(e,i){if(e&1&&(_(0,"tr",106),c(1,ea,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()()),e&2){a(4);let t=b(9);l(),m("ngTemplateOutlet",t),l(2),P(" ",x(4,2,"steps.sources")," ")}}function ia(e,i){e&1&&j(0)}function oa(e,i){if(e&1&&c(0,ia,1,0,"ng-container",116),e&2){let t=a().$implicit,n=a(2),o=a(2),p=b(11);m("ngTemplateOutlet",p)("ngTemplateOutletContext",Y(2,Mn,[n.items==null?null:n.items.mul(t.value),n.itemId,n.belts==null?null:n.belts.mul(t.value),o.itemsState()[n.itemId].beltId,n.wagons==null?null:n.wagons.mul(t.value),o.itemsState()[n.itemId].wagonId,t.step==null?null:t.step.machines,t.step==null||t.step.recipeSettings==null?null:t.step.recipeSettings.machineId,t.step==null?null:t.step.recipeId,t.step==null?null:t.step.recipeObjectiveId,t.value,n.itemId,t.inputs]))}}function aa(e,i){if(e&1&&c(0,oa,1,16,"ng-container"),e&2){let t=a(2);d(t.itemId?0:-1)}}function la(e,i){e&1&&j(0)}function pa(e,i){if(e&1&&(_(0,"tr",106),c(1,la,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()()),e&2){a(4);let t=b(9);l(),m("ngTemplateOutlet",t),l(2),P(" ",x(4,2,"steps.destinations")," ")}}function _a(e,i){e&1&&j(0)}function sa(e,i){if(e&1&&c(0,_a,1,0,"ng-container",116),e&2){let t,n=a().$implicit,o=a(2),p=a(2),C=b(11);m("ngTemplateOutlet",C)("ngTemplateOutletContext",Y(2,On,[o.items==null?null:o.items.mul(n.value),o.itemId,o.belts==null?null:o.belts.mul(n.value),p.itemsState()[o.itemId].beltId,o.wagons==null?null:o.wagons.mul(n.value),p.itemsState()[o.itemId].wagonId,p.stepDetails()[o.id].outputs.length===1?o.machines==null?null:o.machines.mul(n.value):null,p.stepDetails()[o.id].outputs.length===1?o.recipeSettings==null?null:o.recipeSettings.machineId:null,o.recipeId,o.recipeObjectiveId,n.value,(t=p.stepById()[n.key])==null?null:t.recipeId,(t=p.stepById()[n.key])==null?null:t.recipeObjectiveId,n.key===""]))}}function ca(e,i){if(e&1&&c(0,sa,1,17,"ng-container"),e&2){let t=a(2);d(t.itemId?0:-1)}}function ra(e,i){if(e&1&&(c(0,na,5,4,"tr",106),A(1,aa,1,1,null,null,ct),c(3,pa,5,4,"tr",106),A(4,ca,1,1,null,null,q),r(6,"keyvalue")),e&2){let t=a(),n=a(2);d(n.stepDetails()[t.id].outputs.length?0:-1),l(),N(n.stepDetails()[t.id].outputs),l(2),d(t.parents?3:-1),l(),N(T(6,2,t.parents,n.trackSvc.sortByValue))}}function da(e,i){e&1&&j(0)}function ma(e,i){e&1&&j(0)}function Ca(e,i){if(e&1&&c(0,ma,1,0,"ng-container",116),e&2){let t=a(),n=a().$implicit,o=a(4);a(2);let p=b(11);m("ngTemplateOutlet",p)("ngTemplateOutletContext",H(2,Fn,t.step.items.mul(t.percent).div(o.recipe.productivity),n.key))}}function ua(e,i){if(e&1&&c(0,Ca,1,5,"ng-container"),e&2){let t=i;d(t.step&&t.percent&&t.step.items?0:-1)}}function fa(e,i){if(e&1&&c(0,ua,1,1),e&2){let t,n=i.$implicit,o=a(4),p=a(2);d((t=H(1,jt,p.stepByItemEntities()[n.key],o.outputs==null?null:o.outputs[n.key]))?0:-1,t)}}function xa(e,i){if(e&1&&(_(0,"tr",106),c(1,da,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()(),A(5,fa,1,4,null,null,q),r(7,"keyvalue")),e&2){let t=a(3),n=a(2),o=b(9);l(),m("ngTemplateOutlet",o),l(2),P(" ",x(4,2,"steps.depletion")," "),l(2),N(T(7,4,t.outputs,n.trackSvc.sortByValue))}}function ga(e,i){e&1&&j(0)}function Sa(e,i){e&1&&j(0)}function va(e,i){if(e&1&&c(0,Sa,1,0,"ng-container",116),e&2){let t=i,n=a(2),o=a().$implicit,p=a(4),C=a(2),f=b(11);m("ngTemplateOutlet",f)("ngTemplateOutletContext",Y(2,Rn,[n.step.items==null?null:n.step.items.mul(n.percent),o.key,n.step.belts==null?null:n.step.belts.mul(n.percent),C.itemsState()[n.step.itemId].beltId,n.step.wagons==null?null:n.step.wagons.mul(n.percent),C.itemsState()[n.step.itemId].wagonId,t.step==null?null:t.step.machines,t.step==null||t.step.recipeSettings==null?null:t.step.recipeSettings.machineId,t.step==null?null:t.step.recipeId,t.step==null?null:t.step.recipeObjectiveId,n.percent,p.recipeId,p.recipeObjectiveId]))}}function ha(e,i){e&1&&j(0)}function Ia(e,i){if(e&1&&c(0,ha,1,0,"ng-container",116),e&2){let t=a(2),n=a().$implicit,o=a(4),p=a(2),C=b(11);m("ngTemplateOutlet",C)("ngTemplateOutletContext",Y(2,Vn,[t.step.items==null?null:t.step.items.mul(t.percent),n.key,t.step.belts==null?null:t.step.belts.mul(t.percent),p.itemsState()[t.step.itemId].beltId,t.step.wagons==null?null:t.step.wagons.mul(t.percent),p.itemsState()[t.step.itemId].wagonId,t.percent,o.recipeId,o.recipeObjectiveId]))}}function ba(e,i){if(e&1&&c(0,va,1,16,"ng-container")(1,Ia,1,12,"ng-container"),e&2){let t,n=a(),o=a(7);d((t=o.stepDetails()[n.step.id].outputs.length===1&&o.stepDetails()[n.step.id].outputs[0])?0:1,t)}}function Ta(e,i){if(e&1&&c(0,ba,2,1),e&2){let t=i;d(t.step.itemId&&t.percent?0:-1)}}function wa(e,i){if(e&1&&c(0,Ta,1,1),e&2){let t,n=i.$implicit,o=a(4),p=a(2);d((t=H(1,jt,p.stepByItemEntities()[n.key],(t=p.stepByItemEntities()[n.key].parents)==null?null:t[o.id]))?0:-1,t)}}function ya(e,i){if(e&1&&(_(0,"tr",106),c(1,ga,1,0,"ng-container",114),_(2,"td",115),S(3),r(4,"translate"),s()(),A(5,wa,1,4,null,null,q),r(7,"keyvalue")),e&2){let t=a(3),n=a(2),o=b(9);l(),m("ngTemplateOutlet",o),l(2),P(" ",x(4,2,"steps.inputs")," "),l(2),N(T(7,4,t.recipe.in,n.trackSvc.sortByValue))}}function Ea(e,i){e&1&&j(0)}function ka(e,i){e&1&&j(0)}function Ba(e,i){e&1&&j(0)}function Ma(e,i){e&1&&j(0)}function Oa(e,i){if(e&1&&c(0,Ma,1,0,"ng-container",116),e&2){let t=a(),n=a().$implicit,o=a(3),p=a(2),C=b(11);m("ngTemplateOutlet",C)("ngTemplateOutletContext",Y(2,Pn,[t.step.items==null?null:t.step.items.mul(t.percent),n.key,t.step.belts==null?null:t.step.belts.mul(t.percent),p.itemsState()[t.step.itemId].beltId,t.step.wagons==null?null:t.step.wagons.mul(t.percent),p.itemsState()[t.step.itemId].wagonId,o.machines,o.recipeSettings==null?null:o.recipeSettings.machineId,o.recipeId,o.recipeObjectiveId,t.percent,n.key,o.recipeObjectiveId]))}}function Fa(e,i){if(e&1&&c(0,Oa,1,16,"ng-container"),e&2){let t=i;d(t.step.itemId&&t.percent?0:-1)}}function Ra(e,i){if(e&1&&c(0,Fa,1,1),e&2){let t,n=i.$implicit,o=a(3),p=a(2);d((t=H(1,jt,p.stepByItemEntities()[n.key],o.outputs==null?null:o.outputs[n.key]))?0:-1,t)}}function Va(e,i){if(e&1&&(c(0,xa,8,7)(1,ya,8,7),r(2,"keyvalue"),_(3,"tr",106),c(4,Ea,1,0,"ng-container",114),_(5,"td",115),S(6),r(7,"translate"),s()(),_(8,"tr",106),c(9,ka,1,0,"ng-container",114),_(10,"td",117)(11,"span",67),S(12),r(13,"rate"),s()(),_(14,"td",118)(15,"div",45),u(16,"i",119),s()(),u(17,"td",18),s(),_(18,"tr",106),c(19,Ba,1,0,"ng-container",114),_(20,"td",115),S(21),r(22,"translate"),s()(),A(23,Ra,1,4,null,null,q),r(25,"keyvalue")),e&2){let t=a(2),n=a(2),o=b(9);d(n.data().game===n.Game.Factorio&&t.recipe.isMining?0:-1),l(),d(x(2,8,t.recipe.in).length?1:-1),l(3),m("ngTemplateOutlet",o),l(2),P(" ",x(7,10,"steps.time")," "),l(3),m("ngTemplateOutlet",o),l(3),E(T(13,12,t.recipe.time,n.columnsState().items.precision)),l(7),m("ngTemplateOutlet",o),l(2),P(" ",x(22,15,"steps.outputs")," "),l(2),N(T(25,17,t.recipe.out,n.trackSvc.sortByValue))}}function Pa(e,i){if(e&1&&c(0,Va,26,20),e&2){let t=a();d(t.recipe?0:-1)}}function ja(e,i){e&1&&j(0)}function $a(e,i){if(e&1&&(c(0,ja,1,0,"ng-container",116),r(1,"rate")),e&2){let t=a(2),n=a().$implicit;a();let o=b(28),p=a(2),C=a(2);m("ngTemplateOutlet",o)("ngTemplateOutletContext",H(5,ot,T(1,2,t.step.items.mul(t.percent).div(p.machines),C.columnsState().items.precision),n.key))}}function Da(e,i){e&1&&j(0)}function La(e,i){if(e&1&&(c(0,Da,1,0,"ng-container",116),r(1,"rate")),e&2){let t=a(4);a(2);let n=b(28),o=a(2),p=a(2);m("ngTemplateOutlet",n)("ngTemplateOutletContext",H(5,ot,T(1,2,t.step.belts.mul(t.percent).div(o.machines),p.columnsState().belts.precision),i))}}function Aa(e,i){if(e&1&&c(0,La,2,8,"ng-container"),e&2){let t,n=a(4).$implicit,o=a(5);d((t=o.itemsState()[n.key].beltId)?0:-1,t)}}function Na(e,i){if(e&1&&(_(0,"td"),c(1,Aa,1,1),s()),e&2){let t=a(2);l(),d(t.step.belts?1:-1)}}function Ha(e,i){e&1&&j(0)}function Ua(e,i){if(e&1&&(c(0,Ha,1,0,"ng-container",116),r(1,"rate")),e&2){let t=i;a(6);let n=b(28);m("ngTemplateOutlet",n)("ngTemplateOutletContext",H(5,ot,T(1,2,t.value,1),t.id))}}function Wa(e,i){if(e&1&&(c(0,Ua,2,8,"ng-container"),r(1,"inserterSpeed")),e&2){let t,n=a(3),o=a(4),p=a(2);d((t=T(1,1,n.step.items.mul(n.percent).div(o.machines).div(p.dispRateInfo().value),p.settings()))?0:-1,t)}}function za(e,i){if(e&1&&(_(0,"td"),c(1,Wa,2,4),s()),e&2){let t=a(2),n=a().$implicit,o=a(5);l(),d(o.itemsState()[n.key].beltId!==o.ItemId.Pipe&&t.step.items?1:-1)}}function Ga(e,i){if(e&1&&(_(0,"tr")(1,"td"),c(2,$a,2,8,"ng-container"),s(),c(3,Na,2,1,"td")(4,za,2,1,"td"),s()),e&2){let t=a(),n=a(6);l(2),d(t.step.items?2:-1),l(),d(n.columnsState().belts.show?3:-1),l(),d(n.data().game===n.Game.Factorio?4:-1)}}function qa(e,i){e&1&&c(0,Ga,5,3,"tr"),e&2&&d(i.percent?0:-1)}function Ja(e,i){if(e&1&&c(0,qa,1,1),e&2){let t,n=i.$implicit,o=a(3),p=a(2);d((t=H(1,jt,p.stepByItemEntities()[n.key],(t=p.stepByItemEntities()[n.key].parents)==null?null:t[o.id]))?0:-1,t)}}function Ka(e,i){e&1&&u(0,"i",122)}function Xa(e,i){if(e&1&&u(0,"lab-tooltip",65),e&2){let t=a(4);m("id",t.recipeId)}}function Qa(e,i){if(e&1&&u(0,"lab-tooltip",87),e&2){let t=a();m("id",t)}}function Ya(e,i){if(e&1&&(_(0,"div",24)(1,"i",64),r(2,"iconClass"),c(3,Xa,1,1,"ng-template",null,5,k),s(),_(5,"i",64),r(6,"iconClass"),c(7,Qa,1,1,"ng-template",null,5,k),s()()),e&2){let t=b(4),n=a(3);l(),O(T(2,6,n.recipeId,"recipe")),m("pTooltip",t),l(4),O(x(6,9,i)),m("pTooltip",t)}}function Za(e,i){e&1&&j(0)}function tl(e,i){if(e&1&&(c(0,Za,1,0,"ng-container",116),r(1,"rate")),e&2){let t=i;a(5);let n=b(28);m("ngTemplateOutlet",n)("ngTemplateOutletContext",H(5,ot,T(1,2,t.value,1),t.id))}}function el(e,i){if(e&1&&(c(0,tl,2,8,"ng-container"),r(1,"inserterSpeed")),e&2){let t,n=a(2),o=a(6);d((t=T(1,1,n,o.settings()))?0:-1,t)}}function nl(e,i){if(e&1&&(_(0,"td"),c(1,el,2,4),s()),e&2){let t=a(2).$implicit,n=a(5);l(),d(n.itemsState()[t.key].beltId!==n.ItemId.Pipe?1:-1)}}function il(e,i){e&1&&j(0)}function ol(e,i){if(e&1&&(c(0,il,1,0,"ng-container",116),r(1,"rate")),e&2){let t=i,n=a(2);a(2);let o=b(28),p=a(4);m("ngTemplateOutlet",o)("ngTemplateOutletContext",H(5,ot,T(1,2,n.div(p.beltSpeed()[t]),p.columnsState().belts.precision),t))}}function al(e,i){if(e&1&&(_(0,"td"),c(1,ol,2,8,"ng-container"),s()),e&2){let t,n=a(2).$implicit,o=a(5);l(),d((t=o.itemsState()[n.key].beltId)?1:-1,t)}}function ll(e,i){e&1&&j(0)}function pl(e,i){if(e&1&&(_(0,"tr"),c(1,nl,2,1,"td")(2,al,2,1,"td"),_(3,"td"),c(4,ll,1,0,"ng-container",116),r(5,"rate"),s()()),e&2){let t=a().$implicit;a();let n=b(28),o=a(4);l(),d(o.data().game===o.Game.Factorio?1:-1),l(),d(o.columnsState().belts.show?2:-1),l(2),m("ngTemplateOutlet",n)("ngTemplateOutletContext",H(7,ot,T(5,4,i.mul(o.dispRateInfo().value),o.columnsState().items.precision),t.key))}}function _l(e,i){if(e&1&&c(0,pl,6,10,"tr"),e&2){let t,n=i.$implicit,o=a(3);d((t=n.value.div(o.recipe.time))?0:-1,t)}}function sl(e,i){if(e&1&&u(0,"lab-tooltip",63),e&2){let t=a().itemId;m("id",t)}}function cl(e,i){if(e&1&&(_(0,"div",40)(1,"span",67),S(2),s(),_(3,"i",64),r(4,"iconClass"),c(5,sl,1,1,"ng-template",null,5,k),s()()),e&2){let t=i.value,n=i.itemId,o=b(6);l(2),E(t),l(),O(x(4,4,n)),m("pTooltip",o)}}function rl(e,i){if(e&1&&(_(0,"div",24)(1,"table",121),A(2,Ja,1,4,null,null,q),r(4,"keyvalue"),s(),c(5,Ka,1,0,"i",122),r(6,"keyvalue"),_(7,"table",121)(8,"tr")(9,"td",117)(10,"span",67),S(11),r(12,"rate"),s()(),_(13,"td"),c(14,Ya,9,11,"div",24),s()(),_(15,"tr")(16,"td",117)(17,"span",67),S(18),r(19,"rate"),s()(),_(20,"td"),u(21,"i",119),s()()(),u(22,"i",122),_(23,"table",121),A(24,_l,1,1,null,null,q),r(26,"keyvalue"),s(),c(27,cl,7,6,"ng-template",null,10,k),s()),e&2){let t,n=a(2),o=a(2);l(2),N(T(4,4,n.recipe.in,o.trackSvc.sortByValue)),l(3),d(x(6,7,n.recipe.in).length?5:-1),l(6),E(T(12,9,o.rational.one,o.columnsState().machines.precision)),l(3),d((t=n.recipeSettings==null?null:n.recipeSettings.machineId)?14:-1,t),l(4),E(T(19,12,o.dispRateInfo().value,o.columnsState().machines.precision)),l(6),N(T(26,15,n.recipe.out,o.trackSvc.sortByValue))}}function dl(e,i){e&1&&(u(0,"small",120),r(1,"translate")),e&2&&m("innerHTML",x(1,1,"steps.inserterCountInfo"),te)}function ml(e,i){if(e&1&&(_(0,"tr",106),u(1,"td"),_(2,"td",18),c(3,rl,29,18,"div",24)(4,dl,2,3,"small",120),s()()),e&2){let t=a(),n=a(2);l(3),d(t.recipeId&&t.recipe&&t.machines?3:-1),l(),d(n.data().game===n.Game.Factorio?4:-1)}}function Cl(e,i){if(e&1&&u(0,"lab-tooltip",65),e&2){let t=a().$implicit;m("id",t)}}function ul(e,i){if(e&1){let t=R();_(0,"button",128),r(1,"iconSmClass"),F("click",function(){let o=B(t).$implicit,p=a(5);return M(p.changeRecipesExcluded([o],!p.settings().excludedRecipeIds.has(o)))}),u(2,"i",62),c(3,Cl,1,1,"ng-template",null,5,k),s()}if(e&2){let t=i.$implicit,n=b(4),o=a(5);Q("hover-active",o.settings().excludedRecipeIds.has(t)),m("icon",T(1,4,t,"recipe"))("pTooltip",n)}}function fl(e,i){if(e&1){let t=R();_(0,"tr",106),u(1,"td"),_(2,"td",18)(3,"div")(4,"div",123),S(5),r(6,"translate"),s(),_(7,"div",124)(8,"small"),S(9),r(10,"translate"),s()(),_(11,"p-checkbox",125),r(12,"translate"),F("onChange",function(){let o=B(t),p=a(4);return M(p.changeRecipesExcluded(o.recipeIds,o.allRecipesIncluded))}),s()()()(),_(13,"tr",106),u(14,"td"),_(15,"td",18)(16,"div",126),A(17,ul,5,7,"button",127,oe),s()()()}if(e&2){let t=i;l(5),P(" ",x(6,5,"steps.includedRecipes")," "),l(4),E(x(10,7,"steps.includedRecipesInfo")),l(2),m("ngModel",t.allRecipesIncluded)("binary",!0)("label",x(12,9,"picker.includeAll")),l(6),N(t.recipeIds)}}function xl(e,i){if(e&1&&c(0,fl,19,11),e&2){let t,n=a(),o=a(2);d((t=n.itemId&&o.stepDetails()[n.id])?0:-1,t)}}function gl(e,i){if(e&1){let t=R();_(0,"tr",106)(1,"td",107)(2,"a",108),u(3,"button",109),s()(),_(4,"td",18)(5,"p-tabMenu",110,9),r(7,"stepId"),F("activeItemChange",function(o){let p=B(t),C=a(2);return M(C.setActiveItem(p,o))}),c(8,ta,5,6,"ng-template",73),s()()(),c(9,ra,7,5)(10,Pa,1,1)(11,ml,5,2,"tr",106)(12,xl,1,1)}if(e&2){let t,n=i,o=b(6),p=a(2);l(2),m("relativeTo",p.route)("fragment",n.id),l(3),m("model",p.stepDetails()[n.id].tabs)("activeItem",p.activeItem[x(7,5,n)]),l(4),d((t=o.activeItem==null?null:o.activeItem.label)===p.StepDetailTab.Item?9:t===p.StepDetailTab.Recipe?10:t===p.StepDetailTab.Machine?11:t===p.StepDetailTab.Recipes?12:-1)}}function Sl(e,i){if(e&1&&(c(0,gl,13,7),r(1,"asStep")),e&2){let t,n=i.$implicit;d((t=x(1,1,n))?0:-1,t)}}function vl(e,i){e&1&&(_(0,"tr")(1,"td",18)(2,"div",52)(3,"span"),S(4),r(5,"translate"),s()()()()),e&2&&(l(4),E(x(5,1,"steps.emptyMessage")))}function hl(e,i){if(e&1&&c(0,vl,6,3,"tr"),e&2){let t=a();d(t.focus()?0:-1)}}function Il(e,i){e&1&&u(0,"td",31)}function bl(e,i){e&1&&u(0,"td")}function Tl(e,i){e&1&&u(0,"td")}function wl(e,i){if(e&1&&c(0,bl,1,0,"td")(1,Tl,1,0,"td"),e&2){let t=a(2);d(t.columnsState().checkbox.show?0:-1),l(),d(t.columnsState().tree.show?1:-1)}}function yl(e,i){if(e&1&&(u(0,"td"),c(1,wl,2,2)),e&2){let t=a();l(),d(t.focus()?-1:1)}}function El(e,i){e&1&&j(0)}function kl(e,i){if(e&1&&u(0,"lab-tooltip",63),e&2){let t=a(2).itemId;m("id",t)}}function Bl(e,i){if(e&1&&u(0,"lab-tooltip",76),e&2){let t=a(3).beltId;m("id",t)}}function Ml(e,i){if(e&1&&(_(0,"td",117)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",118)(5,"div",45)(6,"i",64),r(7,"iconClass"),c(8,Bl,1,1,"ng-template",null,5,k),s()()()),e&2){let t=b(9),n=a(2),o=n.belts,p=n.beltId,C=a();l(2),E(T(3,4,o,C.columnsState().belts.precision)),l(4),O(x(7,7,p)),m("pTooltip",t)}}function Ol(e,i){if(e&1&&u(0,"lab-tooltip",78),e&2){let t=a(4).wagonId;m("id",t)}}function Fl(e,i){if(e&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Ol,1,1,"ng-template",null,5,k),s()),e&2){let t=b(3),n=a(3).wagonId;O(x(1,3,n)),m("pTooltip",t)}}function Rl(e,i){if(e&1&&u(0,"lab-tooltip",79),e&2){let t=a(4).wagonId;m("id",t)}}function Vl(e,i){if(e&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Rl,1,1,"ng-template",null,5,k),s()),e&2){let t=b(3),n=a(3).wagonId;O(x(1,3,n)),m("pTooltip",t)}}function Pl(e,i){if(e&1&&(_(0,"td",117)(1,"span",67),S(2),r(3,"rate"),s()(),_(4,"td",118)(5,"div",45),c(6,Fl,4,5,"i",58)(7,Vl,4,5,"i",58),s()()),e&2){let t=a(2),n=t.wagons,o=t.wagonId,p=a();l(2),E(T(3,2,n,p.columnsState().wagons.precision)),l(4),d(p.data().cargoWagonIds.indexOf(o)!==-1?6:7)}}function jl(e,i){if(e&1&&(_(0,"span",67),S(1),r(2,"machineRate"),s()),e&2){let t=a(2),n=t.machines,o=t.machineId,p=a();l(),E(lt(2,1,n,p.columnsState().machines.precision,o))}}function $l(e,i){e&1&&(_(0,"div",130),S(1),r(2,"translate"),s()),e&2&&(l(),P(" ",x(2,1,"steps.inputs")," "))}function Dl(e,i){if(e&1&&(_(0,"span"),S(1),s()),e&2){let t=a(3).recipeObjectiveId;l(),P("#",t,"")}}function Ll(e,i){if(e&1&&u(0,"lab-tooltip",65),e&2){let t=a(3).recipeId;m("id",t)}}function Al(e,i){if(e&1&&u(0,"lab-tooltip",87),e&2){let t=a(3).machineId;m("id",t)}}function Nl(e,i){if(e&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Dl,2,1,"span")(3,Ll,1,1,"ng-template",null,5,k),s(),_(5,"i",64),r(6,"iconClass"),c(7,Al,1,1,"ng-template",null,5,k),s()),e&2){let t=b(4),n=a(2),o=n.machineId,p=n.recipeId,C=n.recipeObjectiveId;O(T(1,7,p,"recipe")),m("pTooltip",t),l(2),d(C?2:-1),l(3),O(x(6,10,o)),m("pTooltip",t)}}function Hl(e,i){e&1&&(S(0),r(1,"translate")),e&2&&P(" ",x(1,1,"steps.inputs")," ")}function Ul(e,i){if(e&1&&(_(0,"div",131),c(1,Hl,2,3),s()),e&2){let t=a(2).inputs;l(),d(t?1:-1)}}function Wl(e,i){e&1&&u(0,"i",132)}function zl(e,i){e&1&&u(0,"i",132)}function Gl(e,i){if(e&1&&(_(0,"span"),S(1),s()),e&2){let t=a(4).destRecipeObjectiveId;l(),P("#",t,"")}}function ql(e,i){if(e&1&&u(0,"lab-tooltip",133),e&2){let t=a(4),n=t.destId,o=t.destIsRecipe;m("id",n)("type",o?"recipe":"item")}}function Jl(e,i){if(e&1&&(_(0,"i",64),r(1,"iconClass"),c(2,Gl,2,1,"span")(3,ql,1,2,"ng-template",null,5,k),s()),e&2){let t=b(4),n=a(3),o=n.destId,p=n.destRecipeObjectiveId,C=n.destIsRecipe;O(T(1,4,o,C?"recipe":"item")),m("pTooltip",t),l(2),d(p?2:-1)}}function Kl(e,i){e&1&&(_(0,"span"),S(1),r(2,"translate"),s()),e&2&&(l(),P(" ",x(2,1,"steps.outputs")," "))}function Xl(e,i){if(e&1&&(c(0,Wl,1,0,"i",132),_(1,"span",67),S(2),r(3,"rate"),r(4,"leftPad"),s(),c(5,zl,1,0,"i",132)(6,Jl,5,7,"i",58)(7,Kl,3,3,"span")),e&2){let t=a(2),n=t.percent,o=t.percentOnDest,p=t.destId,C=t.outputs;d(o?0:-1),l(2),P("",x(4,8,T(3,5,n,-2)),"%"),l(3),d(o?-1:5),l(),d(p?6:-1),l(),d(C?7:-1)}}function Ql(e,i){if(e&1&&(c(0,El,1,0,"ng-container",114),_(1,"td",117)(2,"span",67),S(3),r(4,"rate"),s()(),_(5,"td",118)(6,"div",45)(7,"i",64),r(8,"iconClass"),c(9,kl,1,1,"ng-template",null,5,k),s()()(),c(11,Ml,10,9)(12,Pl,8,5),_(13,"td",117),c(14,jl,3,5,"span",67),r(15,"machineShowRate"),s(),_(16,"td",129)(17,"div",24),c(18,$l,3,3,"div",130)(19,Nl,9,12),r(20,"machineShow"),c(21,Ul,2,1,"div",131)(22,Xl,8,10),s()()),e&2){let t=b(10),n=a(),o=n.items,p=n.itemId,C=n.belts,f=n.beltId,g=n.wagons,w=n.wagonId,h=n.machines,y=n.machineId,V=n.percent,z=n.inputs,L=a(),K=b(9);m("ngTemplateOutlet",K),l(3),E(T(4,11,o,L.columnsState().items.precision)),l(4),O(x(8,14,p)),m("pTooltip",t),l(4),d(L.columnsState().belts.show&&C&&f?11:-1),l(),d(L.columnsState().wagons.show&&g&&w?12:-1),l(2),d(h&&h.nonzero()&&T(15,16,y,L.data().game)?14:-1),l(4),d(z?18:-1),l(),d(T(20,19,y,L.data().game)?19:21),l(3),d(V?22:-1)}}function Yl(e,i){if(e&1&&(_(0,"tr",106),c(1,Ql,23,22),s()),e&2){let t=i.itemId;l(),d(t?1:-1)}}function Zl(e,i){e&1&&u(0,"td")}function tp(e,i){e&1&&u(0,"td")}function ep(e,i){e&1&&j(0)}function np(e,i){e&1&&j(0)}function ip(e,i){e&1&&j(0)}function op(e,i){e&1&&j(0)}function ap(e,i){if(e&1&&(_(0,"td",134)(1,"span",67),S(2),r(3,"power"),s()()),e&2){let t=a(3);l(2),E(lt(3,1,t.totals().power,t.columnsState().power.precision,t.effectivePowerUnit()))}}function lp(e,i){if(e&1&&(_(0,"td",134)(1,"span",67),S(2),r(3,"rate"),s()()),e&2){let t=a(3);l(2),E(T(3,1,t.totals().pollution,t.columnsState().pollution.precision))}}function pp(e,i){e&1&&u(0,"td")}function _p(e,i){if(e&1&&(_(0,"tr"),u(1,"td"),c(2,Zl,1,0,"td")(3,tp,1,0,"td"),_(4,"td",31),S(5),r(6,"translate"),s(),c(7,ep,1,0,"ng-container",116)(8,np,1,0,"ng-container",116)(9,ip,1,0,"ng-container",116)(10,op,1,0,"ng-container",116)(11,ap,4,5,"td",134)(12,lp,4,4,"td",134)(13,pp,1,0,"td"),s()),e&2){a();let t=b(2),n=a();l(2),d(n.columnsState().checkbox.show?2:-1),l(),d(n.columnsState().tree.show?3:-1),l(2),P(" ",x(6,14,"steps.total")," "),l(2),m("ngTemplateOutlet",t)("ngTemplateOutletContext",H(16,jn,n.columnsState().belts,n.totals().belts)),l(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",H(19,$n,n.columnsState().wagons,n.totals().wagons)),l(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",Lt(22,Dn,n.columnsState().machines,n.totals().machines,n.totals().modules)),l(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",Lt(26,Ln,n.columnsState().beacons,n.totals().beacons,n.totals().beaconModules)),l(),d(n.columnsState().power.show?11:-1),l(),d(n.columnsState().pollution.show?12:-1),l(),d(n.columnsState().link.show?13:-1)}}function sp(e,i){if(e&1&&(_(0,"div",136)(1,"span",67),S(2),r(3,"rate"),s()()),e&2){let t=i.$implicit,n=a(2).columnSettings;l(2),E(T(3,1,t.value,n.precision))}}function cp(e,i){if(e&1&&u(0,"lab-tooltip",133),e&2){let t=a(2).$implicit,n=a(2).type;m("id",t.key)("type",n)}}function rp(e,i){if(e&1&&(_(0,"i",141),r(1,"iconClass"),c(2,cp,1,2,"ng-template",null,5,k),s()),e&2){let t=b(3),n=a().$implicit;O(x(1,3,n.key)),m("pTooltip",t)}}function dp(e,i){if(e&1&&u(0,"lab-tooltip",65),e&2){let t=a(2).$implicit;m("id",t.key)}}function mp(e,i){if(e&1&&(_(0,"i",141),r(1,"iconClass"),c(2,dp,1,1,"ng-template",null,5,k),s()),e&2){let t=b(3),n=a().$implicit;O(T(1,3,n.key,"recipe")),m("pTooltip",t)}}function Cp(e,i){if(e&1&&c(0,rp,4,5,"i",140)(1,mp,4,6,"i",140),e&2){let t=i.$implicit,n=a(4);d(n.data().itemEntities[t.key]?0:1)}}function up(e,i){if(e&1&&u(0,"lab-tooltip",93),e&2){let t=a().$implicit;m("id",t.key)}}function fp(e,i){if(e&1&&(_(0,"div",142)(1,"span",67),S(2),s()(),_(3,"i",141),r(4,"iconClass"),c(5,up,1,1,"ng-template",null,5,k),s()),e&2){let t=i.$implicit,n=b(6);l(2),E(t.value),l(),O(T(4,4,t.key,"item")),m("pTooltip",t.key!=="module"?n:void 0)}}function xp(e,i){if(e&1&&(_(0,"td",135),A(1,sp,4,4,"div",136,q),r(3,"keyvalue"),s(),_(4,"td",137)(5,"div",45)(6,"div",138),A(7,Cp,2,1,null,null,q),r(9,"keyvalue"),s(),_(10,"div",139),A(11,fp,7,7,null,null,q),r(13,"keyvalue"),s()()()),e&2){let t=a(),n=t.totals,o=t.modulesTotals,p=a(2);l(),N(T(3,0,n,p.trackSvc.sortByValue)),l(6),N(T(9,3,n,p.trackSvc.sortByValue)),l(4),N(T(13,6,o,p.trackSvc.sortByValue))}}function gp(e,i){if(e&1&&c(0,xp,14,9),e&2){let t=i.columnSettings;d(t.show?0:-1)}}function Sp(e,i){if(e&1&&c(0,_p,14,30,"tr")(1,gp,1,1,"ng-template",null,11,k),e&2){let t=a();d(t.focus()?-1:0)}}var Fs=(()=>{class e{constructor(){this.document=$(se),this.route=$(me),this.ref=$(pe),this.contentSvc=$(he),this.exportSvc=$(qe),this.itemsSvc=$(bt),this.machinesSvc=$(Ie),this.objectivesSvc=$(we),this.preferencesSvc=$(It),this.recipesSvc=$(it),this.routerSvc=$(Tt),this.settingsSvc=$(nt),this.trackSvc=$(Le),this.focus=Dt(!1),this.selectedId=Dt(),this.stepsTable=ee.required("stepsTable"),this.itemsState=this.itemsSvc.itemsState,this.itemsModified=this.itemsSvc.itemsModified,this.machinesState=this.machinesSvc.machinesState,this.recipesModified=this.objectivesSvc.recipesModified,this.stepsModified=this.objectivesSvc.stepsModified,this.stepTree=this.objectivesSvc.stepTree,this.stepDetails=this.objectivesSvc.stepDetails,this.stepById=this.objectivesSvc.stepById,this.stepByItemEntities=this.objectivesSvc.stepByItemEntities,this.effectivePowerUnit=this.objectivesSvc.effectivePowerUnit,this.totals=this.objectivesSvc.totals,this.settings=this.settingsSvc.settings,this.dispRateInfo=this.settingsSvc.displayRateInfo,this.beltSpeed=this.settingsSvc.beltSpeed,this.options=this.settingsSvc.options,this.columnsState=this.settingsSvc.columnsState,this.data=this.recipesSvc.adjustedDataset,this.preferences=this.preferencesSvc.state,this._steps=this.objectivesSvc.steps,this.steps=_e(()=>{let t=[...this._steps()];if(!this.focus())return t;let o=this.selectedId();return t.filter(p=>p.id===o)}),this.activeItemsEffect=At(()=>{let t=this.steps(),n=this.stepDetails();this.setActiveItems(t,n)}),this.toggleEffect=At(()=>{let t=this.focus(),n=this.steps()[0];t&&n&&(this.stepsTable().toggleRow(n),this.expandRow(n,!1))}),this.sortSteps$=new qt(null),this.activeItem={},this.stepDetailTab=Se("stepDetailTab"),this.stepDetailIcon=Te,this.ItemId=I,this.StepDetailTab=be,this.Game=tt,this.ObjectiveUnit=ve,this.rational=v,Jt([this.sortSteps$.pipe(Qt()),fe(this._steps)]).pipe(ue()).subscribe(([[t,n],o])=>{this.sortSteps(t,n,o)})}ngOnInit(){this.route.fragment.pipe(Xt(),Kt(t=>t!=null)).subscribe(t=>{this.fragmentId=t})}ngAfterViewInit(){this.loadFragmentId()}loadFragmentId(){if(this.fragmentId)try{let t=this.fragmentId,[n,o,p]=t.split("_"),C=this.steps(),f=this.stepDetails(),g=C.find(h=>h.id===o);if(g==null||!f[g.id].tabs.length)return;this.stepsTable().toggleRow(g),setTimeout(()=>{if(p){let h=this.document.querySelector(`#${t}`);h&&h.click()}else this.document.querySelector(`#${t}`)?.scrollIntoView()},10)}catch{}}sortSteps(t,n,o){if(n?.order==null||n.field==null)return;let p=n.order,C=n.field;if(t!=null&&t.field===C&&t.order!==p&&p===-1&&this.stepsTable!=null){n.data?.sort((f,g)=>o.indexOf(f)-o.indexOf(g)),this.stepsTable().sortOrder=0,this.stepsTable().sortField="",this.stepsTable().reset(),this.sortSteps$.next(null);return}n.data?.sort((f,g)=>(f[C]??v(0n)).sub(g[C]??v(0n)).toNumber()*p)}setActiveItems(t,n){t.forEach(o=>{this.updateActiveItem(o,n,!1)})}expandRow(t,n){n||this.updateActiveItem(t,this.stepDetails(),!0)}updateActiveItem(t,n,o){let p=_t.transform(t),C=this._getActiveItem(t,p,n,o);if(C){let f=_t.transform(t);this.activeItem[f]=C}}_getActiveItem(t,n,o,p){let C=this.activeItem[n],f=o[t.id];if(f==null)return null;if(C!=null){let w=f.tabs.find(h=>h.label===C.label);if(w!=null)return w}if(C==null&&!p)return null;let g=this.stepDetailTab();if(g){let w=f.tabs.find(h=>h.label===g);if(w!=null)return w}return f.tabs[0]}setActiveItem(t,n){if(n==null)return;let o=_t.transform(t);this.activeItem[o]=n,this.stepDetailTab.set(n.label)}resetStep(t){t.itemId&&this.itemsSvc.resetId(t.itemId),t.recipeObjectiveId?this.objectivesSvc.updateEntity(t.recipeObjectiveId,{machineId:void 0,fuelId:void 0,modules:void 0,beacons:void 0,overclock:void 0}):t.recipeId&&this.recipesSvc.resetId(t.recipeId)}changeItemExcluded(t,n){let o=Z(t,n,this.settings().excludedItemIds);this.settingsSvc.apply({excludedItemIds:o})}changeRecipesExcluded(t,n){let o=Z(t,n,this.settings().excludedRecipeIds),p=new Set(J(this.data().defaults?.excludedRecipeIds,[]));this.settingsSvc.updateField("excludedRecipeIds",o,p)}changeRecipeField(t,n,o){if(t.recipeId==null)return;let p=t.recipeSettings;if(p?.machineId==null)return;let C=t.recipeObjectiveId??t.recipeId,f=t.recipeObjectiveId!=null?this.objectivesSvc.updateEntityField.bind(this):this.recipesSvc.updateEntityField.bind(this),g=this.machinesState(),w=this.settings(),h=g[p.machineId];switch(o){case"machine":{if(typeof n!="string")return;let y=this.data(),V=et.bestMatch(y.recipeEntities[t.recipeId].producers,w.machineRankIds);f(C,"machineId",n,V);break}case"fuel":{if(typeof n!="string")return;f(C,"fuelId",n,h.fuelId);break}case"modules":{if(!Array.isArray(n))return;n=n;let y=this.data().machineEntities[p.machineId],V=et.dehydrateModules(n,J(p.moduleOptions,[]),w.moduleRankIds,y.modules,h.modules);f(C,"modules",V);break}case"beacons":{if(!Array.isArray(n))return;n=n;let y=h.beacons,V=et.dehydrateBeacons(n,y);f(C,"beacons",V);break}case"overclock":{if(typeof n!="number")return;let y=h.overclock;f(C,"overclock",v(n),y);break}}}changeStepChecked(t,n){if(t.itemId!=null){let o=Z(t.itemId,n,this.settings().checkedItemIds);this.settingsSvc.apply({checkedItemIds:o})}else if(t.recipeObjectiveId!=null){let o=Z(t.recipeObjectiveId,n,this.settings().checkedObjectiveIds);this.settingsSvc.apply({checkedObjectiveIds:o})}else if(t.recipeId!=null){let o=Z(t.recipeId,n,this.settings().checkedRecipeIds);this.settingsSvc.apply({checkedRecipeIds:o})}}resetChecked(){this.settingsSvc.apply({checkedItemIds:new Set,checkedObjectiveIds:new Set,checkedRecipeIds:new Set})}resetExcludedItems(t){this.settingsSvc.apply({excludedItemIds:new Set}),t.stopImmediatePropagation()}resetBelts(t){this.itemsSvc.resetFields("beltId"),t.stopImmediatePropagation()}resetWagons(t){this.itemsSvc.resetFields("wagonId"),t.stopImmediatePropagation()}resetMachines(t){let n=["machineId","overclock","modules","beacons"];this.objectivesSvc.resetFields(...n),this.recipesSvc.resetFields(...n),t.stopImmediatePropagation()}resetBeacons(){this.objectivesSvc.resetFields("beacons"),this.recipesSvc.resetFields("beacons")}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=st({type:e,selectors:[["lab-steps"]],viewQuery:function(n,o){n&1&&ae(o.stepsTable,kn,5),n&2&&le()},inputs:{focus:[1,"focus"],selectedId:[1,"selectedId"]},standalone:!0,features:[Ct],decls:15,vars:10,consts:[["stepsTable",""],["emptyCol2",""],["leftPad",""],["detailRow",""],["columnsDlg",""],["tooltip",""],["overclockInput",""],["modulePicker",""],["beaconsOverlay",""],["expandTabMenu",""],["machineValueCell",""],["totalCell",""],["dataKey","id","styleClass","p-datatable-sm",3,"rowsChange","sortFunction","rowTrackBy","value","customSort","rowExpandMode","defaultSortOrder","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],["pTemplate","footer"],["colspan","100"],[1,"d-flex","gap-2","py-2"],["pButton","","pRipple","","type","button","icon","fa-solid fa-table-columns",1,"p-button-outlined",3,"click","label"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"label"],[1,"column-header-row"],["colspan","2","pSortableColumn","items"],[1,"d-flex","align-items-center"],["field","items"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"pTooltip"],["colspan","2","pSortableColumn","belts"],["colspan","2","pSortableColumn","wagons"],["colspan","2","pSortableColumn","machines"],["field","machines"],["colspan","2"],["pSortableColumn","power"],["pSortableColumn","pollution"],["pButton","","pRipple","","type","button","icon","fa-solid fa-file-arrow-down",1,"p-button-outlined",3,"click","label"],[1,"d-flex","align-items-center","justify-content-center"],[1,"fa-solid","fa-square-check"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left",1,"ms-2","p-button-text","p-button-rounded",3,"click","pTooltip"],["field","belts"],["field","wagons"],[1,"d-flex","align-items-center","justify-content-end"],["field","power"],["field","pollution"],[1,"w-0","px-0","px-sm-1"],[1,"fragment",3,"id"],[1,"d-flex"],["pButton","","pRipple","","type","button","icon","fa-solid fa-angle-right",1,"p-button-text","p-button-rounded","transition-ease",3,"click","pTooltip","pRowToggler"],[1,"px-0","px-sm-2"],[1,"overflow-hidden","px-0","px-sm-1","py-0"],["colspan","2",1,"px-0","px-sm-2"],[1,"px-0","px-sm-2","text-end"],[1,"w-0","px-0","ps-sm-1"],[1,"d-flex","justify-content-center"],[3,"onChange","binary","ngModel"],[1,"d-flex","align-items-center","links"],[1,"indent"],[1,"icon"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"hover-active","icon","pTooltip"],[3,"class","pTooltip"],[1,"connect",3,"trail","last"],[1,"connect"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","icon","pTooltip"],[1,"hover-icon","fa-solid","fa-eye-slash"],[3,"id"],[3,"pTooltip"],["type","recipe",3,"id"],[1,"w-0","px-0","px-sm-2","text-end"],[1,"monospace"],[1,"px-0","pe-sm-2"],[1,"find-text"],["labDropdownBase","icon",3,"pTooltip","ngModel","options"],["labDropdownBase","icon",3,"onChange","pTooltip","ngModel","options"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"d-flex","align-items-center","py-2","w-100","h-100",3,"pTooltip"],[1,"ms-3","text-truncate"],["type","belt",3,"id"],["type","pipe",3,"id"],["type","cargo-wagon",3,"id"],["type","fluid-wagon",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"pTooltip"],["labDropdownBase","icon",3,"pTooltip","options","ngModel"],["suffix","%","inputStyleClass","text-end",3,"min","max","step","maxFractionDigits","size","pTooltip","ngModel"],["pButton","","pRipple","","type","button",1,"hover-action","p-button-text",3,"click","pTooltip"],[1,"p-button-icon"],[1,"hover-icon","fa-solid","fa-circle-plus"],["labDropdownBase","icon",3,"onChange","pTooltip","options","ngModel"],["type","machine",3,"id"],["suffix","%","inputStyleClass","text-end",3,"onBlur","min","max","step","maxFractionDigits","size","pTooltip","ngModel"],[1,"padded",3,"pTooltip"],["type","fuel",3,"id"],["labDropdownBase","icon","labNoDrag","",3,"pTooltip","ngModel","options"],["labDropdownBase","icon","labNoDrag","",3,"onChange","pTooltip","ngModel","options"],["type","module",3,"id"],["pButton","","pRipple","","type","button",1,"hover-action","modules","p-button-text",3,"click","pTooltip"],[1,"p-button-icon",3,"class"],[1,"hover-icon","fa-solid","fa-gear"],[3,"setValue"],["pButton","","pRipple","","type","button",1,"hover-action","icons","p-button-text","flex-column",3,"click","pTooltip"],[1,"p-button-icon","sum",3,"class"],[1,"p-button-icon","sum"],["type","beacon",3,"id"],["target","_blank","routerLink",".",1,"text-decoration-none",3,"queryParams"],["pButton","","pRipple","","type","button","icon","fa-solid fa-arrow-up-right-from-square","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","fa-solid fa-rotate-left","tooltipPosition","left",1,"p-button-text","p-button-rounded",3,"click","pTooltip"],[1,"detail"],[1,"px-1"],["routerLink",".","queryParamsHandling","preserve",1,"text-decoration-none",3,"relativeTo","fragment"],["pButton","","pRipple","","type","button","icon","fa-solid fa-link",1,"p-button-text","p-button-rounded"],[3,"activeItemChange","model","activeItem"],[1,"p-menuitem-link",3,"id"],[1,"p-menuitem-icon"],[1,"p-menuitem-text"],[4,"ngTemplateOutlet"],["colspan","100",1,"fw-bold"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"w-0","text-end"],[1,"ps-0"],[1,"lab-icon","time"],[3,"innerHTML"],[1,"mw-0"],[1,"fa-solid","fa-arrow-right","mx-3"],[1,"fw-bold"],[1,"mb-2"],[3,"onChange","ngModel","binary","label"],[1,"d-flex","flex-wrap"],["pButton","","pRipple","","type","button",1,"p-button-text","hover-action","me-2",3,"hover-active","icon","pTooltip"],["pButton","","pRipple","","type","button",1,"p-button-text","hover-action","me-2",3,"click","icon","pTooltip"],["colspan","100",1,"p-0"],[1,"position-absolute"],[1,"text-center",2,"width","68px"],[1,"m-1","p-2","fa-solid","fa-arrow-right"],[3,"id","type"],[1,"text-end","inherit"],[1,"w-0","text-end","inherit"],[1,"py-2","icon-height"],[1,"ps-0","inherit"],[1,"d-flex","flex-column","justify-content-center"],[1,"modules-column"],[1,"d-block",3,"class","pTooltip"],[1,"d-block",3,"pTooltip"],[1,"p-2","icon-height","text-end"]],template:function(n,o){if(n&1){let p=R();_(0,"p-table",12,0),F("rowsChange",function(f){return B(p),M(o.preferencesSvc.apply({rows:f}))})("sortFunction",function(f){return B(p),M(o.sortSteps$.next(f))}),c(2,pi,30,22,"ng-template",13)(3,Zo,2,3,"ng-template",14)(4,Sl,2,3,"ng-template",15)(5,hl,1,1,"ng-template",16)(6,Il,1,0,"ng-template",null,1,k)(8,yl,2,1,"ng-template",null,2,k)(10,Yl,2,1,"ng-template",null,3,k)(12,Sp,3,1,"ng-template",17),s(),u(13,"lab-columns",null,4)}n&2&&m("rowTrackBy",o.trackSvc.trackStep)("value",o.steps())("customSort",!0)("rowExpandMode",o.focus()?"single":"multiple")("defaultSortOrder",-1)("paginator",!o.focus()&&!o.preferences().disablePaginator)("rows",o.preferences().rows)("rowsPerPageOptions",X(9,Bn))("showCurrentPageReport",!0)},dependencies:[re,Et,wt,yt,de,ce,Ce,xt,ft,ut,Bt,kt,Be,ke,Ot,Mt,Rt,Ft,Ae,He,Ne,$e,je,ye,Ee,Je,We,an,Ue,Fe,Re,Xe,Qe,Ye,Ze,tn,ze,De,en,nn,G,on,_t,Pe,vt],styles:[".links[_ngcontent-%COMP%]{height:50px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{position:relative;margin-left:16px;height:100vh}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%], .links[_ngcontent-%COMP%]   .connect.trail[_ngcontent-%COMP%]{border-left:2px dotted var(--text-color-secondary)}.links[_ngcontent-%COMP%]   .connect.last[_ngcontent-%COMP%]:not(.trail){margin-bottom:50vh;height:50vh}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:24px}@media (max-width: 1199.98px){.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%]{margin-left:8px}.links[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%] + .connect[_ngcontent-%COMP%]{margin-left:16px}}.links[_ngcontent-%COMP%]   .indent[_ngcontent-%COMP%]{margin-left:0;border-top:2px dotted var(--text-color-secondary);width:8px}.links[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px}[_nghost-%COMP%]     .p-dropdown:not(:is(:hover,   :focus,   .ng-invalid)), [_nghost-%COMP%]     .p-inputtext:not(:is(:hover,   :focus,   .ng-invalid)){border-color:transparent;background-color:transparent}tr.detail[_ngcontent-%COMP%]{background-color:var(--surface-ground)}[_nghost-%COMP%]     tr.detail .p-tabmenu .p-tabmenu-nav .p-tabmenuitem:not(.p-highlight) .p-menuitem-link{background-color:transparent}.icon-height[_ngcontent-%COMP%]{min-height:32px}.modules-column[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;margin:auto}.fragment[_ngcontent-%COMP%]{position:absolute;top:-10rem;visibility:hidden}.column-header-row[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{height:48px}"],changeDetection:0})}}return e})();export{Ge as a,qe as b,Fs as c};
